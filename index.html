<!doctype html>
<html>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-69576910-7', 'auto');
    ga('send', 'pageview');
    //This does hash-click tracking (inspired by http://stackoverflow.com/a/4813223)
    $(document).ready(function() {
      $('.tocify-item a').on('click', function(){
        ga('send', 'pageview', {'page': location.pathname + location.search  + location.hash});
      });
    });
  </script>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>FlytAPI Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
    <link href="images/flytFavicon.ico" rel="icon" type="image/ico" />
  </head>

  <body class="index" data-languages="[&quot;cpp&quot;,&quot;python&quot;,&quot;javascript--REST&quot;,&quot;javascript--Websocket&quot;,&quot;shell&quot;,&quot;cpp--ros&quot;,&quot;python--ros&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="cpp">C++</a>
              <a href="#" data-language-name="python">Python</a>
              <a href="#" data-language-name="javascript--REST">JS REST</a>
              <a href="#" data-language-name="javascript--Websocket">JS Websocket</a>
              <a href="#" data-language-name="shell">ros-cli</a>
              <a href="#" data-language-name="cpp--ros">roscpp</a>
              <a href="#" data-language-name="python--ros">rospy</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://flytbase.com'>FlytBase</a></li>
            <li><a href='http://forums.flytbase.com'>Developer Forums</a></li>
            <li><a href='http://docs.flytbase.com'>Documentation</a></li>
            <li><a href='https://github.com/flytbase'>Github Organization</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to API reference documentation for FlytOS. Here you can find details of all the FlytAPIs with their description, parameters and usage examples. API bindings are available in several languages and you can select the desired language from the tabs in the right panel.</p>

<p>If you are <strong>FlytCloud customer</strong>, base IP/URL for API is <code class="prettyprint">https://dev.flytbase.com</code></p>

<p>To learn more about how to get started with FlytOS and build your first app, please visit the developer <a href='http://docs.flytbase.com/'>documentation</a>.</p>

<p>In case, you find any bug/issue in this documentation, please help us rectify it by raising an issue in our <a href='https://github.com/flytbase/flytdocs-slate'>github repository</a>.</p>

          <h1 id="namespace-api">Namespace API</h1>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login. </span>

ROS-Service Name: /get_global_namespace
ROS-Service Type: core_api/ParamGetGlobalNamespace, below is its description

<span class="c">#Request : None</span>

<span class="c">#Response : Paramter info</span>
core_api/ParamInfo param_info
<span class="c">#Response : success=true if parameter get was successful.</span>
bool success
<span class="c">#Response : Returns error message/success message if any.</span>
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// global namespace is not required for any CPP API
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># global namespace is not required for any Python API</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/</span><span class="n">get_global_namespace</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="nb">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">core_api</span><span class="o">/</span><span class="n">ParamInfo</span> <span class="n">param_info</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/</span><span class="n">get_global_namespace</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> <span class="n">ParamGetGlobalNamespace</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">' &lt;ip&gt;/ros/get_global_namespace'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">param_info</span><span class="p">:{</span>
        <span class="nl">param_value</span><span class="p">:</span> <span class="nb">String</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/get_global_namespace'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ParamGetGlobalNamespace'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">param_info</span><span class="p">:{</span>
            <span class="nl">param_value</span><span class="p">:</span> <span class="nb">String</span>
        <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /get_global_namespace <span class="s2">"{}"</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// global namespace is not required for any CPP API
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># global namespace is not required for any Python API</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/ParamGetGlobalNamespace.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">ParamGetGlobalNamespace</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/get_global_namespace"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">ParamGetGlobalNamespace</span> <span class="n">srv</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">global_namespace</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">param_info</span><span class="p">.</span><span class="n">param_value</span><span class="p">;</span>

<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">get_global_namespace</span><span class="p">():</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/get_global_namespace'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/get_global_namespace'</span><span class="p">,</span> <span class="n">ParamGetGlobalNamespace</span><span class="p">)</span>
        <span class="n">op</span> <span class="o">=</span> <span class="n">res</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">op</span><span class="o">.</span><span class="n">param_info</span><span class="o">.</span><span class="n">param_value</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"global namespace service not available"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code>    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
        <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
        <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
        <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/get_global_namespace"</span><span class="p">,</span>   
        <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">param_info</span><span class="p">.</span><span class="nx">param_value</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">namespace</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/get_global_namespace'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ParamGetGlobalNamespace'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">namespace</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">namespace</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">param_info</span><span class="p">.</span><span class="nx">param_value</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>param_info: 
  param_id: global_namespace
  param_value: flytpod
success: True
message: FlytOS namespace is  flytpod
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// global namespace is not required for any CPP API
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># global namespace is not required for any Python API</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="n">success</span> <span class="o">:</span> <span class="nb">true</span>
<span class="n">message</span> <span class="o">:</span> <span class="n">FlytOS</span> <span class="k">namespace</span> <span class="n">is</span>  <span class="n">flytpod</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">success</span><span class="p">:</span> <span class="bp">True</span>
<span class="n">message</span><span class="p">:</span> <span class="n">FlytOS</span> <span class="n">namespace</span> <span class="ow">is</span>  <span class="n">flytpod</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span><span class="p">,</span>
    <span class="nx">param_info</span><span class="p">:{</span>
        <span class="nl">param_value</span><span class="p">:</span><span class="s1">'flytpod'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span><span class="p">,</span>
    <span class="nx">param_info</span><span class="p">:{</span>
        <span class="nl">param_value</span><span class="p">:</span><span class="s1">'flytpod'</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API returns the global namespace under which FlytOS&rsquo;s instance is running. For users using RESTful, Websocket or ROS APIs, calling this API is a <strong>MUST</strong>, as the value of this namespace is required to call other APIs.</p>

<p>In the subsequent documentation, wherever <em>&lt;namespace&gt;</em> is mentioned in API call definition, it must be replaced by the output of this API call.</p>

<p>Users writing their code in simple CPP and Python need not call this API.</p>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>Global namespace is required when calling onboard/remote APIs except cpp/python APIs.</li>
<li>All the core nodes of FlytOS run inside this namespace.</li>
<li>Make sure that your custom ROS packages are not launched inside this namespace.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<ul>
<li>Service Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/get_global_namespace</code></li>
<li>Service Type: <code class="prettyprint">ParamGetGlobalNamespace</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">http://&lt;ip&gt;/ros/get_global_namespace</code></li>
<li>Request Method: <code class="prettyprint">GET</code></li>
<li>JSON Response: <code class="prettyprint">{success: Boolean,message: String,param_info:{param_value: String}}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library</a>.
Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava</a>.</p>

<ul>
<li>name: <code class="prettyprint">/get_global_namespace</code></li>
<li>serviceType: <code class="prettyprint">core_api/ParamGetGlobalNamespace</code></li>
</ul>

          <h1 id="navigation-apis">Navigation APIs</h1>

<h2 id="access-request">Access Request</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/access_request
ROS-Service Type: core_api/AccessRequest, below is its description

<span class="c">#Request : </span>
bool enable_access

<span class="c">#Response : return success=true if command is successful</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">access_request</span><span class="p">(</span><span class="kt">bool</span> <span class="n">enable_access</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>  <span class="n">enable_access</span><span class="o">:</span> <span class="n">Set</span> <span class="n">it</span> <span class="n">to</span> <span class="n">True</span> <span class="n">to</span> <span class="n">enable</span> <span class="n">API</span> <span class="n">access</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">access_request</span><span class="p">(</span><span class="n">enable_access</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">access_request</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="kt">bool</span> <span class="n">enable_access</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">access_request</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">enable_access</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="nx">to</span> <span class="nx">enable</span> <span class="nx">API</span> <span class="nx">control</span> <span class="nx">over</span> <span class="nx">drone</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/access_request'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">enable_access</span><span class="p">:</span> <span class="nb">Boolean</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="nx">to</span> <span class="nx">enable</span> <span class="nx">API</span> <span class="nx">control</span> <span class="nx">over</span> <span class="nx">drone</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/access_request'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/AccessRequest'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">enable_access</span><span class="p">:</span> <span class="nb">Boolean</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/navigation/access_request <span class="s2">"{enable_access: true}"</span>    
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">nav</span><span class="p">.</span><span class="n">access_request</span><span class="p">())</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"API access enabled"</span><span class="p">;</span>
<span class="k">else</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"Failed to enable API access"</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="n">drone</span><span class="o">.</span><span class="n">access_request</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/AccessRequest.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">AccessRequest</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/access_request"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">AccessRequest</span> <span class="n">srv</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">enable_access</span><span class="o">=</span><span class="nb">true</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">access_request</span><span class="p">(</span><span class="n">enable_access</span><span class="p">)</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/access_request'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/access_request'</span><span class="p">,</span> <span class="n">AccessRequest</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">(</span><span class="n">enable_access</span><span class="o">=</span><span class="n">enable_access</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"enable_access"</span><span class="p">]</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/access_request"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">access_request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/access_request'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/AccessRequest'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="nx">enable_access</span> <span class="o">=</span> <span class="kc">true</span>
<span class="p">});</span>

<span class="nx">access_request</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">access_request</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="bp">True</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API enables API control over drone. Sending vehicle to GUIDED/OFFBOARD mode via RC automatically enables API control, and likewise sending vehicle to RC modes such as MANUAL/STABILIZE/ALTCTL/ALT_HOLD/POSCTL/POSHOLD/LOITER disables API control. </p>

<p>If this API is called with enable_access argument set to &lsquo;true&rsquo;, vehicle&rsquo;s mode is shifted to GUIDED/OFFBOARD mode internally.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard C++ and Python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>enable_access</td>
<td>bool</td>
<td>Set this to true to enable API access. Setting this to false won&rsquo;t have any effect, this feature would be added later.</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>access_request API MUST be called if you don&rsquo;t have any RC hooked with the vehicle.</li>
<li>It is safer to configure RC to communicate with the drone and send the vehicle to GUIDED/OFFBOARD mode instead of calling access_request command. </li>
<li>All navigation API&rsquo;s except &lsquo;disarm&rsquo; requires that FlytOS&rsquo;s access to drone has been enabled. So before calling any setpoint / waypoint APIs, make sure to call this API, or send vehicle to GUIDED/OFFBOARD mode via RC.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: Ros Service</br> </li>
<li>Name: /&lt;namespace&gt;/navigation/access_request</br></li>
<li>Service Type: core_api/AccessRequest</li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/access_request</code></li>
<li>JSON Request:
{
enable_access: Boolean
}</li>
<li>JSON Response:
{
success: Boolean
message: String
}</li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> 
Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: &lsquo;/&lt;namespace&gt;/navigation/access_request&rsquo;</br></li>
<li>serviceType: &lsquo;core_api/AccessRequest&rsquo;</li>
</ul>

          <h2 id="arm">Arm</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/arm
ROS-Service Type: core_api/Arm, below is its description

<span class="c">#Request : NULL</span>

<span class="c">#Response : return success=true if command is successful</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">arm</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>  <span class="n">None</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">arm</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">arm</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="nb">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">arm</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">arm</span> <span class="nx">the</span> 
<span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/arm'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">arm</span> <span class="nx">the</span> 
<span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/arm'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/Arm'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/navigation/arm <span class="s2">"{}"</span>    
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">nav</span><span class="p">.</span><span class="n">arm</span><span class="p">())</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"System ARMED"</span><span class="p">;</span>
<span class="k">else</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"Failed to ARM system"</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="n">drone</span><span class="o">.</span><span class="n">arm</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/Arm.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">Arm</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/arm"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">Arm</span> <span class="n">srv</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">arm</span><span class="p">()</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/arm'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/arm'</span><span class="p">,</span> <span class="n">Arm</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/arm"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">arm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/arm'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/Arm'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">arm</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">arm</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="bp">True</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API arms the motors. If arm fails then check debug messages for arming errors. Likely reasons are uncalibrated sensors, misconfiguration.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard C++ and Python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments: None</p>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>ARM API will only work when device is in GUIDED or OFFBOARD or API|POSCTL mode.</li>
<li>All navigation setpoint API&rsquo;s except take_off require that drone is armed. So before calling any setpoint / waypoint APIs, drone should be armed.</li>
<li>It is safer to use take_off command instead of arm command. </li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/arm</code></li>
<li>Service Type: <code class="prettyprint">core_api/Arm</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/arm</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> 
Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/arm</code></li>
<li>serviceType: <code class="prettyprint">core_api/Arm</code></li>
</ul>

          <h2 id="disarm">Disarm</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/disarm
ROS-Service Type: core_api/Disarm, below is its description

<span class="c">#Request : NULL</span>

<span class="c">#Response : return success=true if command is successful</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">disarm</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span> <span class="n">None</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">disarm</span><span class="p">():</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">disarm</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="nb">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">disarm</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">disarm</span> <span class="nx">the</span> 
<span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/disarm'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">disarm</span> <span class="nx">the</span> 
<span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/disarm'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/Disarm'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/navigation/disarm <span class="s2">"{}"</span>    
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">nav</span><span class="p">.</span><span class="n">disarm</span><span class="p">())</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"System DIARMED"</span><span class="p">;</span>
<span class="k">else</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"Failed to DISARM system"</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="n">drone</span><span class="o">.</span><span class="n">disarm</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/Disarm.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">Disarm</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/disarm"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">Disarm</span> <span class="n">srv</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">disarm</span><span class="p">():</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/disarm'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/disarm'</span><span class="p">,</span> <span class="n">Disarm</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/disarm"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">disarm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/disarm'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/Disarm'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">disarm</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">disarm</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="bp">True</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API disarms the motors. Read API description below before you use it.</p>

<aside class="warning">
    Calling this API during flight will cause the motors to stall and may result in crash.
</aside>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard C++ and Python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments: None</p>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>This API will work regardless of what flight mode vehicle is in.</li>
<li>Make sure that drone is on ground before disarming. If this API is called during flight, motors will stop instantly causing the drone to crash.</li>
<li>To confirm whether vehicle is grounded / landed subscribe to following topic. (/global_namespace/mavros/extended_state), parameter name :  landed_state, value: 1 &ndash;&gt; ground,  2 &ndash;&gt; air/flying.<br></li>
<li>If land API is used then the vehicle will automatically disarm after some time. </li>
<li>Land API with auto diarm on landing feature is preferred over calling disarm API specifically.</li>
<li>To configure auto disarm on landing set following parameters. 

<ul>
<li>COM_DISARM_LAND:: 0 : disabled, n (integer between 1 to 20 inculsive) : enabled with n seconds timeout before disarming after landed. </li>
<li>If this feature is enabled motors will disarm automatically even in cases where vehicle was armed but not flown. So for most scenarios value 5 should be fine.</li>
</ul></li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/disarm</code></li>
<li>Service Type: <code class="prettyprint">core_api/Disarm</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/disarm</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> 
Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/disarm</code></li>
<li>serviceType: <code class="prettyprint">core_api/Disarm</code></li>
</ul>

          <h2 id="take-off">Take Off</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/takeoff
ROS-Service Type: core_api/TakeOff, below is its description

<span class="c"># Request : expects take off altitude in metres</span>
float32 takeoff_alt

<span class="c"># Response : returns success=true if takeoff altitude is reached</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span>  <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">take_off</span><span class="p">(</span><span class="kt">float</span> <span class="n">takeoff_alt</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span> 
    <span class="n">takeoff_alt</span><span class="o">:</span> <span class="n">TakeOff</span> <span class="n">Altitude</span> <span class="n">in</span> <span class="n">meters</span> <span class="n">with</span> <span class="k">default</span> <span class="n">value</span> <span class="n">of</span> <span class="mf">5.0</span>

<span class="n">Returns</span><span class="o">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">vehicle</span> <span class="n">reaches</span> <span class="n">takeoff_alt</span> <span class="n">before</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="n">sec</span><span class="p">,</span> <span class="k">else</span> <span class="n">returns</span> <span class="mf">1.</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">take_off</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">takeoff_alt</span><span class="o">=</span><span class="mf">5.0</span><span class="p">):</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">takeoff</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span> <span class="kt">int</span> <span class="n">takeoff_alt</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">takeoff</span>
<span class="n">Type</span><span class="p">:</span> <span class="n">core_api</span><span class="o">/</span><span class="n">TakeOff</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span> <span class="nb">int</span> <span class="n">takeoff_alt</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">takeoff</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/take_off'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">takeoff_alt</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">takeoff</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/take_off'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/TakeOff'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">takeoff_alt</span><span class="p">:</span> <span class="nx">Float</span> <span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/navigation/take_off <span class="s2">"takeoff_alt: 3.0"</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">nav</span><span class="p">.</span><span class="n">take_off</span><span class="p">(</span><span class="mf">3.0</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># takeoff over current location </span>
<span class="n">drone</span><span class="o">.</span><span class="n">take_off</span><span class="p">(</span><span class="mf">6.0</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/TakeOff.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">TakeOff</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/takeoff"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">TakeOff</span> <span class="n">srv</span><span class="p">;</span>

<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">takeoff_alt</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">takeoff</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/take_off'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/take_off'</span><span class="p">,</span> <span class="n">TakeOff</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">(</span><span class="n">takeoff_alt</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"takeoff_alt"</span><span class="p">]</span><span class="o">=</span><span class="mf">5.00</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/take_off"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">takeoff</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/take_off'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/TakeOff'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">takeoff_alt</span><span class="p">:</span> <span class="mf">5.00</span>
<span class="p">});</span>

<span class="nx">takeoff</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">takeoff</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="bp">True</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>Takeoff and reach specified height from current location.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard C++ and Python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>takeoff_alt</td>
<td>float32</td>
<td>takeoff to given height at current location. (minimum 1.5 meters)</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<p>Takeoff to specified height from current height at current location.</p>

<ul>
<li>takeoff_alt value should be positive. </li>
<li>Irrespective of current altitude vechile will climb up by takeoff_alt meters from current location.</li>
<li>Takeoff API will automatically arm the motors. </li>
<li>Takeoff API will work only in OFFBOARD/GUIDED/API|POSCTL mode.</li>
<li>Minimum value of takeoff_alt argument is 1.5 meters.</li>
<li>Takeoff API is always synchronous. </li>
<li>It is recommended not to send any other navigation commands while takeoff is under way.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/takeoff</code></li>
<li>Service Type: <code class="prettyprint">core_api/TakeOff</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/take_off</code></li>
<li>JSON Request:
<code class="prettyprint">{
takeoff_alt: Float
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> 
Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/take_off</code></li>
<li>serviceType: <code class="prettyprint">core_api/TakeOff</code></li>
</ul>

          <h2 id="land">Land</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/land
ROS-Service Type: core_api/Land, below is its description

<span class="c">#Request : expects async variable to be set/reset</span>
bool async

<span class="c">#Response : return success=true if Land command sent successfully to autopilot</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// CPP API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from cpp.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span>    <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">land</span><span class="p">(</span><span class="kt">bool</span> <span class="n">async</span> <span class="o">=</span> <span class="nb">false</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">async</span><span class="o">:</span> <span class="n">If</span> <span class="nb">true</span><span class="p">,</span> <span class="n">asynchronous</span> <span class="n">mode</span> <span class="n">is</span> <span class="n">set</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">land</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span><span class="p">,</span> <span class="k">else</span> <span class="n">returns</span> <span class="mf">1.</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">land</span><span class="p">(</span><span class="n">async</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">land</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="n">async</span><span class="o">=</span><span class="nb">false</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">land</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="n">async</span><span class="o">=</span><span class="bp">False</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">land</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/land'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">land</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/land'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/Land'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>  <span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/navigation/land <span class="s2">"async=true"</span> 
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">nav</span><span class="p">.</span><span class="n">land</span><span class="p">(</span><span class="nb">true</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># land at current location. Return after landed</span>
<span class="n">drone</span><span class="o">.</span><span class="n">land</span><span class="p">(</span><span class="n">async</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># land at current location. Function returns immediately and land action finishes asynchronously.  </span>
<span class="n">drone</span><span class="o">.</span><span class="n">land</span><span class="p">(</span><span class="n">async</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/Land.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">Land</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/land"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">Land</span> <span class="n">srv</span><span class="p">;</span>

<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">async</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">land</span><span class="p">(</span><span class="n">async</span><span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/land'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/land'</span><span class="p">,</span> <span class="n">Land</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">(</span><span class="n">async</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/land"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">land</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/land'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/Land'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">land</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">land</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="bp">True</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>Land vehicle at current position. Check API usage section below before using this API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>async</td>
<td>bool</td>
<td>If true, asynchronous mode is set</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<p>This API will land the vehicle at current location. </p>

<ul>
<li>This API can be used only in GUIDED or OFFBOARD or API|POSCTL mode.</li>
<li>If any other navigation API is called during landing, then land call be overridden by that API call. </li>
<li>Automatic land flow can be configured with following parameters.

<ul>
<li>LNDMC_Z_VEL_MAX : Maximum velocity in vertical direction when landing (ideal value 0.8 m/s to 1.5 m/s)</li>
<li>LNDMC_XY_VEL_MAX: Maximum velocity in horizontal direction when landing (ideal value 1 m/s to 2 m/s)</li>
<li>MPC_LAND_SPEED: Landing velocity (ideal value 0.8 m/s)</li>
</ul></li>
<li>To disarm vehicle automatically after landing following parameter can be configured.

<ul>
<li>COM_DISARM_LAND:: 0 : disabled, n (integer between 1 to 20 inclusive) : enabled with n seconds timeout before disarming after landed. </li>
<li>If this feature is enabled motors will disarm automatically even in cases where vehicle was armed but not flown. So for most scenarios value 5 should be fine. </li>
</ul></li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs.
Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/land</code></li>
<li>Service Type: <code class="prettyprint">core_api/Land</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/land</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/land</code></li>
<li>serviceType: <code class="prettyprint">core_api/Land</code></li>
</ul>

          <h2 id="position-hold">Position Hold</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/position_hold
ROS-Service Type: core_api/PositionHold, below is its description

<span class="c">#Request : NULL</span>

<span class="c">#Response : return success=true if command sent successfully to autopilot</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span>     <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">position_hold</span><span class="p">()</span>

<span class="n">Arguments</span><span class="o">:</span> <span class="n">None</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">position_hold</span><span class="p">():</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">position_hold</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="nb">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">position_hold</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">halt</span> <span class="nx">and</span> <span class="nx">hover</span> <span class="nx">at</span> 
<span class="nx">current</span> <span class="nx">location</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/position_hold'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">halt</span> <span class="nx">and</span> 
<span class="nx">hover</span> <span class="nx">at</span> <span class="nx">current</span> <span class="nx">location</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/position_hold'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/PositionHold'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /&lt;namespace&gt;/navigation/position_hold <span class="s2">"{}"</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">nav</span><span class="p">.</span><span class="n">position_hold</span><span class="p">();</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># hold position</span>
<span class="n">drone</span><span class="o">.</span><span class="n">position_hold</span><span class="p">()</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/PositionHold.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">PositionHold</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/position_hold"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">PositionHold</span> <span class="n">srv</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">position_hold</span><span class="p">():</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/position_hold'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/position_hold'</span><span class="p">,</span> <span class="n">PositionHold</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/position_hold"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">positionHold</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/position_hold'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/PositionHold'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">positionHold</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">positionHold</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="bp">True</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>Position hold / hover / loiter at current position.  </p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard C++ and Python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments: None</p>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<p>This API can be used to stop the vehicle at current location. </p>

<ul>
<li>This API requires vehicle to be in GUIDED or OFFBOARD or API|POSCTL mode.</li>
<li>This API will override current mission / navigation commmands. </li>
<li>This API requires position lock. GPS, Optical Flow, VICON system can provide position data to vehicle.</li>
<li>Vehicle may take few seconds to come to rest depending on current linear velocity.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/position_hold</code></li>
<li>Service Type: <code class="prettyprint">core_api/PositionHold</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/position_hold</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/position_hold</code></li>
<li>serviceType: <code class="prettyprint">core_api/PositionHold</code></li>
</ul>

          <h2 id="position-setpoint">Position Setpoint</h2>

<blockquote>
<p>Definition</p>
</blockquote>

<aside class="warning">
This API is not supported for Fixed Wing.
</aside>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/position_set
ROS-Service Type: core_api/PositionSet, below is its description

<span class="c">#Request : expects position setpoint via x, y, z</span>
<span class="c">#Request : expects yaw setpoint via yaw (send yaw_valid=true)</span>
geometry_msgs/TwistStamped twist <span class="c">#deprecated, instead use x,y,z,yaw</span>
float32 x
float32 y
float32 z
float32 yaw
float32 tolerance
bool async
bool relative
bool yaw_valid
bool body_frame

<span class="c">#Response : success=true - (if async=false &amp;&amp; if setpoint reached before timeout = 30sec) || (if async=true)</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// CPP API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from cpp.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">position_set</span><span class="p">(</span><span class="kt">float</span> <span class="n">x</span><span class="p">,</span> <span class="kt">float</span> <span class="n">y</span><span class="p">,</span> <span class="kt">float</span> <span class="n">z</span><span class="p">,</span> <span class="kt">float</span> <span class="n">yaw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kt">float</span> <span class="n">tolerance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">relative</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">async</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">yaw_valid</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">body_frame</span><span class="o">=</span><span class="nb">false</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">:</span> <span class="n">Position</span> <span class="n">Setpoint</span> <span class="n">in</span> <span class="n">NED</span><span class="o">-</span><span class="n">Frame</span> <span class="p">(</span><span class="n">in</span> <span class="n">body</span><span class="o">-</span><span class="n">frame</span> <span class="k">if</span> <span class="n">body_frame</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
    <span class="n">yaw</span><span class="o">:</span> <span class="n">Yaw</span> <span class="n">Setpoint</span> <span class="n">in</span> <span class="n">radians</span>
    <span class="n">yaw_valid</span><span class="o">:</span> <span class="n">Must</span> <span class="n">be</span> <span class="n">set</span> <span class="n">to</span> <span class="nb">true</span><span class="p">,</span> <span class="k">if</span> <span class="n">yaw</span> <span class="n">setpoint</span> <span class="n">is</span> <span class="n">provided</span>
    <span class="n">tolerance</span><span class="o">:</span> <span class="n">Acceptance</span> <span class="n">radius</span> <span class="n">in</span> <span class="n">meters</span><span class="p">,</span> <span class="k">default</span> <span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="n">m</span>
    <span class="n">relative</span><span class="o">:</span> <span class="n">If</span> <span class="nb">true</span><span class="p">,</span> <span class="n">position</span> <span class="n">setpoints</span> <span class="n">relative</span> <span class="n">to</span> <span class="n">current</span> <span class="n">position</span> <span class="n">is</span> <span class="n">sent</span>
    <span class="n">async</span><span class="o">:</span> <span class="n">If</span> <span class="nb">true</span><span class="p">,</span> <span class="n">asynchronous</span> <span class="n">mode</span> <span class="n">is</span> <span class="n">set</span>
    <span class="n">body_frame</span><span class="o">:</span> <span class="n">If</span> <span class="nb">true</span><span class="p">,</span> <span class="n">position</span> <span class="n">setpoints</span> <span class="n">are</span> <span class="n">relative</span> <span class="n">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">body</span> <span class="n">frame</span>

<span class="n">Returns</span><span class="o">:</span> <span class="n">For</span> <span class="n">async</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span><span class="p">,</span> <span class="k">else</span> <span class="n">returns</span> <span class="mf">1.</span> <span class="n">For</span> <span class="n">async</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">vehicle</span> <span class="n">reaches</span> <span class="n">given</span> <span class="n">setpoint</span> <span class="n">before</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="n">secs</span><span class="p">,</span> <span class="k">else</span> <span class="n">returns</span> <span class="mf">1.</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">position_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">yaw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">async</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">yaw_valid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                     <span class="n">body_frame</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">position_set</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="kt">float</span> <span class="n">x</span>
    <span class="o">:</span><span class="kt">float</span> <span class="n">y</span>
    <span class="o">:</span><span class="kt">float</span> <span class="n">z</span>
    <span class="o">:</span><span class="kt">float</span> <span class="n">yaw</span>
    <span class="o">:</span><span class="kt">float</span> <span class="n">tolerance</span>
    <span class="o">:</span><span class="kt">bool</span> <span class="n">async</span>
    <span class="o">:</span><span class="kt">bool</span> <span class="n">relative</span>
    <span class="o">:</span><span class="kt">bool</span> <span class="n">yaw_valid</span>
    <span class="o">:</span><span class="kt">bool</span> <span class="n">body_frame</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">position_set</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="nb">float</span> <span class="n">x</span>
    <span class="p">:</span><span class="nb">float</span> <span class="n">y</span>
    <span class="p">:</span><span class="nb">float</span> <span class="n">z</span>
    <span class="p">:</span><span class="nb">float</span> <span class="n">yaw</span>
    <span class="p">:</span><span class="nb">float</span> <span class="n">tolerance</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">async</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">relative</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">yaw_valid</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">body_frame</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/position_set'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">yaw</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">tolerance</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">async</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">relative</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">yaw_valid</span> <span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">body_frame</span> <span class="p">:</span> <span class="nb">Boolean</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/position_set'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/PositionSet'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">yaw</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">tolerance</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">async</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">relative</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">yaw_valid</span> <span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">body_frame</span> <span class="p">:</span> <span class="nb">Boolean</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/navigation/position_set <span class="s2">"{x: 1.0, y: 3.5, z: -5.0, yaw: 0.12, tolerance: 0.0, async: false, relative: false, yaw_valid: true, body_frame: false}"</span>

<span class="c">#sends (x,y,z)=(1.0,3.5,-5.0)(m), yaw=0.12rad, relative=false, async=false, yaw_valid=true, body_frame=false</span>
<span class="c">#default value of tolerance=1.0m if left at 0    </span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">nav</span><span class="p">.</span><span class="n">position_set</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="c1">//sends (x,y,z)=(1.0,3.5,-5.0)(m), yaw=0.12rad, tolerance=2.0m, relative=false, async=false, yaw_valid=true, body_frame=false
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># command vehicle towards 5 metres SOUTH from current location regardless of heading</span>
<span class="n">drone</span><span class="o">.</span><span class="n">position_set</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/PositionSet.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">PositionSet</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/position_set"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">PositionSet</span> <span class="n">srv</span><span class="p">;</span>

<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mf">3.5</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">yaw</span> <span class="o">=</span> <span class="mf">0.12</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">async</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">yaw_valid</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">relative</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">body_frame</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>

<span class="c1">//sends (x,y,z)=(1.0,3.5,-5.0)(m), yaw=0.12rad, tolerance=5.0m, relative=false, async=false, yaw_valid=true, body_frame=false
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">setpoint_local_position</span><span class="p">(</span><span class="n">lx</span><span class="p">,</span> <span class="n">ly</span><span class="p">,</span> <span class="n">lz</span><span class="p">,</span> <span class="n">yaw</span><span class="p">,</span> <span class="n">tolerance</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">async</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">yaw_valid</span><span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">body_frame</span><span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/position_set'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/position_set'</span><span class="p">,</span> <span class="n">PositionSet</span><span class="p">)</span>

        <span class="c"># building message structure</span>
        <span class="n">req_msg</span> <span class="o">=</span> <span class="n">PositionSetRequest</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">lx</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">ly</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">lz</span><span class="p">,</span> <span class="n">yaw</span><span class="o">=</span><span class="n">yaw</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">async</span><span class="o">=</span><span class="n">async</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="n">relative</span><span class="p">,</span> <span class="n">yaw_valid</span><span class="o">=</span><span class="n">yaw_valid</span><span class="p">,</span> <span class="n">body_frame</span><span class="o">=</span><span class="n">body_frame</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">(</span><span class="n">req_msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"pos set service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"x"</span><span class="p">]</span><span class="o">=</span><span class="mf">2.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"y"</span><span class="p">]</span><span class="o">=</span><span class="mf">3.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"z"</span><span class="p">]</span><span class="o">=-</span><span class="mf">1.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"yaw"</span><span class="p">]</span><span class="o">=</span><span class="mf">1.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"tolerance"</span><span class="p">]</span><span class="o">=</span><span class="mf">2.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"async"</span><span class="p">]</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"relative"</span><span class="p">]</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"yaw_valid"</span><span class="p">]</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"body_frame"</span><span class="p">]</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/position_set"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">positionSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/position_set'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/PositionSet'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">x</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">,</span>
    <span class="na">y</span><span class="p">:</span> <span class="mf">3.00</span><span class="p">,</span>
    <span class="na">z</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.00</span><span class="p">,</span>
    <span class="na">yaw</span><span class="p">:</span> <span class="mf">1.00</span><span class="p">,</span>
    <span class="na">tolerance</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">,</span>
    <span class="na">async</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">relative</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="na">yaw_valid</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">body_frame</span> <span class="p">:</span> <span class="kc">false</span>
<span class="p">});</span>

<span class="nx">positionSet</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">positionSet</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="bp">True</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API commands the vehicle to go to a specified location in local frame and hover.  Please check API usage section below before using API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>x, y, z</td>
<td>float</td>
<td>Position Setpoint in NED-Frame (in body-frame if body_frame=true)</td>
</tr>
<tr>
<td>yaw</td>
<td>float</td>
<td>Yaw Setpoint in radians</td>
</tr>
<tr>
<td>yaw_valid</td>
<td>bool</td>
<td>Must be set to true, if yaw</td>
</tr>
<tr>
<td>tolerance</td>
<td>float</td>
<td>Acceptance radius in meters, default value=1.0m</td>
</tr>
<tr>
<td>relative</td>
<td>bool</td>
<td>If true, position setpoints relative to current position is sent</td>
</tr>
<tr>
<td>async</td>
<td>bool</td>
<td>If true, asynchronous mode is set</td>
</tr>
<tr>
<td>body_frame</td>
<td>bool</td>
<td>If true, position setpoints are relative with respect to body frame</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>Vehicle should be in GUIDED or OFFBOARD or API|POSCTL mode for this API to work.</li>
<li>Vehicle should be armed for this API to work.</li>
<li>Do not call this API when vehicle is grounded. Use take_off API first to get the vehicle in air.</li>
<li>X,Y,Z are position setpoints in 3 linear axes. Yaw is angular rotation around Z axis. Right hand notation is used to find positive yaw direction.</li>
<li>Effect of parameters:

<ul>
<li>Async:

<ul>
<li>True: The API call would return as soon as the command has been sent to the autopilot, irrespective of whether the vehicle has reached the given setpoint or not.</li>
<li>False: The API call would wait for the function to return, which happens when either the position setpoint is reached or timeout=30secs is over.</li>
</ul></li>
<li>Relative: 

<ul>
<li>True: Linear position setpoints (x,y,z) are calculated from current location. Home location is not relevant. Yaw is calculated from North.</li>
<li>False: Linear position setpoints (x,y,z) are calculated from home location. Home location is reset every time vehicle arms. Yaw is calculated from North. </li>
</ul></li>
<li>Body_frame 

<ul>
<li>True: All the setpoints are converted to body frame. </li>
<li>Front of vehicle : +x</li>
<li>Right of vehicle : +y</li>
<li>Down: +z</li>
<li>Yaw is calculated from front of vehicle. </li>
<li>False: All the setpoints are converted to local NED (North, East, Down) frame. Yaw is calculated from North. </li>
</ul></li>
</ul></li>
<li>Either body_frame or relative flag can be set to true at a time. If both are set then only body_frame is effective.</li>
<li>For yaw setpoint to be effective the yaw_valid argument must be set to true.</li>
<li>This API overrides any previous mission / navigation API being carried out.</li>
<li>This API requires position lock. GPS, Optical Flow, VICON system can provide position data to vehicle.</li>
<li>To provide only Yaw setpoint use this API with x,y,z arguments set to 0, relative=True, yaw_valid=True</li>
<li>Following parameters need to be manually configured according to vehicle frame.

<ul>
<li>MPC_XY_VEL_MAX : Maximum horizontal velocity. For smaller and lighter this parameter could be set to value between 8 m/s to 15 m/s. For larger and heavier systems it is safer to set this value below 8 m/s.</li>
<li>MPC_Z_VEL_MAX : Maximum vertical velocity. For smaller and lighter this parameter could be set to value between 3 m/s to 10 m/s. For larger and heavier systems it is safer to set this value below 8 m/s.</li>
<li>Vehicle will try to go to the setpoint with maximum velocity. At no point the current velocity will exceed limit set by above parameters. So if you want the vehicle to reach a point slowly then reducen the value of above paramters.</li>
</ul></li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/position_set</code></li>
<li>Service Type: <code class="prettyprint">core_api/PositionSet</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/position_set</code></li>
<li>JSON Request:
<code class="prettyprint">{
x: Float,
y: Float,
z: Float,
yaw: Float,
tolerance: Float,
async: Boolean,
relative: Boolean,
yaw_valid : Boolean,
body_frame : Boolean
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/position_set</code></li>
<li>serviceType: <code class="prettyprint">core_api/PositionSet</code></li>
</ul>

          <h2 id="global-position-setpoint">Global Position Setpoint</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/position_set_global
ROS-Service Type: core_api/PositionSetGlobal, below is its description

<span class="c">#Request : expects position setpoint via lat_x, long_y, rel_alt_z(altitude from home)</span>
<span class="c">#Request : expects yaw setpoint via yaw (send yaw_valid=true)</span>
geometry_msgs/TwistStamped twist <span class="c">#deprecated, instead use lat_x,long_y,rel_alt_z,yaw</span>
float32 lat_x
float32 long_y
float32 rel_alt_z
float32 yaw
float32 tolerance
bool async
bool yaw_valid

<span class="c">#Response : return success=true, (if async=false &amp;&amp; if setpoint reached before timeout = 30sec) || (if async=true &amp;&amp; command sent to autopilot)</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span>     <span class="kt">int</span> <span class="n">position_set_global</span><span class="p">(</span><span class="kt">float</span> <span class="n">lat_x</span><span class="p">,</span> <span class="kt">float</span> <span class="n">long_y</span><span class="p">,</span> <span class="kt">float</span> <span class="n">rel_alt_z</span><span class="p">,</span> <span class="kt">float</span> <span class="n">yaw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kt">float</span> <span class="n">tolerance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">async</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">yaw_valid</span><span class="o">=</span><span class="nb">false</span><span class="p">);</span>
<span class="n">Arguments</span><span class="o">:</span>
    <span class="o">:</span><span class="n">lat_x</span><span class="o">:</span> <span class="n">Latitude</span>
    <span class="o">:</span><span class="n">long_y</span><span class="o">:</span> <span class="n">Longitude</span>
    <span class="o">:</span><span class="n">rel_alt_z</span><span class="o">:</span> <span class="n">Altitue</span> <span class="p">(</span><span class="n">Positive</span> <span class="n">distance</span> <span class="n">upwards</span> <span class="n">from</span> <span class="n">home</span> <span class="n">position</span><span class="p">)</span>
    <span class="o">:</span><span class="n">yaw</span><span class="o">:</span> <span class="n">Yaw</span> <span class="n">Setpoint</span> <span class="n">in</span> <span class="n">radians</span>
    <span class="o">:</span><span class="n">yaw_valid</span><span class="o">:</span> <span class="n">Must</span> <span class="n">be</span> <span class="n">set</span> <span class="n">to</span> <span class="nb">true</span><span class="p">,</span> <span class="k">if</span> <span class="n">yaw</span> <span class="n">setpoint</span> <span class="n">is</span> <span class="n">provided</span>
    <span class="o">:</span><span class="n">tolerance</span><span class="o">:</span> <span class="n">Acceptance</span> <span class="n">radius</span> <span class="n">in</span> <span class="n">meters</span><span class="p">,</span> <span class="k">default</span> <span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="n">m</span>
    <span class="o">:</span><span class="n">async</span><span class="o">:</span> <span class="n">If</span> <span class="nb">true</span><span class="p">,</span> <span class="n">asynchronous</span> <span class="n">mode</span> <span class="n">is</span> <span class="n">set</span>
    <span class="o">:</span><span class="n">returns</span><span class="o">:</span> <span class="n">For</span> <span class="n">async</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span><span class="p">,</span> <span class="k">else</span> <span class="n">returns</span> <span class="mf">1.</span> <span class="n">For</span> <span class="n">async</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">vehicle</span> <span class="n">reaches</span> <span class="n">given</span> <span class="n">setpoint</span> <span class="n">before</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="n">secs</span><span class="p">,</span> <span class="k">else</span> <span class="n">returns</span> <span class="mf">1.</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">position_set_global</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">rel_ht</span><span class="p">,</span> <span class="n">yaw</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">async</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">yaw_valid</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">position_set_global</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="kt">float</span> <span class="n">lat_x</span>
    <span class="o">:</span><span class="kt">float</span> <span class="n">long_y</span>
    <span class="o">:</span><span class="kt">float</span> <span class="n">rel_alt_z</span>
    <span class="o">:</span><span class="kt">float</span> <span class="n">yaw</span>
    <span class="o">:</span><span class="kt">float</span> <span class="n">tolerance</span>
    <span class="o">:</span><span class="kt">bool</span> <span class="n">async</span>
    <span class="o">:</span><span class="kt">bool</span> <span class="n">yaw_valid</span>

<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">position_set_global</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="nb">float</span> <span class="n">lat_x</span>
    <span class="p">:</span><span class="nb">float</span> <span class="n">long_y</span>
    <span class="p">:</span><span class="nb">float</span> <span class="n">rel_alt_z</span>
    <span class="p">:</span><span class="nb">float</span> <span class="n">yaw</span>
    <span class="p">:</span><span class="nb">float</span> <span class="n">tolerance</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">async</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">yaw_valid</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span>
    <span class="nl">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/position_set_global'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">lat_x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">long_y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">rel_alt_z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">yaw</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">tolerance</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">async</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">relative</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">yaw_valid</span> <span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">body_frame</span> <span class="p">:</span> <span class="nb">Boolean</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span>
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span>
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span>
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span>
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/position_set_global'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/PositionSetGlobal'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>       
    <span class="nl">lat_x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">long_y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">rel_alt_z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">yaw</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">tolerance</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">async</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">relative</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">yaw_valid</span> <span class="p">:</span> <span class="nb">Boolean</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>
rosservice call /flytos/navigation/position_set_global <span class="s2">"{ lat_x: 8.04303, long_y: 43.57437, rel_alt_z: 5.0, yaw: 0.12 ,tolerance: 0.0, async: false, yaw_valid: true}"</span>

<span class="c">#sends (Lat,Lon,relAlt)=(8.04303, 43.57437,5.0)(m), yaw=0.12rad, async=false, yaw_valid=true</span>
<span class="c">#default value of tolerance=1.0m if left at 0    </span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">nav</span><span class="p">.</span><span class="n">position_set_global</span><span class="p">(</span><span class="mf">10.342124</span><span class="p">,</span> <span class="mf">13.4323233</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="c1">//sends (Lat,Lon,relAlt)=(10.342124, 13.4323233, 5.0)(m), yaw=0.12rad, tolerance=2.0m, async=false, yaw_valid=true
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># send vehicle to GPS coordinate with height 10 meters above home position.</span>
<span class="n">drone</span><span class="o">.</span><span class="n">position_set_global</span><span class="p">(</span><span class="mf">10.342124</span><span class="p">,</span> <span class="mf">13.4323233</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/PositionSetGlobal.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">PositionSetGlobal</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/position_set_global"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">PositionSetGlobal</span> <span class="n">srv</span><span class="p">;</span>

<span class="n">srv</span><span class="p">.</span><span class="n">lat_x</span> <span class="o">=</span> <span class="mf">10.342124</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">long_y</span> <span class="o">=</span> <span class="mf">13.4323233</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">rel_alt_z</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">yaw</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">async</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">yaw_valid</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">setpoint_global_position</span><span class="p">(</span><span class="n">lat_x</span><span class="p">,</span> <span class="n">long_y</span><span class="p">,</span> <span class="n">rel_alt_z</span><span class="p">,</span> <span class="n">yaw</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">async</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">yaw_valid</span><span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/position_set_global'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/position_set_global'</span><span class="p">,</span> <span class="n">PositionSetGlobal</span><span class="p">)</span>

        <span class="c"># build message structure</span>
        <span class="n">req_msg</span> <span class="o">=</span> <span class="n">PositionSetGlobalRequest</span><span class="p">(</span><span class="n">lat_x</span><span class="o">=</span><span class="n">lat_x</span><span class="p">,</span> <span class="n">long_y</span><span class="o">=</span><span class="n">long_y</span><span class="p">,</span> <span class="n">rel_alt_z</span><span class="o">=</span><span class="n">rel_alt_z</span><span class="p">,</span> <span class="n">yaw</span><span class="o">=</span><span class="n">yaw</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">async</span><span class="o">=</span><span class="n">async</span><span class="p">,</span> <span class="n">yaw_valid</span><span class="o">=</span><span class="n">yaw_valid</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">(</span><span class="n">req_msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>

    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"global pos set service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"lat_x"</span><span class="p">]</span><span class="o">=</span><span class="mf">10.342124</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"long_y"</span><span class="p">]</span><span class="o">=</span><span class="mf">13.4323233</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"rel_alt_z"</span><span class="p">]</span><span class="o">=</span><span class="mf">5.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"yaw"</span><span class="p">]</span><span class="o">=</span><span class="mf">1.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"tolerance"</span><span class="p">]</span><span class="o">=</span><span class="mf">2.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"async"</span><span class="p">]</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"relative"</span><span class="p">]</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"yaw_valid"</span><span class="p">]</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/position_set_global"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">positionSetGlobal</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/position_set_global'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/PositionSetGlobal'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">lat_x</span><span class="p">:</span> <span class="mf">10.342124</span><span class="p">,</span>
    <span class="na">long_y</span><span class="p">:</span> <span class="mf">13.4323233</span><span class="p">,</span>
    <span class="na">rel_alt_z</span><span class="p">:</span> <span class="mf">5.00</span><span class="p">,</span>
    <span class="na">yaw</span><span class="p">:</span> <span class="mf">1.00</span><span class="p">,</span>
    <span class="na">tolerance</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">,</span>
    <span class="na">async</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">relative</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="na">yaw_valid</span> <span class="p">:</span> <span class="kc">true</span>
<span class="p">});</span>

<span class="nx">positionSetGlobal</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">positionSetGlobal</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="bp">True</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API sets a desired position setpoint in global coordinate system (WGS84). Please check API usage section below before using API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard C++ and Python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms.</p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>lat_x</td>
<td>float</td>
<td>Latitude</td>
</tr>
<tr>
<td>long_y</td>
<td>float</td>
<td>Longitude</td>
</tr>
<tr>
<td>rel_alt_z</td>
<td>float</td>
<td>relative height from current location in meters</td>
</tr>
<tr>
<td>yaw</td>
<td>float</td>
<td>Yaw Setpoint in radians</td>
</tr>
<tr>
<td>yaw_valid</td>
<td>bool</td>
<td>Must be set to true, if yaw</td>
</tr>
<tr>
<td>tolerance</td>
<td>float</td>
<td>Acceptance radius in meters, default value=1.0m</td>
</tr>
<tr>
<td>async</td>
<td>bool</td>
<td>If true, asynchronous mode is set</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>Vehicle should be in GUIDED or OFFBOARD or API|POSCTL mode for this API to work.</li>
<li>Vehicle should be armed for this API to work.</li>
<li>Do not call this API when vehicle is grounded. Use take_off API first to get the vehicle in air.</li>
<li>Right hand notation is used to find positive yaw direction.</li>
<li>rel_alt_z parameter is always positive.</li>
<li>rel_alt_z parameter should be calculated relative to ground. E.g. If vehicle is at position A hovering above ground at 10 meters and is then commanded to reach to point B which is 5 meters higher than point A then rel_alt_z should be 10+5=15.</li>
<li>Effect of parameters:

<ul>
<li>Async:

<ul>
<li>True: The API call would return as soon as the command has been sent to the autopilot, irrespective of whether the vehicle has reached the given setpoint or not.</li>
<li>False: The API call would wait for the function to return, which happens when either the position setpoint is reached or timeout=30secs is over.</li>
</ul></li>
</ul></li>
<li>For yaw setpoint to be effective the yaw_valid argument must be set to true.</li>
<li>This API overrides any previous mission / navigation API being carried out.</li>
<li>This API requires global position lock. So using a GPS receiver is must for this API to work.</li>
<li>Following parameters need to be manually configured according to vehicle frame.

<ul>
<li>MPC_XY_VEL_MAX : Maximum horizontal velocity. For smaller and lighter this parameter could be set to value between 8 m/s to 15 m/s. For larger and heavier systems it is safer to set this value below 8 m/s.</li>
<li>MPC_Z_VEL_MAX : Maximum vertical velocity. For smaller and lighter this parameter could be set to value between 3 m/s to 10 m/s. For larger and heavier systems it is safer to set this value below 8 m/s.</li>
<li>Vehicle will try to go to the setpoint with maximum velocity. At no point the current velocity will exceed limit set by above parameters. So if you want the vehicle to reach a point slowly then reducen the value of above paramters.</li>
</ul></li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure.</p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/position_set_global</code></li>
<li>Service Type: <code class="prettyprint">PositionSetGlobal</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/position_set_global</code></li>
<li>JSON Request:
<code class="prettyprint">{
lat_x: Float,
long_y: Float,
rel_alt_z: Float,
yaw: Float,
tolerance: Float,
async: Boolean,
relative: Boolean,
yaw_valid : Boolean
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a>
Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: &lsquo;/&lt;namespace&gt;/navigation/position_set_global&rsquo;</br></li>
<li>serviceType: &lsquo;core_api/PositionSetGlobal&rsquo;</li>
</ul>

          <h2 id="velocity-setpoint">Velocity Setpoint</h2>

<blockquote>
<p>Definition</p>
</blockquote>

<aside class="warning">
    This API is not supported for Fixed Wing.
</aside>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/velocity
ROS-Service Type: core_api/VelocitySet, below is its description

<span class="c">#Request : expects velocity setpoint via vx,vy,vz</span>
<span class="c">#Request : expects yaw_rate setpoint via yaw_rate (send yaw_rate_valid=true)</span>
geometry_msgs/TwistStamped twist <span class="c">#deprecated, instead use vx,vy,vz,yaw_rate</span>
float32 vx
float32 vy
float32 vz
float32 yaw_rate
float32 tolerance
bool async
bool relative
bool yaw_rate_valid
bool body_frame

<span class="c">#Response : return success=true, (if async=false &amp;&amp; if setpoint reached before timeout = 30sec) || (if async=true &amp;&amp; command sent to autopilot)</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span>  <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">velocity_set</span><span class="p">(</span><span class="kt">float</span> <span class="n">vx</span><span class="p">,</span> <span class="kt">float</span> <span class="n">vy</span><span class="p">,</span> <span class="kt">float</span> <span class="n">vz</span><span class="p">,</span> <span class="kt">float</span> <span class="n">yaw_rate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">float</span> <span class="n">tolerance</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">relative</span> <span class="o">=</span> <span class="nb">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">async</span> <span class="o">=</span> <span class="nb">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">yaw_rate_valid</span> <span class="o">=</span> <span class="nb">false</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">body_frame</span> <span class="o">=</span> <span class="nb">false</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">vx</span><span class="p">,</span><span class="n">vy</span><span class="p">,</span><span class="n">vz</span><span class="o">:</span> <span class="n">Velocity</span> <span class="n">Setpoint</span> <span class="n">in</span> <span class="n">NED</span><span class="o">-</span><span class="n">Frame</span> <span class="p">(</span><span class="n">in</span> <span class="n">body</span><span class="o">-</span><span class="n">frame</span> <span class="k">if</span> <span class="n">body_frame</span><span class="o">=</span><span class="nb">true</span><span class="p">)</span>
    <span class="n">yaw_rate</span><span class="o">:</span> <span class="n">Yaw_rate</span> <span class="n">Setpoint</span> <span class="n">in</span> <span class="n">radians</span><span class="o">/</span><span class="n">sec</span>
    <span class="n">yaw_rate_valid</span><span class="o">:</span> <span class="n">Must</span> <span class="n">be</span> <span class="n">set</span> <span class="n">to</span> <span class="nb">true</span><span class="p">,</span> <span class="k">if</span> <span class="n">yaw_rate</span> <span class="n">setpoint</span> <span class="n">is</span> <span class="n">provided</span>
    <span class="n">tolerance</span><span class="o">:</span> <span class="n">Acceptance</span> <span class="n">radius</span> <span class="n">in</span> <span class="n">meters</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="k">default</span> <span class="n">value</span><span class="o">=</span><span class="mf">1.0</span><span class="n">m</span><span class="o">/</span><span class="n">s</span>
    <span class="n">relative</span><span class="o">:</span> <span class="n">If</span> <span class="nb">true</span><span class="p">,</span> <span class="n">velocity</span> <span class="n">setpoints</span> <span class="n">relative</span> <span class="n">to</span> <span class="n">current</span> <span class="n">position</span> <span class="n">is</span> <span class="n">sent</span>
    <span class="n">async</span><span class="o">:</span> <span class="n">If</span> <span class="nb">true</span><span class="p">,</span> <span class="n">asynchronous</span> <span class="n">mode</span> <span class="n">is</span> <span class="n">set</span>
    <span class="n">body_frame</span><span class="o">:</span> <span class="n">If</span> <span class="nb">true</span><span class="p">,</span> <span class="n">velocity</span> <span class="n">setpoints</span> <span class="n">are</span> <span class="n">with</span> <span class="n">respect</span> <span class="n">to</span> <span class="n">body</span> <span class="n">frame</span>

<span class="n">Returns</span><span class="o">:</span> <span class="n">For</span> <span class="n">async</span><span class="o">=</span><span class="nb">true</span><span class="p">,</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span><span class="p">,</span> <span class="k">else</span> <span class="n">returns</span> <span class="mf">1.</span> <span class="n">For</span> <span class="n">async</span><span class="o">=</span><span class="nb">false</span><span class="p">,</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">vehicle</span> <span class="n">reaches</span> <span class="n">given</span> <span class="n">setpoint</span> <span class="n">before</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">30</span><span class="n">secs</span><span class="p">,</span> <span class="k">else</span> <span class="n">returns</span> <span class="mf">1.</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">velocity_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">,</span> <span class="n">yaw_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">async</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">yaw_rate_valid</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">body_frame</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">velocity_set</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
        <span class="o">:</span><span class="kt">float</span> <span class="n">vx</span>
        <span class="o">:</span><span class="kt">float</span> <span class="n">vy</span>
        <span class="o">:</span><span class="kt">float</span> <span class="n">vz</span>
        <span class="o">:</span><span class="kt">float</span> <span class="n">yaw_rate</span>
        <span class="o">:</span><span class="kt">float</span> <span class="n">tolerance</span>
        <span class="o">:</span><span class="kt">bool</span> <span class="n">async</span>
        <span class="o">:</span><span class="kt">bool</span> <span class="n">relative</span>
        <span class="o">:</span><span class="kt">bool</span> <span class="n">yaw_rate_valid</span>
        <span class="o">:</span><span class="kt">bool</span> <span class="n">body_frame</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">velocity_set</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
        <span class="p">:</span><span class="nb">float</span> <span class="n">vx</span>
        <span class="p">:</span><span class="nb">float</span> <span class="n">vy</span>
        <span class="p">:</span><span class="nb">float</span> <span class="n">vz</span>
        <span class="p">:</span><span class="nb">float</span> <span class="n">yaw_rate</span>
        <span class="p">:</span><span class="nb">float</span> <span class="n">tolerance</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">async</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">relative</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">yaw_rate_valid</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">body_frame</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">give</span> <span class="nx">velocity</span> <span class="nx">setpoints</span><span class="p">.</span>
 <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/velocity_set'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">vx</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">vy</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">vz</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">yaw_rate</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">tolerance</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">async</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">relative</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">yaw_rate_valid</span> <span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">body_frame</span> <span class="p">:</span> <span class="nb">Boolean</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">give</span> <span class="nx">velocity</span> <span class="nx">setpoints</span><span class="p">.</span>
 <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> <span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/velocity_set'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/VelocitySet'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>       
    <span class="nl">vx</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">vy</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">vz</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">yaw_rate</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">tolerance</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">async</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">relative</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">yaw_valid</span> <span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">body_frame</span> <span class="p">:</span> <span class="nb">Boolean</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/navigation/velocity_set <span class="s2">"{vx: 0.5, vy: 0.2, vz: -0.1, yaw_rate: 0.1, tolerance: 0.0, async: false, relative: false, yaw_rate_valid: true, body_frame: false}"</span>          

<span class="c">#sends (vx,vy,vz)=(0.5,0.2,-0.1)(m/s), yaw_rate=0.1rad/s,  relative=false, async=false, yaw_rate_valid=true, body_frame=false</span>
<span class="c">#default value of tolerance=1.0m/s if left at 0  </span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">nav</span><span class="p">.</span><span class="n">velocity_set</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="c1">//sends (vx,vy,vz)=(1.0,0.5,-1.0)(m/s), yaw_rate=0.12rad/s, tolerance=0.5m/s, relative=false, async=false, yaw_rate_valid=true, body_frame=false
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># fly towards right ( with respect to vehicle current heading) </span>
<span class="n">drone</span><span class="o">.</span><span class="n">velocity_set</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">body_frame</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/PositionSet.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">PositionSet</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/position_set"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">PositionSet</span> <span class="n">srv</span><span class="p">;</span>

<span class="n">srv</span><span class="p">.</span><span class="n">vx</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">vy</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">vz</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">yaw_rate</span> <span class="o">=</span> <span class="mf">0.12</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">async</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">yaw_rate_valid</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">relative</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">body_frame</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>

<span class="c1">//sends (vx,vy,vz)=(1.0,0.5,-1.0)(m/s), yaw_rate=0.12rad/s, tolerance=0.5m/s, relative=false, async=false, yaw_rate_valid=true, body_frame=false
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">setpoint_velocity</span><span class="p">(</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="p">,</span> <span class="n">yaw_rate</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">async</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">yaw_rate_valid</span><span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">body_frame</span><span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/velocity_set'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/velocity_set'</span><span class="p">,</span> <span class="n">VelocitySet</span><span class="p">)</span>
        <span class="c"># build message structure</span>
        <span class="n">req_msg</span> <span class="o">=</span> <span class="n">VelocitySetRequest</span><span class="p">(</span><span class="n">vx</span><span class="o">=</span><span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="o">=</span><span class="n">vy</span><span class="p">,</span> <span class="n">vz</span><span class="o">=</span><span class="n">vz</span><span class="p">,</span> <span class="n">yaw_rate</span><span class="o">=</span><span class="n">yaw_rate</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">async</span><span class="o">=</span><span class="n">async</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="n">relative</span><span class="p">,</span> <span class="n">yaw_rate_valid</span><span class="o">=</span><span class="n">yaw_rate_valid</span><span class="p">,</span> <span class="n">body_frame</span><span class="o">=</span><span class="n">body_frame</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">(</span><span class="n">req_msg</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"vel set service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"vx"</span><span class="p">]</span><span class="o">=</span><span class="mf">2.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"vy"</span><span class="p">]</span><span class="o">=</span><span class="mf">3.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"vz"</span><span class="p">]</span><span class="o">=-</span><span class="mf">1.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"yaw_rate"</span><span class="p">]</span><span class="o">=</span><span class="mf">1.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"tolerance"</span><span class="p">]</span><span class="o">=</span><span class="mf">2.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"async"</span><span class="p">]</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"relative"</span><span class="p">]</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"yaw_rate_valid"</span><span class="p">]</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"body_frame"</span><span class="p">]</span><span class="o">=</span><span class="kc">false</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/velocity_set"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">velocitySet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/velocity_set'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/VelocitySet'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">vx</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">,</span>
    <span class="na">vy</span><span class="p">:</span> <span class="mf">3.00</span><span class="p">,</span>
    <span class="na">vz</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.00</span><span class="p">,</span>
    <span class="na">yaw_rate</span><span class="p">:</span> <span class="mf">1.00</span><span class="p">,</span>
    <span class="na">tolerance</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">,</span>
    <span class="na">async</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">relative</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="na">yaw_rate_valid</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="na">body_frame</span> <span class="p">:</span> <span class="kc">false</span>
<span class="p">});</span>

<span class="nx">velocitySet</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">velocitySet</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="bp">True</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API gives linear (vx,vy,vz) and angular (yaw_rate) velocity setpoint to vehicle. Please check API usage section below before using API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard C++ and Python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>vx, vy, vz</td>
<td>float</td>
<td>Velocity Setpoint in NED-Frame (in body-frame if body_frame=true)</td>
</tr>
<tr>
<td>yaw_rate</td>
<td>float</td>
<td>Yaw rate Setpoint in rad/sec</td>
</tr>
<tr>
<td>yaw_rate_valid</td>
<td>bool</td>
<td>Must be set to true, if yaw</td>
</tr>
<tr>
<td>tolerance</td>
<td>float</td>
<td>Acceptance range in m/s, default value=1.0 m/s</td>
</tr>
<tr>
<td>relative</td>
<td>bool</td>
<td>If true, velocity setpoints relative to current position is sent</td>
</tr>
<tr>
<td>async</td>
<td>bool</td>
<td>If true, asynchronous mode is set</td>
</tr>
<tr>
<td>body_frame</td>
<td>bool</td>
<td>If true, velocity setpoints are relative with respect to body frame</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>Vehicle should be in GUIDED or OFFBOARD or API|POSCTL mode for this API to work.</li>
<li>Vehicle should be armed for this API to work.</li>
<li>Do not call this API when vehicle is grounded. Use take_off API first to get the vehicle in air.</li>
<li>vx,vy,vz are velocity setpoints in 3 linear axes. Yaw rate is rate of angular rotation around Z axis. Right hand notation is used to find positive yaw direction.</li>
<li>Effect of parameters:

<ul>
<li>Async:

<ul>
<li>True: The API call would return as soon as the command has been sent to the autopilot, irrespective of whether the vehicle has achieved the given velocity.</li>
<li>False: The API call would wait for the function to return, which happens when either the velocity setpoint is reached or timeout=30secs is over.</li>
</ul></li>
<li>Relative: 

<ul>
<li>True: All setpoints (vx,vy,vz, yaw_rate) are calculated relative to current velocity. E.g. if vehicle is already flying in X direction with 1 m/s and a velocity call is placed for 2 m/s with relative= True then vehicle velocity target will change to 1+2 = 3 m/s.</li>
<li>False: All setpoints (vx,vy,vz, yaw) are used as absolute velocity setpoints.<br></li>
</ul></li>
<li>Body_frame 

<ul>
<li>True: All the setpoints are converted to body frame. </li>
<li>Front of vehicle : +vx</li>
<li>Right of vehicle : +vy</li>
<li>Down: +vz</li>
<li>Yaw is calculated from front of vehicle. </li>
<li>False: All the setpoints are converted to local NED (North, East, Down) frame. Yaw is calculated from North. </li>
</ul></li>
</ul></li>
<li>Either body_frame or relative flag can be set to true at a time. If both are set then only body_frame is effective.</li>
<li>For yaw rate_ setpoint to be effective the yaw_rate_valid argument must be set to true.</li>
<li>This API overrides any previous mission / navigation API being carried out.</li>
<li>This API requires position lock. GPS, Optical Flow, VICON system can provide position data to vehicle.</li>
<li>To provide only Yaw_rate setpoint use this API with x,y,z arguments set to 0, relative=True, yaw_valid=True</li>
<li>Vehicle will keep flying in the direction specified by API if async= True. If async is False vehicle will stop after achieving target velocities in all directions. Make sure that you are handling such cases where vehicle might keep flying infinitely.</li>
<li>Following parameters need to be manually configured according to vehicle frame.

<ul>
<li>MPC_XY_VEL_MAX : Maximum horizontal velocity. For smaller and lighter this parameter could be set to value between 8 m/s to 15 m/s. For larger and heavier systems it is safer to set this value below 8 m/s.</li>
<li>MPC_Z_VEL_MAX : Maximum vertical velocity. For smaller and lighter this parameter could be set to value between 3 m/s to 10 m/s. For larger and heavier systems it is safer to set this value below 8 m/s.</li>
<li>In any case vehicle will not exceed these velocity limits. So velocity_set call with target velocity beyond these limits will never be returned successful in synchronous mode.</li>
</ul></li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/velocity_set</code></li>
<li>Service Type: <code class="prettyprint">core_api/VelocitySet</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/velocity_set</code></li>
<li>JSON Request:
<code class="prettyprint">{
vx: Float,
vy: Float,
vz: Float,
yaw_rate: Float,
tolerance: Float,
async: Boolean,
relative: Boolean,
yaw_rate_valid : Boolean,
body_frame : Boolean
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/velocity_set</code></li>
<li>serviceType: <code class="prettyprint">core_api/VelocitySet</code></li>
</ul>

          <h2 id="execute-script">Execute Script</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/exec_script
ROS-Service Type: core_api/ExecScript, below is its description

<span class="c">#Request : Expects name of the application to execute and the arguments to be passed to it</span>
string app_name
string arguments

<span class="c">#Response : return success=true if script starts to get executed</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">No</span> <span class="n">CPP</span> <span class="n">API</span> <span class="n">is</span> <span class="n">available</span> <span class="k">for</span> <span class="n">execution</span> <span class="n">of</span> <span class="n">onboard</span> <span class="n">scripts</span><span class="p">.</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">exec_script</span><span class="p">(</span><span class="n">app_name</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">exec_script</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">app_name</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">arguments</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">exec_script</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">app_name</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">arguments</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/exec_script'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">app_name</span> <span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">arguments</span> <span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/exec_script'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ExecScript'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">app_name</span> <span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">arguments</span> <span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /&lt;namespace&gt;/navigation/exec_script <span class="s2">"{}"</span>
</code></pre><pre class="highlight cpp tab-cpp"><code></code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># execute onboard script with name in app_name and arguments to be passed with it as arguments  </span>
<span class="n">drone</span><span class="o">.</span><span class="n">exec_script</span><span class="p">(</span><span class="err">‘</span><span class="n">script</span><span class="err">’</span><span class="p">,</span> <span class="err">‘</span><span class="n">args</span><span class="err">’</span><span class="p">)</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/ExecScript.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">ExecScript</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/exec_script"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">ExecScript</span> <span class="n">srv</span><span class="p">;</span>

<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">app_name</span> <span class="o">=</span> <span class="s">"sample_script.sh"</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">arguments</span> <span class="o">=</span> <span class="s">"arg1 arg2 arg3"</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">script_name</span> <span class="o">=</span> <span class="s">"sample_script.sh"</span>
<span class="n">sample_args</span> <span class="o">=</span> <span class="s">"arg1 arg2 arg3"</span>
<span class="k">def</span> <span class="nf">exec_script</span><span class="p">(</span><span class="n">script_name</span><span class="p">,</span> <span class="n">sample_args</span><span class="p">):</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/exec_script'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/exec_script'</span><span class="p">,</span> <span class="n">ExecScript</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">(</span><span class="n">app_name</span><span class="o">=</span><span class="n">script_name</span><span class="p">,</span> <span class="n">arguments</span><span class="o">=</span> <span class="n">sample_args</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"app_name"</span><span class="p">]</span><span class="o">=</span><span class="s1">'app12'</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"arguments"</span><span class="p">]</span><span class="o">=</span><span class="s1">'2 45 4 run'</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/exec_script"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">execScript</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/exec_script'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ExecScript'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>    
    <span class="na">app_name</span> <span class="p">:</span> <span class="s1">'app12'</span><span class="p">,</span>
    <span class="na">arguments</span> <span class="p">:</span> <span class="s1">'2 45 4 run'</span>
<span class="p">});</span>

<span class="nx">execScript</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">execScript</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code></code></pre><pre class="highlight python tab-python"><code><span class="p">{</span><span class="s">'message'</span><span class="p">:</span> <span class="s">''</span><span class="p">,</span> <span class="s">'success'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">message</span> <span class="p">(</span><span class="n">string</span><span class="p">):</span>  <span class="n">Contains</span> <span class="n">the</span> <span class="n">error</span> <span class="n">message</span> <span class="k">if</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">unable</span> <span class="n">to</span> <span class="n">run</span> <span class="n">the</span> <span class="n">script</span><span class="o">.</span>
<span class="n">success</span> <span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API can run onboard executable scripts in python, shell, etc. </p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>app_name</td>
<td>string</td>
<td>Name of the script. Script should be present in /flyt/flytapps/onboard_user/install directory.</td>
</tr>
<tr>
<td>arguments</td>
<td>string</td>
<td>arguments separated by space e.g. &ldquo;arg1 arg2 arg3&rdquo;</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>Note that the executable should be present in <code class="prettyprint">/flyt/userapps/onboard_user/install</code> directory.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/exec_script</code></li>
<li>Service Type: <code class="prettyprint">ExecScript</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/exec_script</code></li>
<li>JSON Request:
<code class="prettyprint">{
app_name : String,
arguments : String
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/exec_script</code></li>
<li>serviceType: <code class="prettyprint">core_api/ExecScript</code></li>
</ul>

          <h2 id="get-waypoints">Get Waypoints</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/waypoint_get
ROS-Service Type: core_api/WaypointGet, below is its description

<span class="c"># Request: NULL</span>

<span class="c"># Returns success status and received count</span>
bool success
string message
uint32 wp_received
mavros_msgs/Waypoint[] waypoints

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">waypoint_get</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">mavros_msgs</span><span class="o">::</span><span class="n">Waypoint</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">waypoints</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>  <span class="n">waypoints</span><span class="o">:</span> <span class="n">list</span> <span class="n">of</span> <span class="n">waypoints</span> <span class="n">will</span> <span class="n">be</span> <span class="n">made</span> <span class="n">available</span> <span class="n">in</span> <span class="k">this</span> <span class="n">variable</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">waypoint_get</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_get</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="n">Null</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">uint32</span> <span class="n">wp_received</span>
    <span class="o">:</span><span class="n">mavros_msgs</span><span class="o">/</span><span class="n">Waypoint</span><span class="p">[]</span> <span class="n">waypoints</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_get</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">Null</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">uint32</span> <span class="n">wp_received</span>
    <span class="p">:</span><span class="n">mavros_msgs</span><span class="o">/</span><span class="n">Waypoint</span><span class="p">[]</span> <span class="n">waypoints</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_get'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> 
    <span class="nx">wp_recieved</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">waypoints</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="na">frame</span><span class="p">:</span> <span class="nx">Int</span> <span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>
        <span class="na">command</span><span class="p">:</span><span class="nx">Int</span> <span class="mi">16</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">18</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">20</span><span class="o">/</span><span class="mi">21</span><span class="o">/</span><span class="mi">22</span><span class="p">,</span>
        <span class="na">is_current</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
        <span class="na">autocontinue</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
        <span class="na">param1</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">param2</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">param3</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">param4</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">x_lat</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">y_long</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">z_alt</span><span class="p">:</span> <span class="nx">Float</span>
    <span class="p">},</span>
    <span class="p">{},</span>
    <span class="p">{},...</span>
    <span class="p">]</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_get'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/WaypointGet'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> 
    <span class="nx">wp_recieved</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">waypoints</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="na">frame</span><span class="p">:</span> <span class="nx">Int</span> <span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>
        <span class="na">command</span><span class="p">:</span><span class="nx">Int</span> <span class="mi">16</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">18</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">20</span><span class="o">/</span><span class="mi">21</span><span class="o">/</span><span class="mi">22</span><span class="p">,</span>
        <span class="na">is_current</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
        <span class="na">autocontinue</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
        <span class="na">param1</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">param2</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">param3</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">param4</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">x_lat</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">y_long</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="na">z_alt</span><span class="p">:</span> <span class="nx">Float</span>
    <span class="p">},</span>
    <span class="p">{},</span>
    <span class="p">{},...</span>
    <span class="p">]</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/navigation/waypoint_get <span class="s2">"{}"</span> 
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">mavros_msgs</span><span class="o">::</span><span class="n">Waypoint</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">waypoints</span>
<span class="n">nav</span><span class="p">.</span><span class="n">waypoint_get</span><span class="p">(</span><span class="n">waypoints</span><span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"Number of waypoints received</span><span class="se">\t</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">waypoints</span><span class="p">.</span><span class="n">size</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># get list of current waypoints  </span>
<span class="n">wp</span> <span class="o">=</span> <span class="n">drone</span><span class="o">.</span><span class="n">waypoint_get</span><span class="p">()</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_get"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">waypoints</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">waypointGet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_get'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/WaypointGet'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">waypointGet</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">waypointGet</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: True
wp_received: 1
waypoints: 
  - 
    frame: 3
    <span class="nb">command</span>: 16
    is_current: True
    autocontinue: True
    param1: 0.0
    param2: 0.0
    param3: 0.0
    param4: 0.0
    x_lat: 18.6204299927
    y_long: 73.903465271
    z_alt: 50.0
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="p">{</span><span class="s">'wp_received'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">'message'</span><span class="p">:</span> <span class="s">'[INFO] Waypoint get Successful'</span><span class="p">,</span> <span class="s">'success'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">'waypoints'</span><span class="p">:</span> <span class="p">[{</span><span class="s">'autocontinue'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">'frame'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">'command'</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s">'param4'</span><span class="p">:</span> <span class="mf">10.199999809265137</span><span class="p">,</span> <span class="s">'is_current'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">'param2'</span><span class="p">:</span> <span class="mf">10.199999809265137</span><span class="p">,</span> <span class="s">'param1'</span><span class="p">:</span> <span class="mf">10.199999809265137</span><span class="p">,</span> <span class="s">'y_long'</span><span class="p">:</span> <span class="o">-</span><span class="mf">122.08358764648438</span><span class="p">,</span> <span class="s">'param3'</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s">'x_lat'</span><span class="p">:</span> <span class="mf">7.429123401641846</span><span class="p">,</span> <span class="s">'z_alt'</span><span class="p">:</span> <span class="mf">112.61199951171875</span><span class="p">},</span> <span class="p">{</span><span class="s">'autocontinue'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">'frame'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">'command'</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s">'param4'</span><span class="p">:</span> <span class="mf">10.199999809265137</span><span class="p">,</span> <span class="s">'is_current'</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">'param2'</span><span class="p">:</span> <span class="mf">10.199999809265137</span><span class="p">,</span> <span class="s">'param1'</span><span class="p">:</span> <span class="mf">10.199999809265137</span><span class="p">,</span> <span class="s">'y_long'</span><span class="p">:</span> <span class="o">-</span><span class="mf">122.08329010009766</span><span class="p">,</span> <span class="s">'param3'</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s">'x_lat'</span><span class="p">:</span> <span class="mf">7.4294233322143555</span><span class="p">,</span> <span class="s">'z_alt'</span><span class="p">:</span> <span class="mf">112.61199951171875</span><span class="p">}]}</span>


<span class="n">wp_received</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">waypoints</span> <span class="n">received</span>
<span class="n">message</span> <span class="p">(</span><span class="n">string</span><span class="p">):</span> <span class="n">Contains</span> <span class="n">error</span> <span class="n">message</span>
<span class="n">success</span> <span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
<span class="n">waypoints</span> <span class="p">(</span><span class="nb">list</span><span class="p">):</span> <span class="n">consists</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">dictionary</span><span class="p">,</span> <span class="n">the</span> <span class="n">dictionary</span> <span class="n">consists</span> <span class="n">of</span> <span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">command</span><span class="p">,</span> <span class="n">is_current</span><span class="p">,</span> <span class="n">autocontinue</span><span class="p">,</span> <span class="n">param1</span><span class="p">,</span> <span class="n">param2</span><span class="p">,</span> <span class="n">param3</span><span class="p">,</span> <span class="n">param4</span><span class="p">,</span> <span class="n">x_lat</span><span class="p">,</span> <span class="n">y_long</span><span class="p">,</span> <span class="n">z_alt</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nx">True</span><span class="p">,</span> 
    <span class="nx">wp_recieved</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nx">waypoints</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">frame</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="na">command</span><span class="p">:</span><span class="nx">Int</span> <span class="mi">16</span><span class="p">,</span>
        <span class="na">is_current</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="na">autocontinue</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="na">param1</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span>
        <span class="na">param2</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span>
        <span class="na">param3</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="na">param4</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="na">x_lat</span><span class="p">:</span> <span class="mf">65.425532</span><span class="p">,</span>
        <span class="na">y_long</span><span class="p">:</span> <span class="mf">18.542422</span><span class="p">,</span>
        <span class="na">z_alt</span><span class="p">:</span> <span class="mi">25</span><span class="p">},{}]</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nx">True</span><span class="p">,</span> 
    <span class="nx">wp_recieved</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nx">waypoints</span><span class="p">:</span> <span class="p">[{</span>
        <span class="na">frame</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="na">command</span><span class="p">:</span><span class="nx">Int</span> <span class="mi">16</span><span class="p">,</span>
        <span class="na">is_current</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="na">autocontinue</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="na">param1</span><span class="p">:</span> <span class="mf">6.0</span><span class="p">,</span>
        <span class="na">param2</span><span class="p">:</span> <span class="mf">7.0</span><span class="p">,</span>
        <span class="na">param3</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="na">param4</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="na">x_lat</span><span class="p">:</span> <span class="mf">65.425532</span><span class="p">,</span>
        <span class="na">y_long</span><span class="p">:</span> <span class="mf">18.542422</span><span class="p">,</span>
        <span class="na">z_alt</span><span class="p">:</span> <span class="mi">25</span><span class="p">},{}]</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API returns list of current waypoints on autopilot.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments: None</p>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
<tr>
<td>frame</td>
<td>int</td>
<td>The Frame in which the waypoints are given<br>0: Global<br>1: Local NED<br>2: Mission<br>3: Global Rel Alt</td>
</tr>
<tr>
<td>command</td>
<td>int</td>
<td>defines the function of the waypoint<br>16: Waypoints<br>17: Loiter<br>18: Loiter Turns<br>19: Loiter time<br>20: Return to Launch<br>21: Land<br>22: Take Off</td>
</tr>
<tr>
<td>is_current</td>
<td>bool</td>
<td>Set it as the first waypoint</td>
</tr>
<tr>
<td>autocontinue</td>
<td>bool</td>
<td>continue to the next waypoint as soon as the current waypoint is achieved</td>
</tr>
<tr>
<td>param1</td>
<td>float</td>
<td>Time to stay at the location in sec.</td>
</tr>
<tr>
<td>param2</td>
<td>float</td>
<td>radius around the waypoint within which the waypoint is marked as done</td>
</tr>
<tr>
<td>param3</td>
<td>float</td>
<td>Orbit radius in meters</td>
</tr>
<tr>
<td>param4</td>
<td>float</td>
<td>Yaw/direction in degrees</td>
</tr>
<tr>
<td>x_lat</td>
<td>float</td>
<td>Latitude</td>
</tr>
<tr>
<td>y_long</td>
<td>float</td>
<td>Longitude</td>
</tr>
<tr>
<td>z_alt</td>
<td>float</td>
<td>Relative altitude</td>
</tr>
</tbody></table>

<aside class="notice">
    See actual response body on the right.
</aside>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_get</code></li>
<li>Service Type: <code class="prettyprint">core_api/WaypointGet</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_get</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean,
message: String, 
wp_recieved: Int,
waypoints: [{
    frame: Int 0/1/2/3/4,
    command:Int 16/17/18/19/20/21/22,
    is_current: Boolean,
    autocontinue: Boolean,
    param1: Float,
    param2: Float,
    param3: Float,
    param4: Float,
    x_lat: Float,
    y_long: Float,
    z_alt: Float},{},{}...] }
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_get</code></li>
<li>serviceType: <code class="prettyprint">core_api/WaypointGet</code></li>
</ul>

          <h2 id="set-waypoints">Set Waypoints</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/waypoint_set
ROS-Service Type: core_api/WaypointSet, below is its description

<span class="c"># Request: Waypoints to be sent to device</span>
mavros_msgs/Waypoint[] waypoints

<span class="c"># Returns: success status and transfered count</span>
bool success
string message
uint32 wp_transfered

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// CPP API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from cpp.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span>    <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">waypoint_set</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">mavros_msgs</span><span class="o">::</span><span class="n">Waypoint</span><span class="o">&gt;</span> <span class="n">waypoints</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">waypoint</span><span class="o">:</span> <span class="n">Array</span> <span class="n">of</span> <span class="n">waypoints</span> <span class="n">to</span> <span class="n">be</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">autopilot</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">land</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span><span class="p">,</span> <span class="k">else</span> <span class="n">returns</span> <span class="mf">1.</span>

</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">waypoint_set</span><span class="p">(</span><span class="n">waypoints</span><span class="p">)</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_set</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="n">mavros_msgs</span><span class="o">/</span><span class="n">Waypoint</span><span class="p">[]</span> <span class="n">waypoints</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">uint32</span> <span class="n">wp_transfered</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_set</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="n">mavros_msgs</span><span class="o">/</span><span class="n">Waypoint</span><span class="p">[]</span> <span class="n">waypoints</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">uint32</span> <span class="n">wp_transfered</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_set'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">waypoints</span><span class="p">:[</span>
    <span class="p">{</span>
        <span class="na">frame</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Int</span><span class="p">]</span> <span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>
        <span class="na">command</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Int</span><span class="p">]</span> <span class="mi">16</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">18</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">20</span><span class="o">/</span><span class="mi">21</span><span class="o">/</span><span class="mi">22</span><span class="p">,</span>
        <span class="na">is_current</span> <span class="p">:</span> <span class="p">[</span><span class="nb">Boolean</span><span class="p">],</span>
        <span class="na">autocontinue</span> <span class="p">:</span> <span class="p">[</span><span class="nb">Boolean</span><span class="p">],</span>
        <span class="na">param1</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">param2</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">param3</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">param4</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">x_lat</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">y_long</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">z_alt</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="p">{},</span>
    <span class="p">{},...</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_set'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/WaypointSet'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">waypoints</span><span class="p">:[</span>
    <span class="p">{</span>
        <span class="na">frame</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Int</span><span class="p">]</span> <span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>
        <span class="na">command</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Int</span><span class="p">]</span> <span class="mi">16</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">18</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">20</span><span class="o">/</span><span class="mi">21</span><span class="o">/</span><span class="mi">22</span><span class="p">,</span>
        <span class="na">is_current</span> <span class="p">:</span> <span class="p">[</span><span class="nb">Boolean</span><span class="p">],</span>
        <span class="na">autocontinue</span> <span class="p">:</span> <span class="p">[</span><span class="nb">Boolean</span><span class="p">],</span>
        <span class="na">param1</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">param2</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">param3</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">param4</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">x_lat</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">y_long</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">z_alt</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
    <span class="p">},</span>
    <span class="p">{},</span>
    <span class="p">{},...</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>  rosservice call /flytos/navigation/waypoint_set <span class="s2">"waypoints:
- {frame: 0, command: 0, is_current: false, autocontinue: false, param1: 0.0, param2: 0.0,
  param3: 0.0, param4: 0.0, x_lat: 0.0, y_long: 0.0, z_alt: 0.0}"</span> 

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">mavros_msgs</span><span class="o">::</span><span class="n">Waypoint</span> <span class="n">waypoint</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">mavros_msgs</span><span class="o">::</span><span class="n">Waypoint</span><span class="o">&gt;</span> <span class="n">waypoints_array</span><span class="p">;</span>
<span class="n">waypoint</span><span class="p">.</span><span class="n">frame</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">waypoint</span><span class="p">.</span><span class="n">command</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
<span class="n">waypoint</span><span class="p">.</span><span class="n">is_current</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">waypoint</span><span class="p">.</span><span class="n">autocontinue</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="n">waypoint</span><span class="p">.</span><span class="n">param1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
<span class="n">waypoint</span><span class="p">.</span><span class="n">param2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">waypoint</span><span class="p">.</span><span class="n">param3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">waypoint</span><span class="p">.</span><span class="n">param4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">waypoint</span><span class="p">.</span><span class="n">x_lat</span> <span class="o">=</span> <span class="mf">73.2154</span><span class="p">;</span>
<span class="n">waypoint</span><span class="p">.</span><span class="n">x_long</span> <span class="o">=</span> <span class="mf">18.5472</span><span class="p">;</span>
<span class="n">waypoint</span><span class="p">.</span><span class="n">z_alt</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="n">waypoints_array</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">waypoint</span><span class="p">)</span>
<span class="n">nav</span><span class="p">.</span><span class="n">waypoint_set</span><span class="p">(</span><span class="n">waypoints_array</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#for multiple waypoints</span>
<span class="c">#list of waypoints to be constructed</span>
<span class="n">wp4</span> <span class="o">=</span>  <span class="p">[{</span><span class="s">'frame'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
       <span class="s">'command'</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
       <span class="s">'is_current'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
       <span class="s">'autocontinue'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
       <span class="s">'param1'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param2'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param3'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param4'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'x_lat'</span><span class="p">:</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">0.0002</span><span class="p">,</span>
       <span class="s">'y_long'</span><span class="p">:</span> <span class="n">y</span> <span class="o">-</span> <span class="mf">0.0002</span><span class="p">,</span>
       <span class="s">'z_alt'</span><span class="p">:</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">10</span>
       <span class="p">},</span>
      <span class="p">{</span><span class="s">'frame'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
       <span class="s">'command'</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
       <span class="s">'is_current'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
       <span class="s">'autocontinue'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
       <span class="s">'param1'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param2'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param3'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param4'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'x_lat'</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="mf">0.0001</span><span class="p">,</span>
       <span class="s">'y_long'</span><span class="p">:</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.0001</span><span class="p">,</span>
       <span class="s">'z_alt'</span><span class="p">:</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">10</span>
       <span class="p">},</span>
      <span class="p">{</span><span class="s">'frame'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
       <span class="s">'command'</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
       <span class="s">'is_current'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
       <span class="s">'autocontinue'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
       <span class="s">'param1'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param2'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param3'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param4'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'x_lat'</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
       <span class="s">'y_long'</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
       <span class="s">'z_alt'</span><span class="p">:</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">10</span>
       <span class="p">},</span>
       <span class="p">{</span><span class="s">'frame'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s">'command'</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
        <span class="s">'is_current'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s">'autocontinue'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
        <span class="s">'param1'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
        <span class="s">'param2'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
        <span class="s">'param3'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
        <span class="s">'param4'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
        <span class="s">'x_lat'</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.0001</span><span class="p">,</span>
        <span class="s">'y_long'</span><span class="p">:</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.0001</span><span class="p">,</span>
        <span class="s">'z_alt'</span><span class="p">:</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">10</span>
       <span class="p">}]</span>

<span class="c"># set list of current waypoints  </span>
<span class="n">drone</span><span class="o">.</span><span class="n">waypoint_set</span><span class="p">(</span><span class="n">wp4</span><span class="p">)</span>

<span class="c">#for single waypoint</span>
<span class="n">wp1</span> <span class="o">=</span> <span class="p">{</span><span class="s">'frame'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
       <span class="s">'command'</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
       <span class="s">'is_current'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
       <span class="s">'autocontinue'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
       <span class="s">'param1'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param2'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param3'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'param4'</span><span class="p">:</span> <span class="mf">10.2</span><span class="p">,</span>
       <span class="s">'x_lat'</span><span class="p">:</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">0.0002</span><span class="p">,</span>
       <span class="s">'y_long'</span><span class="p">:</span> <span class="n">y</span> <span class="o">-</span> <span class="mf">0.0002</span><span class="p">,</span>
       <span class="s">'z_alt'</span><span class="p">:</span> <span class="n">z</span> <span class="o">+</span> <span class="mi">10</span>
       <span class="p">}</span>
<span class="c">#set list of current waypoints</span>
<span class="n">drone</span><span class="o">.</span><span class="n">waypoint_set</span><span class="p">(</span><span class="n">wp1</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">[];</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"frame"</span><span class="p">]</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"command"</span><span class="p">]</span><span class="o">=</span> <span class="mi">16</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"is_current"</span><span class="p">]</span><span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"autocontinue"</span><span class="p">]</span><span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"param1"</span><span class="p">]</span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"param2"</span><span class="p">]</span><span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"param3"</span><span class="p">]</span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"param4"</span><span class="p">]</span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"x_lat"</span><span class="p">]</span><span class="o">=</span> <span class="mf">73.2154</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"y_long"</span><span class="p">]</span><span class="o">=</span> <span class="mf">18.5472</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">"z_alt"</span><span class="p">]</span><span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_set"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">waypointSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_set'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/WaypointSet'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">waypoints</span><span class="p">:[{</span>
        <span class="na">frame</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Int</span><span class="p">]</span> <span class="mi">0</span><span class="o">/</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>
        <span class="na">command</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Int</span><span class="p">]</span> <span class="mi">16</span><span class="o">/</span><span class="mi">17</span><span class="o">/</span><span class="mi">18</span><span class="o">/</span><span class="mi">19</span><span class="o">/</span><span class="mi">20</span><span class="o">/</span><span class="mi">21</span><span class="o">/</span><span class="mi">22</span><span class="p">,</span>
        <span class="na">is_current</span> <span class="p">:</span> <span class="p">[</span><span class="nb">Boolean</span><span class="p">],</span>
        <span class="na">autocontinue</span> <span class="p">:</span> <span class="p">[</span><span class="nb">Boolean</span><span class="p">],</span>
        <span class="na">param1</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">param2</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">param3</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">param4</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">x_lat</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">y_long</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="na">z_alt</span> <span class="p">:</span> <span class="p">[</span><span class="nx">Float</span><span class="p">],</span>
        <span class="p">},{},{}...</span> <span class="p">]</span>
<span class="p">});</span>

<span class="nx">waypointSet</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">waypointSet</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: True
wp_transfered: 0
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="p">{</span><span class="s">'message'</span><span class="p">:</span> <span class="s">'[INFO] Waypoint set Successful'</span><span class="p">,</span> <span class="s">'wp_transfered'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">'success'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>


<span class="n">wp_transfered</span> <span class="p">(</span><span class="nb">int</span><span class="p">):</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">waypoints</span> <span class="n">transfered</span>
<span class="n">message</span> <span class="p">(</span><span class="n">string</span><span class="p">):</span> <span class="n">Contains</span> <span class="n">error</span> <span class="n">message</span>
<span class="n">success</span> <span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API replaces current list of waypoints on autopilot with new list passed.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>frame</td>
<td>int</td>
<td>The Frame in which the waypoints are given<br>0: Global<br>1: Local NED<br>2: Mission<br>3: Global Rel Alt</td>
</tr>
<tr>
<td>command</td>
<td>int</td>
<td>defines the function of the waypoint<br>16: Waypoints<br>17: Loiter<br>18: Loiter Turns<br>19: Loiter time<br>20: Return to Launch<br>21: Land<br>22: Take Off</td>
</tr>
<tr>
<td>is_current</td>
<td>bool</td>
<td>Set it as the first waypoint</td>
</tr>
<tr>
<td>autocontinue</td>
<td>bool</td>
<td>continue to the next waypoint as soon as the current waypoint is achieved</td>
</tr>
<tr>
<td>param1</td>
<td>float</td>
<td>Time to stay at the location in sec.</td>
</tr>
<tr>
<td>param2</td>
<td>float</td>
<td>radius around the waypoint within which the waypoint is marked as done</td>
</tr>
<tr>
<td>param3</td>
<td>float</td>
<td>Orbit radius in meters</td>
</tr>
<tr>
<td>param4</td>
<td>float</td>
<td>Yaw/direction in degrees</td>
</tr>
<tr>
<td>x_lat</td>
<td>float</td>
<td>Latitude</td>
</tr>
<tr>
<td>y_long</td>
<td>float</td>
<td>Longitude</td>
</tr>
<tr>
<td>z_alt</td>
<td>float</td>
<td>Relative altitude</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_set</code></li>
<li>Service Type: <code class="prettyprint">WaypointSet</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_set</code></li>
<li>JSON Request:
<code class="prettyprint">{
waypoints:[{
    frame : [Int] 0/1/2/3/4,
    command : [Int] 16/17/18/19/20/21/22,
    is_current : [Boolean],
    autocontinue : [Boolean],
    param1 : [Float],
    param2 : [Float],
    param3 : [Float],
    param4 : [Float],
    x_lat : [Float],
    y_long : [Float],
    z_alt : [Float],
    },{},{}... ]
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_set</code></li>
<li>serviceType: <code class="prettyprint">core_api/WaypointSet</code></li>
</ul>

          <h2 id="execute-waypoints">Execute Waypoints</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/waypoint_execute
ROS-Service Type: core_api/waypointExecute, below is its description

<span class="c">#Request : Null</span>

<span class="c">#Response : success = true if command sent successfully</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">waypoint_execute</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>  <span class="n">None</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">drone</span><span class="o">.</span><span class="n">waypoint_execute</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_execute</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="nb">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_execute</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_execute'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_execute'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/WaypointExecute'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytsim/navigation/waypoint_execute <span class="s2">"{}"</span>   
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">nav</span><span class="p">.</span><span class="n">waypoint_execute</span><span class="p">();</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#execute the waypoints</span>
<span class="n">drone</span><span class="o">.</span><span class="n">waypoint_execute</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_execute"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">waypointExecute</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_execute'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/WaypointExecute'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">waypointExecute</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">waypointExecute</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="p">{</span><span class="s">'message'</span><span class="p">:</span> <span class="s">'[INFO] Waypoint Execution initiated'</span><span class="p">,</span> <span class="s">'success'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">message</span> <span class="p">(</span><span class="n">string</span><span class="p">):</span> <span class="n">Contains</span> <span class="n">error</span> <span class="n">message</span>
<span class="n">success</span> <span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>Exectute / resume current list of waypoints.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<p>Note: Make sure you have a list of waypoints already set using <code class="prettyprint">set_waypoints</code> API before you give it execute_waypoint API call.</p>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_execute</code></li>
<li>Service Type: <code class="prettyprint">WaypointExecute</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_execute</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_execute</code></li>
<li>serviceType: <code class="prettyprint">core_api/WaypointExecute</code></li>
</ul>

          <h2 id="clear-waypoints">Clear Waypoints</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/waypoint_clear
ROS-Service Type: core_api/WaypointClear, below is its description

<span class="c">#Request : Null</span>

<span class="c">#Response : success = true if command sent successfully</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">waypoint_clear</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>  <span class="n">None</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span>  <span class="n">waypoint_clear</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_clear</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="nb">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_clear</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_clear'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_clear'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/WaypointClear'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/navigation/waypoint_clear <span class="s2">"{}"</span>   
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">nav</span><span class="p">.</span><span class="n">waypoint_clear</span><span class="p">();</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#clear the currently set waypoints</span>
<span class="n">drone</span><span class="o">.</span><span class="n">waypoint_clear</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_clear"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">waypointClear</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_clear'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/WaypointClear'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">waypointClear</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">waypointClear</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="p">{</span><span class="s">'message'</span><span class="p">:</span> <span class="s">'[INFO] Waypoint clear Successful'</span><span class="p">,</span> <span class="s">'success'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">message</span> <span class="p">(</span><span class="n">string</span><span class="p">):</span> <span class="n">Contains</span> <span class="n">error</span> <span class="n">message</span>
<span class="n">success</span> <span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>Clear list of waypoints on autopilot.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_clear</code></li>
<li>Service Type: <code class="prettyprint">WaypointClear</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_clear</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_clear</code></li>
<li>serviceType: <code class="prettyprint">core_api/WaypointClear</code></li>
</ul>

          <h2 id="pause-waypoints">Pause Waypoints</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/waypoint_pause
ROS-Service Type: core_api/WaypointPause, below is its description

<span class="c">#Request : Null</span>

<span class="c">#Response : success = true if command sent successfully</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">waypoint_pause</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>  <span class="n">None</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span>  <span class="n">waypoint_pause</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_pause</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="nb">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_pause</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_pause'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_pause'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/WaypointPause'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/navigation/waypoint_pause <span class="s2">"{}"</span>      
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">nav</span><span class="p">.</span><span class="n">waypoint_pause</span><span class="p">();</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#pause the waypoints mission</span>
<span class="n">drone</span><span class="o">.</span><span class="n">waypoint_pause</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_pause"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">waypointPause</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_pause'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/WaypointPause'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">waypointPause</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">waypointPause</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="p">{</span><span class="s">'message'</span><span class="p">:</span> <span class="s">'[INFO] Waypoint Paused'</span><span class="p">,</span> <span class="s">'success'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">message</span> <span class="p">(</span><span class="n">string</span><span class="p">):</span> <span class="n">Contains</span> <span class="n">error</span> <span class="n">message</span>
<span class="n">success</span> <span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API pauses ongoing waypoint mission.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_pause</code></li>
<li>Service Type: <code class="prettyprint">WaypointPause</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_pause</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean,
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_pause</code></li>
<li>serviceType: <code class="prettyprint">core_api/WaypointPause</code></li>
</ul>

          <h2 id="set-current-waypoint">Set Current Waypoint</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/waypoint_set_current
ROS-Service Type: core_api/WaypointSetCurrent, below is its description

<span class="c"># Request: set current waypoint to index ( wp_seq ) in waypoint array</span>
uint16 wp_seq
<span class="c"># Response: success if command sent successfully</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">waypoint_set_current</span><span class="p">(</span><span class="kt">int</span> <span class="n">waypoint_no</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>  
    <span class="n">waypoint_no</span><span class="o">:</span> <span class="n">Index</span> <span class="n">of</span> <span class="n">waypoint</span> <span class="n">to</span> <span class="n">be</span> <span class="n">set</span> <span class="n">as</span> <span class="n">current</span> <span class="n">waypoint</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span>  <span class="n">waypoint_set_current</span><span class="p">(</span><span class="n">wp_seq</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_set_current</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="n">uint16</span> <span class="n">wp_seq</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">waypoint_set_current</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">uint16</span> <span class="n">wp_seq</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_set_current'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">wp_seq</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_set_current'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/WaypointSetCurrent'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">wp_seq</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytsim/navigation/waypoint_set_current <span class="s2">"wp_seq: 1"</span> 
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">waypoint_no</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">nav</span><span class="p">.</span><span class="n">waypoint_set_current</span><span class="p">(</span><span class="n">waypoint_no</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#setting the 2nd waypoint as the current waypoint</span>
<span class="n">drone</span><span class="o">.</span><span class="n">waypoint_set_current</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"wp_seq"</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_set_current"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">waypointSetCurrent</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/waypoint_set_current'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/WaypointSetCurrent'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">wp_seq</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">});</span>

<span class="nx">waypointSetCurrent</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span><span class="nx">waypointSetCurrent</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="p">{</span><span class="s">'message'</span><span class="p">:</span> <span class="s">'[INFO] Waypoint set_current Successful'</span><span class="p">,</span> <span class="s">'success'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">message</span> <span class="p">(</span><span class="n">string</span><span class="p">):</span> <span class="n">Contains</span> <span class="n">error</span> <span class="n">message</span>
<span class="n">success</span> <span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>Sets the waypoint Id specified, as the current waypoint from the list of already set wayopints.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>wp_seq</td>
<td>int</td>
<td>Id of the waypoint fro  the list of set waypoints.</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<aside class="notice">
    Make sure you already have a waypoint list set beforehand executing this API for it to work.
</aside>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure.</p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_set_current</code></li>
<li>Service Type: <code class="prettyprint">WaypointSetCurrent</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/waypoint_set_current</code></li>
<li>JSON Request:
<code class="prettyprint">{
wp_seq: Int
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean,
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/waypoint_set_current</code></li>
<li>serviceType: <code class="prettyprint">core_api/WaypointSetCurrent</code></li>
</ul>

          <h2 id="set-home">Set Home</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/set_home
ROS-Service Type: core_api/SetHome, below is its description

<span class="c">#Request : Expects home position to be set by specifying Latitude, Longitude and altitude</span>
<span class="c">#Request: If set_current is true, the current location of craft is set as home position</span>
float64 lat
float64 lon
float64 alt
bool set_current

<span class="c">#Response : success=true if service called successfully </span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">No</span> <span class="n">CPP</span> <span class="n">API</span> <span class="n">available</span><span class="p">.</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">set_home</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">alt</span><span class="p">,</span> <span class="n">set_current</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">set_home</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="n">float64</span> <span class="n">lat</span>
    <span class="o">:</span><span class="n">float64</span> <span class="n">lon</span>
    <span class="o">:</span><span class="n">float64</span> <span class="n">alt</span>
    <span class="o">:</span><span class="kt">bool</span> <span class="n">set_current</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">set_home</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="n">float64</span> <span class="n">lat</span>
    <span class="p">:</span><span class="n">float64</span> <span class="n">lon</span>
    <span class="p">:</span><span class="n">float64</span> <span class="n">alt</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">set_current</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/set_home'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">lat</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">lon</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">alt</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">set_current</span> <span class="p">:</span> <span class="nb">Boolean</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/set_home'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/SetHome'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">lat</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">lon</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">alt</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">set_current</span> <span class="p">:</span> <span class="nb">Boolean</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytsim/navigation/set_home <span class="s2">"{lat: 73.25564541, lon: 18.2165632, alt: 2.0, set_current: false}"</span>  
</code></pre><pre class="highlight cpp tab-cpp"><code></code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#set given location as home </span>
<span class="n">drone</span><span class="o">.</span><span class="n">set_home</span><span class="p">(</span><span class="mf">10.2</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">)</span>

<span class="c">#set current location as home</span>
<span class="n">drone</span><span class="o">.</span><span class="n">set_home</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/SetHome.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">SetHome</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/set_home"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">SetHome</span> <span class="n">srv</span><span class="p">;</span>

<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">lat</span> <span class="o">=</span> <span class="mf">73.25564541</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">lon</span> <span class="o">=</span> <span class="mf">18.2165632</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">alt</span> <span class="o">=</span> <span class="mf">2.00</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">set_current</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"lat"</span><span class="p">]</span><span class="o">=</span><span class="mf">73.25564541</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"lon"</span><span class="p">]</span><span class="o">=</span><span class="mf">18.36155</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"alt"</span><span class="p">]</span><span class="o">=</span><span class="mf">2.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"set_current"</span><span class="p">]</span><span class="o">=</span><span class="kc">true</span><span class="p">;</span>


<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/set_home"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">setHome</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/set_home'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/SetHome'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">lat</span><span class="p">:</span> <span class="mf">73.12516255</span><span class="p">,</span>
    <span class="na">lon</span><span class="p">:</span> <span class="mf">18.2165632</span><span class="p">,</span>
    <span class="na">alt</span><span class="p">:</span> <span class="mf">2.00</span><span class="p">,</span>
    <span class="na">set_current</span> <span class="p">:</span> <span class="nx">True</span> 
<span class="p">});</span>

<span class="nx">setHome</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">setHome</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code></code></pre><pre class="highlight python tab-python"><code><span class="p">{</span><span class="s">'message'</span><span class="p">:</span> <span class="s">'[INFO] Home Position successfully sent to vehicle'</span><span class="p">,</span> <span class="s">'success'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">message</span> <span class="p">(</span><span class="n">string</span><span class="p">):</span> <span class="n">Contains</span> <span class="n">error</span> <span class="n">message</span>
<span class="n">success</span> <span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>Manually store a location as new home.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard C++ and Python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>lat,long,alt</td>
<td>float</td>
<td>Latitude, longitude and relative altitude</td>
</tr>
<tr>
<td>set_current</td>
<td>boolean</td>
<td>if true uses current location and altitude of the device else uses the provided values.</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/set_home</code></li>
<li>Service Type: <code class="prettyprint">SetHome</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/set_home</code></li>
<li>JSON Request:
<code class="prettyprint">{
lat: Float,
lon: Float,
alt: Float,
set_current : Boolean 
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean,
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/set_home</code></li>
<li>serviceType: <code class="prettyprint">core_api/SetHome</code></li>
</ul>

          <h2 id="rtl">RTL</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/navigation/rtl
ROS-Service Type: core_api/RTL, below is its description

<span class="c">#Request : NULL</span>

<span class="c">#Response : returns success=true if RTL is activated</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// CPP API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from cpp.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span>    <span class="kt">int</span> <span class="n">Navigation</span><span class="o">::</span><span class="n">rtl</span><span class="p">()</span>

<span class="n">Arguments</span><span class="o">:</span> <span class="n">None</span>

<span class="n">Returns</span><span class="o">:</span>    <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">rtl</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successfully</span> <span class="n">sent</span> <span class="n">to</span> <span class="n">the</span> <span class="n">vehicle</span><span class="p">,</span> <span class="k">else</span> <span class="n">returns</span> <span class="mf">1.</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">rtl</span><span class="p">()</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">navigation</span><span class="o">/</span><span class="n">rtl</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">NULL</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">transition</span> <span class="nx">the</span> <span class="nx">vehicle</span> <span class="nx">to</span> <span class="nx">RTL</span> <span class="nx">mode</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/rtl'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span> <span class="nx">to</span> <span class="nx">transition</span> <span class="nx">the</span> <span class="nx">vehicle</span> <span class="nx">to</span> <span class="nx">RTL</span> <span class="nx">mode</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/rtl'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/RTL'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>  <span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/navigation/rtl <span class="s2">"{}"</span> 
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">nav</span><span class="p">.</span><span class="n">rtl</span><span class="p">();</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#trigger RTL mode </span>
<span class="n">drone</span><span class="o">.</span><span class="n">rtl</span><span class="p">()</span> 
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/RTL.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">RTL</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/rtl"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">RTL</span> <span class="n">srv</span><span class="p">;</span>

<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">rtl</span><span class="p">():</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/rtl'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'/&lt;namespace&gt;/navigation/rtl'</span><span class="p">,</span> <span class="n">RTL</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/rtl"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">rtl</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/navigation/rtl'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/RTL'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">rtl</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">rtl</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="p">{</span><span class="s">'message'</span><span class="p">:</span> <span class="s">'[INFO] RTL Triggered by FlytAPI'</span><span class="p">,</span> <span class="s">'success'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">message</span> <span class="p">(</span><span class="n">string</span><span class="p">):</span> <span class="n">Contains</span> <span class="n">error</span> <span class="n">message</span>
<span class="n">success</span> <span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>Trigger RTL mode transition of the vehicle. Check API usage section below before using this API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments: None</p>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<p>This API will transition the vehicle to RTL mode.</p>

<ul>
<li>This API can be used only in GUIDED or OFFBOARD or API|POSCTL mode.</li>
<li>If any other navigation API is called when vehicle is in RTL mode, then RTL call be overridden by that API call.</li>
<li>Make sure to configure the following parameters, before triggering this mode.

<ul>
<li>RTL_RETURN_ALT : Altitude to fly back in RTL in meters.</li>
<li>RTL_DESCEND_ALT : RTL Loiter altitude. Vehicle stays at this altitude above home position and starts to land if autolanding is allowed.</li>
<li>RTL_LAND_DELAY : Delay after descend before landing in RTL mode. If set to -1 the system will not land but loiter at RTL_DESCEND_ALT. </li>
<li>RTL_MIN_DIST : If the system is horizontally closer than this distance to home it will land straight on home instead of raising to the return altitude first. </li>
</ul></li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Navigation APIs in FlytOS are derived from / wrapped around the core navigation services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/navigation/rtl</code></li>
<li>Service Type: <code class="prettyprint">core_api/RTL</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <em>80</em>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/navigation/rtl</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean,
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library</a>.</p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava</a>.</p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/navigation/rtl</code></li>
<li>serviceType: <code class="prettyprint">core_api/RTL</code></li>
</ul>

          <h1 id="telemetry-apis">Telemetry APIs</h1>

<h2 id="get-attitude-quaternion">Get Attitude Quaternion</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Topic Name: /&lt;namespace&gt;/mavros/imu/data
ROS-Topic Type: sensor_msgs/Imu, below is its description

<span class="c"># Subscriber response : Attitude Quaternion </span>
Response structure:
    std_msgs/Header header
      uint32 seq
      <span class="nb">time </span>stamp
      string frame_id
    geometry_msgs/Quaternion orientation
      float64 x
      float64 y
      float64 z
      float64 w
    float64[9] orientation_covariance
    geometry_msgs/Vector3 angular_velocity
      float64 x
      float64 y
      float64 z
    float64[9] angular_velocity_covariance
    geometry_msgs/Vector3 linear_acceleration
      float64 x
      float64 y
      float64 z
    float64[9] linear_acceleration_covariance

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// CPP API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from cpp.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">vehicle_attitude_quat</span><span class="p">,</span><span class="n">attitudeQuatCb</span><span class="p">);</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">vehicle_attitude_quat</span><span class="o">:</span> <span class="n">This</span> <span class="n">argument</span> <span class="n">selects</span> <span class="n">vehicle</span> <span class="n">attitude</span> <span class="n">quaternion</span> <span class="n">topic</span> <span class="n">to</span> <span class="n">be</span> <span class="n">subscribed</span>
    <span class="n">attitudeQuatCb</span><span class="o">:</span> <span class="n">Callback</span> <span class="n">function</span> <span class="k">for</span> <span class="n">the</span> <span class="n">subscribed</span> <span class="n">attitude</span> <span class="n">messages</span>

<span class="n">Returns</span><span class="o">:</span> <span class="n">Vehicle</span> <span class="n">attitude</span> <span class="n">in</span> <span class="n">quaternion</span> <span class="n">notation</span> <span class="n">in</span> <span class="n">ros</span> <span class="n">sensor_msgs</span><span class="o">::</span><span class="n">Imu</span> <span class="n">message</span> <span class="n">structure</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Quaternion</span> <span class="n">orientation</span>
      <span class="n">float64</span> <span class="n">x</span>
      <span class="n">float64</span> <span class="n">y</span>
      <span class="n">float64</span> <span class="n">z</span>
      <span class="n">float64</span> <span class="n">w</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">orientation_covariance</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">angular_velocity</span>
      <span class="n">float64</span> <span class="n">x</span>
      <span class="n">float64</span> <span class="n">y</span>
      <span class="n">float64</span> <span class="n">z</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">angular_velocity_covariance</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">linear_acceleration</span>
      <span class="n">float64</span> <span class="n">x</span>
      <span class="n">float64</span> <span class="n">y</span>
      <span class="n">float64</span> <span class="n">z</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">linear_acceleration_covariance</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">get_attitude_quaternion</span><span class="p">()</span>

<span class="n">Response</span><span class="p">:</span> <span class="n">attitude_quaternion</span> <span class="k">as</span> <span class="n">described</span> <span class="n">below</span><span class="o">.</span>
    <span class="k">class</span> <span class="nc">attitude_quaternion</span><span class="p">:</span>
        <span class="s">'''
        Holds fields for Attitude data in Quaternion format
        '''</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">z</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">w</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">rollspeed</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">pitchspeed</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">yawspeed</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">This</span> <span class="n">API</span> <span class="n">supports</span> <span class="n">single</span> <span class="n">poll</span> <span class="n">mode</span> <span class="n">only</span><span class="o">.</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">imu</span><span class="o">/</span><span class="n">data</span>
<span class="n">Response</span> <span class="n">Type</span><span class="o">:</span> <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">Imu</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Quaternion</span> <span class="n">orientation</span>
      <span class="n">float64</span> <span class="n">x</span>
      <span class="n">float64</span> <span class="n">y</span>
      <span class="n">float64</span> <span class="n">z</span>
      <span class="n">float64</span> <span class="n">w</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">orientation_covariance</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">angular_velocity</span>
      <span class="n">float64</span> <span class="n">x</span>
      <span class="n">float64</span> <span class="n">y</span>
      <span class="n">float64</span> <span class="n">z</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">angular_velocity_covariance</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">linear_acceleration</span>
      <span class="n">float64</span> <span class="n">x</span>
      <span class="n">float64</span> <span class="n">y</span>
      <span class="n">float64</span> <span class="n">z</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">linear_acceleration_covariance</span>

</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">imu</span><span class="o">/</span><span class="n">data</span>
<span class="n">Response</span> <span class="n">Type</span><span class="p">:</span> <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">Imu</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Quaternion</span> <span class="n">orientation</span>
      <span class="n">float64</span> <span class="n">x</span>
      <span class="n">float64</span> <span class="n">y</span>
      <span class="n">float64</span> <span class="n">z</span>
      <span class="n">float64</span> <span class="n">w</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">orientation_covariance</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">angular_velocity</span>
      <span class="n">float64</span> <span class="n">x</span>
      <span class="n">float64</span> <span class="n">y</span>
      <span class="n">float64</span> <span class="n">z</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">angular_velocity_covariance</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">linear_acceleration</span>
      <span class="n">float64</span> <span class="n">x</span>
      <span class="n">float64</span> <span class="n">y</span>
      <span class="n">float64</span> <span class="n">z</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">linear_acceleration_covariance</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/imu/data'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">orientation</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">w</span><span class="p">:</span> <span class="nx">Float</span>
    <span class="p">},</span>
    <span class="nx">angular_velocity</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span>
    <span class="p">},</span>
    <span class="nx">linear_acceleration</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/imu/data'</span><span class="p">,</span>
<span class="nx">messageType</span><span class="p">:</span> <span class="s1">'sensor_msgs/Imu'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">orientation</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">w</span><span class="p">:</span> <span class="nx">Float</span>
    <span class="p">},</span>
    <span class="nx">angular_velocity</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span>
    <span class="p">},</span>
    <span class="nx">linear_acceleration</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rostopic <span class="nb">echo</span> /flytos/mavros/imu/data
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">sensor_msgs</span><span class="o">::</span><span class="n">Imu</span> <span class="n">att_quat</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">attitudeQuatCb</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">_att_quat</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">att_quat</span> <span class="o">=</span> <span class="o">*</span> <span class="p">(</span><span class="n">sensor_msgs</span><span class="o">::</span><span class="n">Imu</span><span class="o">*</span><span class="p">)(</span><span class="n">_att_quat</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">nav</span><span class="p">.</span><span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">vehicle_attitude_quat</span><span class="p">,</span><span class="n">attitudeQuatCb</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">att_quat</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># Poll attitude euler data</span>
<span class="n">att</span> <span class="o">=</span> <span class="n">drone</span><span class="o">.</span><span class="n">get_attitude_quaternion</span><span class="p">()</span>
<span class="c"># Print the data</span>
<span class="k">print</span> <span class="n">att</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">att</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">att</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">att</span><span class="o">.</span><span class="n">w</span><span class="p">,</span> <span class="n">att</span><span class="o">.</span><span class="n">rollspeed</span><span class="p">,</span> <span class="n">att</span><span class="o">.</span><span class="n">pitchspeed</span><span class="p">,</span> <span class="n">att</span><span class="o">.</span><span class="n">yawspeed</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;sensor_msgs/Imu.h&gt;
</span>

<span class="kt">void</span> <span class="nf">attCallback</span><span class="p">(</span><span class="k">const</span> <span class="n">sensor_msgs</span><span class="o">::</span><span class="n">ImuConstPtr</span> <span class="o">&amp;</span><span class="n">att</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">att_data</span><span class="p">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">att</span><span class="o">-&gt;</span><span class="n">orientation</span><span class="p">;</span>
  <span class="n">att_data</span><span class="p">.</span><span class="n">angular_velocity</span> <span class="o">=</span> <span class="n">att</span><span class="o">-&gt;</span><span class="n">angular_velocity</span><span class="p">;</span>
  <span class="n">att_data</span><span class="p">.</span><span class="n">linear_acceleration</span> <span class="o">=</span> <span class="n">att</span><span class="o">-&gt;</span><span class="n">linear_acceleration</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">sensor_msgs</span><span class="o">::</span><span class="n">Imu</span> <span class="n">att_data</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">Subscriber</span> <span class="n">sub</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/imu/data"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">attCallback</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">sensor_msgs.msg</span> <span class="kn">import</span> <span class="n">Imu</span>

<span class="c"># setup a subscriber and associate a callback function which will be called every time topic is updated.</span>
<span class="n">topic_sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/imu/data"</span><span class="p">),</span> <span class="n">Imu</span><span class="p">,</span> <span class="n">topic_callback</span><span class="p">)</span>

<span class="c"># define the callback function which will print the values every time topic is updated</span>
<span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">orientation</span><span class="o">.</span><span class="n">w</span>
    <span class="k">print</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">w</span>

<span class="c"># unsubscribe from a topic</span>
<span class="n">topic_sub</span><span class="o">.</span><span class="n">unregister</span><span class="p">()</span>  <span class="c"># unregister topic subscription</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/imu/data"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">imuData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Topic</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/imu/data'</span><span class="p">,</span>
    <span class="na">messageType</span> <span class="p">:</span> <span class="s1">'sensor_msgs/Imu'</span><span class="p">,</span>
    <span class="na">throttle_rate</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">});</span>


<span class="nx">imuData</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span> <span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>header: 
  seq: 112
  stamp: 
    secs: 1489476690
    nsecs: 278339713
  frame_id: fcu
orientation: 
  x: -0.00593215392702
  y: 0.00396701722143
  z: 0.988477372188
  w: 0.151200386894
orientation_covariance: <span class="o">[</span>1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0]
angular_velocity: 
  x: 0.00392133416608
  y: -0.000496329041198
  z: -0.000130902582896
angular_velocity_covariance: <span class="o">[</span>1.2184696791468346e-07, 0.0, 0.0, 0.0, 1.2184696791468346e-07, 0.0, 0.0, 0.0, 1.2184696791468346e-07]
linear_acceleration: 
  x: -0.1176798
  y: -0.4314926
  z: -9.81645665
linear_acceleration_covariance: <span class="o">[</span>8.999999999999999e-08, 0.0, 0.0, 0.0, 8.999999999999999e-08, 0.0, 0.0, 0.0, 8.999999999999999e-08]
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">sensor_msgs</span><span class="o">::</span><span class="n">Imu</span> <span class="k">class</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">instance</span> <span class="n">of</span> <span class="k">class</span> <span class="nc">attitude_quaternion</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">sensor_msgs</span><span class="o">::</span><span class="n">Imu</span> <span class="k">class</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">sensor_msgs</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">Imu</span> <span class="k">class</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">orientation</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">w</span><span class="p">:</span> <span class="nx">Float</span><span class="p">},</span>
    <span class="nx">angular_velocity</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">},</span>
    <span class="nx">linear_acceleration</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">}</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">orientation</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">w</span><span class="p">:</span> <span class="nx">Float</span><span class="p">},</span>
    <span class="nx">angular_velocity</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">},</span>
    <span class="nx">linear_acceleration</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">}</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API subscribes/polls attitude data (angle and angular rate) in quaternion.  Please check API usage section below before using API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Response:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>x</td>
<td>float</td>
<td>x vector.</td>
</tr>
<tr>
<td>y</td>
<td>float</td>
<td>y vector.</td>
</tr>
<tr>
<td>z</td>
<td>float</td>
<td>z vector.</td>
</tr>
<tr>
<td>w</td>
<td>float</td>
<td>w vector.</td>
</tr>
<tr>
<td>rollspeed</td>
<td>float</td>
<td>roll rate in radians/sec, NED frame.</td>
</tr>
<tr>
<td>pitchspeed</td>
<td>float</td>
<td>pitch rate in radians/sec, NED frame.</td>
</tr>
<tr>
<td>yawspeed</td>
<td>float</td>
<td>yaw rate in radians/sec, NED frame.</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>This API provides orientation in quaternion and angular velocity</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>All the autopilot state / payload data in FlytOS is shared by ROS topics. Onboard topic subscribers in rospy / roscpp can subscribe to these topics. Take a look at roscpp and rospy API definition for response message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Topic</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/mavros/imu/data</code></li>
<li>Response Type: <code class="prettyprint">sensor_msgs/Imu</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice. All RESTful APIs can poll the data. For telemetry mode (continuous data stream) use websocket APIs.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/imu/data</code></li>
<li>JSON Response:
<code class="prettyprint">{
orientation:{
    x: Float,
    y: Float,
    z: Float,
    w: Float},
angular_velocity:{
    x: Float,
    y: Float,
    z: Float},
linear_acceleration:{
    x: Float,
    y: Float,
    z: Float}
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/mavros/imu/data</code></li>
<li>messageType: <code class="prettyprint">sensor_msgs/Imu</code></li>
</ul>

          <h2 id="get-attitude-euler-data">Get Attitude Euler Data</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Topic Name: /&lt;namespace&gt;/mavros/imu/data_euler
ROS-Topic Type: geometry_msgs/TwistStamped, below is its description

<span class="c">#Subscriber response : Euler angles </span>
Response structure:
    std_msgs/Header header
      uint32 seq
      <span class="nb">time </span>stamp
      string frame_id
    geometry_msgs/Twist twist
      geometry_msgs/Vector3 linear
        float64 x
        float64 y
        float64 z
      geometry_msgs/Vector3 angular
        float64 x
        float64 y
        float64 z

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// CPP API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from cpp.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">vehicle_attitude_euler</span><span class="p">,</span><span class="n">attitudeEulerCb</span><span class="p">);</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">vehicle_attitude_euler</span><span class="o">:</span> <span class="n">This</span> <span class="n">argument</span> <span class="n">selects</span> <span class="n">vehicle</span> <span class="n">attitude</span> <span class="n">euler</span> <span class="n">topic</span> <span class="n">to</span> <span class="n">be</span> <span class="n">subscribed</span>
    <span class="n">attitudeEulerCb</span><span class="o">:</span> <span class="n">Callback</span> <span class="n">function</span> <span class="k">for</span> <span class="n">the</span> <span class="n">subscribed</span> <span class="n">attitude</span> <span class="n">messages</span>

<span class="n">Returns</span><span class="o">:</span> <span class="n">Vehicle</span> <span class="n">attitude</span> <span class="n">in</span> <span class="n">euler</span> <span class="n">notation</span> <span class="n">in</span> <span class="n">ros</span> <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStamped</span> <span class="n">message</span> <span class="n">structure</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Twist</span> <span class="n">twist</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">linear</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">angular</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">get_attitude_euler</span><span class="p">()</span>

<span class="n">Response</span><span class="p">:</span> <span class="n">attitude_euler_object</span> <span class="k">as</span> <span class="n">described</span> <span class="n">below</span><span class="o">.</span>
    <span class="k">class</span> <span class="nc">attitude_euler</span><span class="p">:</span>
        <span class="s">'''
        Holds fields for Attitude data in Euler Angles
        '''</span>
        <span class="n">roll</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">pitch</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">yaw</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">rollspeed</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">pitchspeed</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">yawspeed</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">This</span> <span class="n">API</span> <span class="n">support</span> <span class="n">single</span> <span class="n">poll</span> <span class="n">mode</span> <span class="n">only</span><span class="o">.</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">imu</span><span class="o">/</span><span class="n">data_euler</span>
<span class="n">Response</span> <span class="n">Type</span><span class="o">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Twist</span> <span class="n">twist</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">linear</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">angular</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>

</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">imu</span><span class="o">/</span><span class="n">data_euler</span>
<span class="n">Response</span> <span class="n">Type</span><span class="p">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Twist</span> <span class="n">twist</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">linear</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">angular</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/imu/data_euler'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">twist</span><span class="p">:{</span>
        <span class="nl">linear</span><span class="p">:{</span>
            <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
            <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
            <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span>
        <span class="p">},</span>
        <span class="nx">angular</span><span class="p">:{</span>
            <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
            <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
            <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/imu/data_euler'</span><span class="p">,</span>
<span class="nx">messageType</span><span class="p">:</span> <span class="s1">'geometry_msgs/TwistStamped'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">twist</span><span class="p">:{</span>
        <span class="nl">linear</span><span class="p">:{</span>
            <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
            <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
            <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span>
        <span class="p">},</span>
        <span class="nx">angular</span><span class="p">:{</span>
            <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
            <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
            <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rostopic <span class="nb">echo</span> /flytpods/mavros/imu/data_euler 
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStamped</span> <span class="n">att_euler</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">attitudeEulerCb</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">_att_euler</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">att_euler</span> <span class="o">=</span> <span class="o">*</span> <span class="p">(</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStamped</span><span class="o">*</span><span class="p">)(</span><span class="n">_att_euler</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\n</span><span class="s">roll </span><span class="se">\t\t</span><span class="s">pitch </span><span class="se">\t\t</span><span class="s">yaw </span><span class="se">\t\t</span><span class="s">rollspeed </span><span class="se">\t</span><span class="s">pitchspeed </span><span class="se">\t</span><span class="s">yawspeed"</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att_euler</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att_euler</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">y</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att_euler</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att_euler</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">angular</span><span class="p">.</span><span class="n">x</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att_euler</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">angular</span><span class="p">.</span><span class="n">y</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att_euler</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">angular</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
    <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
    <span class="n">nav</span><span class="p">.</span><span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">vehicle_attitude_euler</span><span class="p">,</span><span class="n">attitudeEulerCb</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="n">ros</span><span class="o">::</span><span class="n">ok</span><span class="p">()){</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mf">0.2</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># Poll attitude euler data</span>
<span class="n">att</span> <span class="o">=</span> <span class="n">drone</span><span class="o">.</span><span class="n">get_attitude_euler</span><span class="p">()</span>
<span class="c"># Print the data</span>
<span class="k">print</span> <span class="n">att</span><span class="o">.</span><span class="n">roll</span><span class="p">,</span> <span class="n">att</span><span class="o">.</span><span class="n">pitch</span><span class="p">,</span> <span class="n">att</span><span class="o">.</span><span class="n">yaw</span><span class="p">,</span> <span class="n">att</span><span class="o">.</span><span class="n">rollspeed</span><span class="p">,</span> <span class="n">att</span><span class="o">.</span><span class="n">pitchspeed</span><span class="p">,</span> <span class="n">att</span><span class="o">.</span><span class="n">yawspeed</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;geometry_msgs/TwistStamped.h&gt;
</span>
<span class="kt">void</span> <span class="nf">attCallback</span><span class="p">(</span><span class="k">const</span> <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStampedConstPtr</span> <span class="o">&amp;</span><span class="n">att</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\n</span><span class="s">roll </span><span class="se">\t\t</span><span class="s">pitch </span><span class="se">\t\t</span><span class="s">yaw </span><span class="se">\t\t</span><span class="s">rollspeed </span><span class="se">\t</span><span class="s">pitchspeed </span><span class="se">\t</span><span class="s">yawspeed"</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att</span><span class="o">-&gt;</span><span class="n">twist</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att</span><span class="o">-&gt;</span><span class="n">twist</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">y</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att</span><span class="o">-&gt;</span><span class="n">twist</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att</span><span class="o">-&gt;</span><span class="n">twist</span><span class="p">.</span><span class="n">angular</span><span class="p">.</span><span class="n">x</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att</span><span class="o">-&gt;</span><span class="n">twist</span><span class="p">.</span><span class="n">angular</span><span class="p">.</span><span class="n">y</span><span class="o">&lt;&lt;</span><span class="s">"</span><span class="se">\t</span><span class="s">"</span><span class="o">&lt;&lt;</span><span class="n">att</span><span class="o">-&gt;</span><span class="n">twist</span><span class="p">.</span><span class="n">angular</span><span class="p">.</span><span class="n">z</span><span class="p">;</span>
        <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">ros</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="s">"att_euler_cb"</span><span class="p">);</span>
        <span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
        <span class="n">ros</span><span class="o">::</span><span class="n">Subscriber</span> <span class="n">sub</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/imu/data_euler"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">attCallback</span><span class="p">);</span>
        <span class="n">ros</span><span class="o">::</span><span class="n">spin</span><span class="p">();</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">geometry_msgs.msg</span> <span class="kn">import</span> <span class="n">TwistStamped</span>

<span class="c"># setup a subscriber and associate a callback function which will be called every time topic is updated.</span>
<span class="n">topic_sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/imu/data_euler"</span><span class="p">),</span> <span class="n">TwistStamped</span><span class="p">,</span> <span class="n">topic_callback</span><span class="p">)</span>

<span class="c"># define the callback function which will print the values every time topic is updated</span>
<span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">roll</span><span class="p">,</span> <span class="n">pitch</span><span class="p">,</span> <span class="n">yaw</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">twist</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">twist</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">twist</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">z</span>
    <span class="k">print</span> <span class="n">roll</span><span class="p">,</span> <span class="n">pitch</span><span class="p">,</span> <span class="n">yaw</span>

<span class="c"># unsubscribe from a topic</span>
<span class="n">topic_sub</span><span class="o">.</span><span class="n">unregister</span><span class="p">()</span>  <span class="c"># unregister topic subscription</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/imu/data_euler"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">imuEulerData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Topic</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/imu/data_euler'</span><span class="p">,</span>
    <span class="na">messageType</span> <span class="p">:</span> <span class="s1">'geometry_msgs/TwistStamped'</span>
<span class="p">});</span>

<span class="nx">imuEulerData</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>

</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>header: 
  seq: 4090
  stamp: 
    secs: 1489483667
    nsecs: 763130240
  frame_id: fcu
twist: 
  linear: 
    x: -0.0357596799731
    y: -0.0206729210913
    z: -1.89611303806
  angular: 
    x: -0.00441705761477
    y: 0.00617094011977
    z: -0.000732765707653
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStamped</span> <span class="k">class</span>

<span class="nl">header:</span> 
  <span class="nl">seq:</span> <span class="err">2041</span>
  <span class="nl">stamp:</span> 
    <span class="nl">secs:</span> <span class="err">1492705227</span>
    <span class="nl">nsecs:</span> <span class="err">960368337</span>
  <span class="nl">frame_id:</span> <span class="nc">fcu</span>
<span class="n">twist</span><span class="o">:</span> 
  <span class="n">linear</span><span class="o">:</span> 
    <span class="n">x</span><span class="o">:</span> <span class="o">-</span><span class="mf">0.00561133073643</span>
    <span class="n">y</span><span class="o">:</span> <span class="o">-</span><span class="mf">0.00531742209569</span>
    <span class="n">z</span><span class="o">:</span> <span class="o">-</span><span class="mf">0.0351081602275</span>
  <span class="n">angular</span><span class="o">:</span> 
    <span class="n">x</span><span class="o">:</span> <span class="mf">0.00158157129772</span>
    <span class="n">y</span><span class="o">:</span> <span class="mf">0.001551638823</span>
    <span class="n">z</span><span class="o">:</span> <span class="mf">0.00154603447299</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">instance</span> <span class="n">of</span> <span class="k">class</span>
<span class="nc">class</span> <span class="n">attitude_euler</span><span class="p">:</span>
    <span class="s">'''
    Holds fields for Attitude data in Euler Angles
    '''</span>
    <span class="n">roll</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">pitch</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">yaw</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">rollspeed</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">pitchspeed</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">yawspeed</span> <span class="o">=</span> <span class="mf">0.0</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStamped</span> <span class="k">class</span>

<span class="nl">header:</span> 
  <span class="nl">seq:</span> <span class="err">2041</span>
  <span class="nl">stamp:</span> 
    <span class="nl">secs:</span> <span class="err">1492705227</span>
    <span class="nl">nsecs:</span> <span class="err">960368337</span>
  <span class="nl">frame_id:</span> <span class="nc">fcu</span>
<span class="n">twist</span><span class="o">:</span> 
  <span class="n">linear</span><span class="o">:</span> 
    <span class="n">x</span><span class="o">:</span> <span class="o">-</span><span class="mf">0.00561133073643</span>
    <span class="n">y</span><span class="o">:</span> <span class="o">-</span><span class="mf">0.00531742209569</span>
    <span class="n">z</span><span class="o">:</span> <span class="o">-</span><span class="mf">0.0351081602275</span>
  <span class="n">angular</span><span class="o">:</span> 
    <span class="n">x</span><span class="o">:</span> <span class="mf">0.00158157129772</span>
    <span class="n">y</span><span class="o">:</span> <span class="mf">0.001551638823</span>
    <span class="n">z</span><span class="o">:</span> <span class="mf">0.00154603447299</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">gemometry_msgs</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">TwistStamped</span> <span class="k">class</span>

<span class="nc">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Twist</span> <span class="n">twist</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">linear</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">angular</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">twist</span><span class="p">:{</span>
    <span class="nl">linear</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">},</span>
    <span class="nx">angular</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">twist</span><span class="p">:{</span>
    <span class="nl">linear</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">},</span>
    <span class="nx">angular</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API subscribes/polls attitude data (angle and angular rate) in euler angles.  Please check API usage section below before using API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Response:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>roll</td>
<td>float</td>
<td>roll angle in radians, NED frame.</td>
</tr>
<tr>
<td>pitch</td>
<td>float</td>
<td>pitch angle in radians, NED frame.</td>
</tr>
<tr>
<td>yaw</td>
<td>float</td>
<td>yaw angle in radians, NED frame.</td>
</tr>
<tr>
<td>rollspeed</td>
<td>float</td>
<td>roll rate in radians/sec, NED frame.</td>
</tr>
<tr>
<td>pitchspeed</td>
<td>float</td>
<td>pitch rate in radians/sec, NED frame.</td>
</tr>
<tr>
<td>yawspeed</td>
<td>float</td>
<td>yaw rate in radians/sec, NED frame.</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>This API provides roll, pitch, yaw, rollspeed, pitchspeed, yawspeed information.</li>
<li>Data returned is in NED frame.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>All the autopilot state / payload data in FlytOS is shared by ROS topics. Onboard topic subscribers in rospy / roscpp can subscribe to these topics. Take a look at roscpp and rospy API definition for response message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Topic</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/mavros/imu/data_euler</code></li>
<li>Response Type: <code class="prettyprint">geometry_msgs/TwistStamped</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice. All RESTful APIs can poll the data. For telemetry mode (continuous data stream) use websocket APIs.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/imu/data_euler</code></li>
<li>JSON Response:
<code class="prettyprint">{
twist:{
  linear:{
      x: Float,
      y: Float,
      z: Float
  },
  angular:{
      x: Float,
      y: Float,
      z: Float
  }
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/mavros/imu/data_euler</code></li>
<li>messageType: <code class="prettyprint">geometry_msgs/TwistStamped</code></li>
</ul>

          <h2 id="get-local-position">Get Local Position</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Topic Name: /&lt;namespace&gt;/mavros/imu/local_position/local
ROS-Topic Type: geometry_msgs/TwistStamped, below is its description

<span class="c">#Subscriber response : Euler angles </span>
Response structure:
    std_msgs/Header header
      uint32 seq
      <span class="nb">time </span>stamp
      string frame_id
    geometry_msgs/Twist twist
      geometry_msgs/Vector3 linear
        float64 x
        float64 y
        float64 z
      geometry_msgs/Vector3 angular
        float64 x
        float64 y
        float64 z

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// CPP API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from cpp.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">local_position</span><span class="p">,</span><span class="n">lposCb</span><span class="p">);</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">local_position</span><span class="o">:</span> <span class="n">This</span> <span class="n">argument</span> <span class="n">selects</span> <span class="n">local</span> <span class="n">position</span> <span class="n">topic</span> <span class="n">to</span> <span class="n">be</span> <span class="n">subscribed</span>
    <span class="n">lposCb</span><span class="o">:</span> <span class="n">Callback</span> <span class="n">function</span> <span class="k">for</span> <span class="n">the</span> <span class="n">subscribed</span> <span class="n">local</span> <span class="n">position</span> <span class="n">messages</span>

<span class="n">Returns</span><span class="o">:</span> <span class="n">local</span> <span class="n">position</span> <span class="n">in</span> <span class="n">ros</span> <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStamped</span> <span class="n">message</span> <span class="n">structure</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Twist</span> <span class="n">twist</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">linear</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">angular</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">get_local_position</span><span class="p">()</span>

<span class="n">Response</span><span class="p">:</span> <span class="n">local_position</span> <span class="k">as</span> <span class="n">described</span> <span class="n">below</span><span class="o">.</span>
    <span class="k">class</span> <span class="nc">local_position</span><span class="p">:</span>
        <span class="s">'''
        Holds fields for local position
        '''</span>
        <span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">y</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">z</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">vx</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">vy</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">vz</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">This</span> <span class="n">API</span> <span class="n">support</span> <span class="n">single</span> <span class="n">poll</span> <span class="n">mode</span> <span class="n">only</span><span class="o">.</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">local_position</span><span class="o">/</span><span class="n">local</span>
<span class="n">Response</span> <span class="n">Type</span><span class="o">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Twist</span> <span class="n">twist</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">linear</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">angular</span>
        <span class="n">float64</span> <span class="n">x</span>
        <span class="n">float64</span> <span class="n">y</span>
        <span class="n">float64</span> <span class="n">z</span>

</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">local_position</span><span class="o">/</span><span class="n">local</span>
<span class="n">Response</span> <span class="n">Type</span><span class="p">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Twist</span> <span class="n">twist</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">linear</span>
        <span class="n">float64</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span> <span class="n">position</span>
        <span class="n">float64</span> <span class="n">y</span> <span class="p">:</span> <span class="n">y</span> <span class="n">position</span>
        <span class="n">float64</span> <span class="n">z</span> <span class="p">:</span> <span class="n">z</span> <span class="n">position</span>
      <span class="n">geometry_msgs</span><span class="o">/</span><span class="n">Vector3</span> <span class="n">angular</span>
        <span class="n">float64</span> <span class="n">x</span> <span class="p">:</span> <span class="n">linear</span> <span class="n">acceleration</span> <span class="n">along</span> <span class="n">x</span> <span class="n">axis</span>
        <span class="n">float64</span> <span class="n">y</span> <span class="p">:</span> <span class="n">linear</span> <span class="n">acceleration</span> <span class="n">along</span> <span class="n">y</span> <span class="n">axis</span>
        <span class="n">float64</span> <span class="n">z</span> <span class="p">:</span> <span class="n">linear</span> <span class="n">acceleration</span> <span class="n">along</span> <span class="n">z</span> <span class="n">axis</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/local_position/local'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">twist</span><span class="p">:{</span>
    <span class="nl">linear</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">},</span>
    <span class="nx">angular</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">}</span>
<span class="p">}}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/local_position/local'</span><span class="p">,</span>
<span class="nx">messageType</span><span class="p">:</span> <span class="s1">'geometry_msgs/TwistStamped'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">twist</span><span class="p">:{</span>
    <span class="nl">linear</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">},</span>
    <span class="nx">angular</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">}</span>
<span class="p">}}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rostopic <span class="nb">echo</span> /flytos/mavros/local_position/local
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStamped</span> <span class="n">lpos</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">lposCb</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">_lpos</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">lpos</span> <span class="o">=</span> <span class="o">*</span> <span class="p">(</span><span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStamped</span><span class="o">*</span><span class="p">)(</span><span class="n">_lpos</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">nav</span><span class="p">.</span><span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">local_position</span><span class="p">,</span><span class="n">lposCb</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">lpos</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># Poll data</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">drone</span><span class="o">.</span><span class="n">get_local_position</span><span class="p">()</span>
<span class="c"># Print the data</span>
<span class="k">print</span> <span class="n">pos</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="o">.</span><span class="n">vx</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;geometry_msgs/TwistStamped&gt;
</span>
<span class="kt">void</span> <span class="nf">lposCallback</span><span class="p">(</span><span class="k">const</span> <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStampedConstPtr</span> <span class="o">&amp;</span><span class="n">lpos</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">lpos_data</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">lpos</span><span class="o">-&gt;</span><span class="n">twist</span><span class="p">.</span><span class="n">linear</span><span class="p">;</span>
  <span class="n">lpos_data</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">angular</span> <span class="o">=</span> <span class="n">lpos</span><span class="o">-&gt;</span><span class="n">twist</span><span class="p">.</span><span class="n">angular</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStamped</span> <span class="n">lpos_data</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">Subscriber</span> <span class="n">sub</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/local_position/local"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lposCallback</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">geometry_msgs.msg</span> <span class="kn">import</span> <span class="n">TwistStamped</span>

<span class="c"># setup a subscriber and associate a callback function which will be called every time topic is updated.</span>
<span class="n">topic_sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/local_position/local"</span><span class="p">),</span> <span class="n">TwistStamped</span><span class="p">,</span> <span class="n">topic_callback</span><span class="p">)</span>

<span class="c"># define the callback function which will print the values every time topic is updated</span>
<span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">twist</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">twist</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">twist</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">z</span>
    <span class="k">print</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span>

<span class="c"># unsubscribe from a topic</span>
<span class="n">topic_sub</span><span class="o">.</span><span class="n">unregister</span><span class="p">()</span>  <span class="c"># unregister topic subscription</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/local_position/local"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">lpos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Topic</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/local_position/local'</span><span class="p">,</span>
    <span class="na">messageType</span> <span class="p">:</span> <span class="s1">'geometry_msgs/TwistStamped'</span><span class="p">,</span>
    <span class="na">throttle_rate</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">});</span>

<span class="nx">lpos</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">twist</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>header: 
  seq: 2589
  stamp: 
    secs: 1489483590
    nsecs: 137668160
  frame_id: fcu
twist: 
  linear: 
    x: 0.0
    y: 0.0
    z: 2.52842187881
  angular: 
    x: 0.000367590633687
    y: 0.001967407763
    z: 0.0995724499226
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStamped</span> <span class="k">class</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">instance</span> <span class="n">of</span> <span class="k">class</span> <span class="nc">local_position</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">geometry_msgs</span><span class="o">::</span><span class="n">TwistStamped</span> <span class="k">class</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">gemometry_msgs</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">TwistStamped</span> <span class="k">class</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">twist</span><span class="p">:{</span>
    <span class="nl">linear</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">},</span>
    <span class="nx">angular</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">}</span>
<span class="p">}}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">twist</span><span class="p">:{</span>
    <span class="nl">linear</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">},</span>
    <span class="nx">angular</span><span class="p">:{</span>
        <span class="nl">x</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">y</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
        <span class="nx">z</span><span class="p">:</span> <span class="nx">Float</span><span class="p">}</span>
<span class="p">}}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API subscribes/polls linear position, velocity data in NED frame.  Check API usage section below before using API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Response:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>x</td>
<td>float</td>
<td>x position in local NED frame.</td>
</tr>
<tr>
<td>y</td>
<td>float</td>
<td>y position in local NED frame.</td>
</tr>
<tr>
<td>z</td>
<td>float</td>
<td>z position in local NED frame.</td>
</tr>
<tr>
<td>vx</td>
<td>float</td>
<td>x velocity in local NED frame.</td>
</tr>
<tr>
<td>vy</td>
<td>float</td>
<td>y velocity in local NED frame.</td>
</tr>
<tr>
<td>vz</td>
<td>float</td>
<td>z velocity in local NED frame.</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>This API provides linear position and linear velocity.</li>
<li>Data returned is in NED frame.</li>
<li>Be careful when using z data obtained into takeoff or position setpoint APIs. These API&rsquo;s may expect z values relative to ground. But the current local position that you get has negative z values for position above ground.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>All the autopilot state / payload data in FlytOS is shared by ROS topics. Onboard topic subscribers in rospy / roscpp can subscribe to these topics. Take a look at roscpp and rospy API definition for response message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Topic</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/mavros/local_position/local</code></li>
<li>Response Type: <code class="prettyprint">geometry_msgs/TwistStamped</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice. All RESTful APIs can poll the data. For telemetry mode (continuous data stream) use websocket APIs.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/local_position/local</code></li>
<li>JSON Response:
<code class="prettyprint">{
twist:{
    linear:{
        x: Float,
        y: Float,
        z: Float
    },
    angular:{
        x: Float,
        y: Float,
        z: Float
    }
}
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/mavros/local_position/local</code></li>
<li>messageType: <code class="prettyprint">geometry_msgs/TwistStamped</code></li>
</ul>

          <h2 id="get-global-position">Get Global Position</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Topic Name: /&lt;namespace&gt;/mavros/global_position/global
ROS-Topic Type: sensor_msgs/NavSatFix, below is its description

<span class="c">#Subscriber response : GPS pos </span>
Response structure:
    uint8 <span class="nv">COVARIANCE_TYPE_UNKNOWN</span><span class="o">=</span>0
    uint8 <span class="nv">COVARIANCE_TYPE_APPROXIMATED</span><span class="o">=</span>1
    uint8 <span class="nv">COVARIANCE_TYPE_DIAGONAL_KNOWN</span><span class="o">=</span>2
    uint8 <span class="nv">COVARIANCE_TYPE_KNOWN</span><span class="o">=</span>3
    std_msgs/Header header
      uint32 seq
      <span class="nb">time </span>stamp
      string frame_id
    sensor_msgs/NavSatStatus status
      int8 <span class="nv">STATUS_NO_FIX</span><span class="o">=</span>-1
      int8 <span class="nv">STATUS_FIX</span><span class="o">=</span>0
      int8 <span class="nv">STATUS_SBAS_FIX</span><span class="o">=</span>1
      int8 <span class="nv">STATUS_GBAS_FIX</span><span class="o">=</span>2
      uint16 <span class="nv">SERVICE_GPS</span><span class="o">=</span>1
      uint16 <span class="nv">SERVICE_GLONASS</span><span class="o">=</span>2
      uint16 <span class="nv">SERVICE_COMPASS</span><span class="o">=</span>4
      uint16 <span class="nv">SERVICE_GALILEO</span><span class="o">=</span>8
      int8 status
      uint16 service
    float64 latitude : latitude
    float64 longitude : longitude
    float64 altitude : altitude MSL
    float64[9] position_covariance
    uint8 position_covariance_type
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// CPP API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from cpp.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">global_position</span><span class="p">,</span><span class="n">gposCb</span><span class="p">);</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">global_position</span><span class="o">:</span> <span class="n">This</span> <span class="n">argument</span> <span class="n">selects</span> <span class="n">global</span> <span class="n">position</span> <span class="n">topic</span> <span class="n">to</span> <span class="n">be</span> <span class="n">subscribed</span>
    <span class="n">gposCb</span><span class="o">:</span> <span class="n">Callback</span> <span class="n">function</span> <span class="k">for</span> <span class="n">the</span> <span class="n">subscribed</span> <span class="n">global</span> <span class="n">position</span> <span class="n">messages</span>

<span class="n">Returns</span><span class="o">:</span> <span class="n">global</span> <span class="n">position</span> <span class="n">in</span> <span class="n">ros</span> <span class="n">sensor_msgs</span><span class="o">::</span><span class="n">NavSatFix</span> <span class="n">message</span> <span class="n">structure</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_UNKNOWN</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_APPROXIMATED</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_DIAGONAL_KNOWN</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_KNOWN</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">NavSatStatus</span> <span class="n">status</span>
      <span class="n">int8</span> <span class="n">STATUS_NO_FIX</span><span class="o">=-</span><span class="mi">1</span>
      <span class="n">int8</span> <span class="n">STATUS_FIX</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">int8</span> <span class="n">STATUS_SBAS_FIX</span><span class="o">=</span><span class="mi">1</span>
      <span class="n">int8</span> <span class="n">STATUS_GBAS_FIX</span><span class="o">=</span><span class="mi">2</span>
      <span class="n">uint16</span> <span class="n">SERVICE_GPS</span><span class="o">=</span><span class="mi">1</span>
      <span class="n">uint16</span> <span class="n">SERVICE_GLONASS</span><span class="o">=</span><span class="mi">2</span>
      <span class="n">uint16</span> <span class="n">SERVICE_COMPASS</span><span class="o">=</span><span class="mi">4</span>
      <span class="n">uint16</span> <span class="n">SERVICE_GALILEO</span><span class="o">=</span><span class="mi">8</span>
      <span class="n">int8</span> <span class="n">status</span>
      <span class="n">uint16</span> <span class="n">service</span>
    <span class="n">float64</span> <span class="n">latitude</span> <span class="o">:</span> <span class="n">latitude</span>
    <span class="n">float64</span> <span class="n">longitude</span> <span class="o">:</span> <span class="n">longitude</span>
    <span class="n">float64</span> <span class="n">altitude</span> <span class="o">:</span> <span class="n">altitude</span> <span class="n">MSL</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">position_covariance</span>
    <span class="n">uint8</span> <span class="n">position_covariance_type</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">get_global_position</span><span class="p">()</span>

<span class="n">Response</span><span class="p">:</span> <span class="n">glob_position</span> <span class="k">as</span> <span class="n">described</span> <span class="n">below</span><span class="o">.</span>
    <span class="k">class</span> <span class="nc">glob_position</span><span class="p">:</span>
        <span class="s">'''
        Holds fields for global position
        '''</span>
        <span class="n">lat</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">lon</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">alt</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">This</span> <span class="n">API</span> <span class="n">supports</span> <span class="n">single</span> <span class="n">poll</span> <span class="n">mode</span> <span class="n">only</span><span class="o">.</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">global_position</span><span class="o">/</span><span class="n">global</span>
<span class="n">Response</span> <span class="n">Type</span><span class="o">:</span> <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">NavSatFix</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_UNKNOWN</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_APPROXIMATED</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_DIAGONAL_KNOWN</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_KNOWN</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">NavSatStatus</span> <span class="n">status</span>
      <span class="n">int8</span> <span class="n">STATUS_NO_FIX</span><span class="o">=-</span><span class="mi">1</span>
      <span class="n">int8</span> <span class="n">STATUS_FIX</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">int8</span> <span class="n">STATUS_SBAS_FIX</span><span class="o">=</span><span class="mi">1</span>
      <span class="n">int8</span> <span class="n">STATUS_GBAS_FIX</span><span class="o">=</span><span class="mi">2</span>
      <span class="n">uint16</span> <span class="n">SERVICE_GPS</span><span class="o">=</span><span class="mi">1</span>
      <span class="n">uint16</span> <span class="n">SERVICE_GLONASS</span><span class="o">=</span><span class="mi">2</span>
      <span class="n">uint16</span> <span class="n">SERVICE_COMPASS</span><span class="o">=</span><span class="mi">4</span>
      <span class="n">uint16</span> <span class="n">SERVICE_GALILEO</span><span class="o">=</span><span class="mi">8</span>
      <span class="n">int8</span> <span class="n">status</span>
      <span class="n">uint16</span> <span class="n">service</span>
    <span class="n">float64</span> <span class="n">latitude</span> <span class="o">:</span> <span class="n">latitude</span>
    <span class="n">float64</span> <span class="n">longitude</span> <span class="o">:</span> <span class="n">longitude</span>
    <span class="n">float64</span> <span class="n">altitude</span> <span class="o">:</span> <span class="n">altitude</span> <span class="n">MSL</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">position_covariance</span>
    <span class="n">uint8</span> <span class="n">position_covariance_type</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">global_position</span><span class="o">/</span><span class="k">global</span>
<span class="n">Response</span> <span class="n">Type</span><span class="p">:</span> <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">NavSatFix</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_UNKNOWN</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_APPROXIMATED</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_DIAGONAL_KNOWN</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">uint8</span> <span class="n">COVARIANCE_TYPE_KNOWN</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">NavSatStatus</span> <span class="n">status</span>
      <span class="n">int8</span> <span class="n">STATUS_NO_FIX</span><span class="o">=-</span><span class="mi">1</span>
      <span class="n">int8</span> <span class="n">STATUS_FIX</span><span class="o">=</span><span class="mi">0</span>
      <span class="n">int8</span> <span class="n">STATUS_SBAS_FIX</span><span class="o">=</span><span class="mi">1</span>
      <span class="n">int8</span> <span class="n">STATUS_GBAS_FIX</span><span class="o">=</span><span class="mi">2</span>
      <span class="n">uint16</span> <span class="n">SERVICE_GPS</span><span class="o">=</span><span class="mi">1</span>
      <span class="n">uint16</span> <span class="n">SERVICE_GLONASS</span><span class="o">=</span><span class="mi">2</span>
      <span class="n">uint16</span> <span class="n">SERVICE_COMPASS</span><span class="o">=</span><span class="mi">4</span>
      <span class="n">uint16</span> <span class="n">SERVICE_GALILEO</span><span class="o">=</span><span class="mi">8</span>
      <span class="n">int8</span> <span class="n">status</span>
      <span class="n">uint16</span> <span class="n">service</span>
    <span class="n">float64</span> <span class="n">latitude</span> <span class="p">:</span> <span class="n">latitude</span>
    <span class="n">float64</span> <span class="n">longitude</span> <span class="p">:</span> <span class="n">longitude</span>
    <span class="n">float64</span> <span class="n">altitude</span> <span class="p">:</span> <span class="n">altitude</span> <span class="n">MSL</span>
    <span class="n">float64</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">position_covariance</span>
    <span class="n">uint8</span> <span class="n">position_covariance_type</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/global_position/global'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">latitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">longitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">altitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/global_position/global'</span><span class="p">,</span>
<span class="nx">messageType</span><span class="p">:</span> <span class="s1">'sensor_msgs/NavSatFix'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   
    <span class="nl">latitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">longitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">altitude</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rostopic <span class="nb">echo</span> /flytos/mavros/global_position/global  
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">sensor_msgs</span><span class="o">::</span><span class="n">NavSatFix</span> <span class="n">gpos</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">gposCb</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">_gpos</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">gpos</span> <span class="o">=</span> <span class="o">*</span> <span class="p">(</span><span class="n">sensor_msgs</span><span class="o">::</span><span class="n">NavSatFix</span><span class="o">*</span><span class="p">)(</span><span class="n">_gpos</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">nav</span><span class="p">.</span><span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">global_position</span><span class="p">,</span><span class="n">gposCb</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">gpos</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># Poll data</span>
<span class="n">gpos</span> <span class="o">=</span> <span class="n">drone</span><span class="o">.</span><span class="n">get_global_position</span><span class="p">()</span>
<span class="c"># Print the data</span>
<span class="k">print</span> <span class="n">gpos</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> <span class="n">gpos</span><span class="o">.</span><span class="n">lon</span><span class="p">,</span> <span class="n">gpos</span><span class="o">.</span><span class="n">alt</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;sensor_msgs/NavSatFix.h&gt;
</span>
<span class="kt">void</span> <span class="nf">gposCallback</span><span class="p">(</span><span class="k">const</span> <span class="n">sensor_msgs</span><span class="o">::</span><span class="n">NavSatFixConstPtr</span> <span class="o">&amp;</span><span class="n">gpos</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">gpos_data</span><span class="p">.</span><span class="n">latitude</span> <span class="o">=</span> <span class="n">gpos</span><span class="o">-&gt;</span><span class="n">latitude</span><span class="p">;</span>
  <span class="n">gpos_data</span><span class="p">.</span><span class="n">longitude</span> <span class="o">=</span> <span class="n">gpos</span><span class="o">-&gt;</span><span class="n">longitude</span><span class="p">;</span>
  <span class="n">gpos_data</span><span class="p">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">gpos</span><span class="o">-&gt;</span><span class="n">altitude</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">sensor_msgs</span><span class="o">::</span><span class="n">NavSatFix</span> <span class="n">gpos_data</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">Subscriber</span> <span class="n">sub</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">subscribe</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/global_position/global"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gposCallback</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">sensor_msgs.msg</span> <span class="kn">import</span> <span class="n">NavSatFix</span>

<span class="c"># setup a subscriber and associate a callback function which will be called every time topic is updated.</span>
<span class="n">topic_sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/global_position/global"</span><span class="p">),</span> <span class="n">NavSatFix</span><span class="p">,</span> <span class="n">topic_callback</span><span class="p">)</span>

<span class="c"># define the callback function which will print the values every time topic is updated</span>
<span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">alt</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">altitude</span>
    <span class="k">print</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">alt</span>

<span class="c"># unsubscribe from a topic</span>
<span class="n">topic_sub</span><span class="o">.</span><span class="n">unregister</span><span class="p">()</span>  <span class="c"># unregister topic subscription</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/global_position/global"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>


</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">gpsData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Topic</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/global_position/global'</span><span class="p">,</span>
    <span class="na">messageType</span> <span class="p">:</span> <span class="s1">'sensor_msgs/NavSatFix'</span>
<span class="p">});</span>

<span class="nx">gpsData</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">sensor_msgs</span><span class="o">::</span><span class="n">NavSatFix</span> <span class="k">class</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">instance</span> <span class="n">of</span> <span class="k">class</span> <span class="nc">glob_position</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">sensor_msgs</span><span class="o">::</span><span class="n">NavSatFix</span> <span class="k">class</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">sensor_msgs</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">NavSatFix</span> <span class="k">class</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">latitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">longitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">altitude</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">latitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">longitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">altitude</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>


</code></pre>
<h3 id="description">Description:</h3>

<p>This API subscribes/polls position data in global coordinate system.  Please check API usage section below before using API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Response:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>lat</td>
<td>float</td>
<td>latitude in global coordinate system WGS84</td>
</tr>
<tr>
<td>lon</td>
<td>float</td>
<td>longitude in global coordinate system WGS84</td>
</tr>
<tr>
<td>alt</td>
<td>float</td>
<td>altitude from MSL (mean sea level) in meters.</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>This API provides GPS coordinates and altitude at current location</li>
<li>Altitude value returned is relative to MSL (mean sea level).</li>
<li>Be careful when using altitude data obtained from this API into takeoff or position setpoint APIs. These API&rsquo;s expect z values in local frame.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>All the autopilot state / payload data in FlytOS is shared by ROS topics. Onboard topic subscribers in rospy / roscpp can subscribe to these topics. Take a look at roscpp and rospy API definition for response message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Topic</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/mavros/global_position/global</code></li>
<li>Response Type: <code class="prettyprint">sensor_msgs/NavSatFix</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice. All RESTful APIs can poll the data. For telemetry mode (continuous data stream) use websocket APIs.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/global_position/global</code></li>
<li>JSON Response:
<code class="prettyprint">{
latitude: Float,
longitude: Float,
altitude: Float
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a></p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/mavros/global_position/global</code></li>
<li>messageType: <code class="prettyprint">sensor_msgs/NavSatFix</code></li>
</ul>

          <h2 id="get-battery-status">Get Battery Status</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Topic Name: /&lt;namespace&gt;/mavros/battery
ROS-Topic Type: sensor_msgs/BatteryState, below is its description

<span class="c">#Subscriber response : Battery Status </span>
Response structure:
uint8 <span class="nv">POWER_SUPPLY_STATUS_UNKNOWN</span><span class="o">=</span>0
uint8 <span class="nv">POWER_SUPPLY_STATUS_CHARGING</span><span class="o">=</span>1
uint8 <span class="nv">POWER_SUPPLY_STATUS_DISCHARGING</span><span class="o">=</span>2
uint8 <span class="nv">POWER_SUPPLY_STATUS_NOT_CHARGING</span><span class="o">=</span>3
uint8 <span class="nv">POWER_SUPPLY_STATUS_FULL</span><span class="o">=</span>4
uint8 <span class="nv">POWER_SUPPLY_HEALTH_UNKNOWN</span><span class="o">=</span>0
uint8 <span class="nv">POWER_SUPPLY_HEALTH_GOOD</span><span class="o">=</span>1
uint8 <span class="nv">POWER_SUPPLY_HEALTH_OVERHEAT</span><span class="o">=</span>2
uint8 <span class="nv">POWER_SUPPLY_HEALTH_DEAD</span><span class="o">=</span>3
uint8 <span class="nv">POWER_SUPPLY_HEALTH_OVERVOLTAGE</span><span class="o">=</span>4
uint8 <span class="nv">POWER_SUPPLY_HEALTH_UNSPEC_FAILURE</span><span class="o">=</span>5
uint8 <span class="nv">POWER_SUPPLY_HEALTH_COLD</span><span class="o">=</span>6
uint8 <span class="nv">POWER_SUPPLY_HEALTH_WATCHDOG_TIMER_EXPIRE</span><span class="o">=</span>7
uint8 <span class="nv">POWER_SUPPLY_HEALTH_SAFETY_TIMER_EXPIRE</span><span class="o">=</span>8
uint8 <span class="nv">POWER_SUPPLY_TECHNOLOGY_UNKNOWN</span><span class="o">=</span>0
uint8 <span class="nv">POWER_SUPPLY_TECHNOLOGY_NIMH</span><span class="o">=</span>1
uint8 <span class="nv">POWER_SUPPLY_TECHNOLOGY_LION</span><span class="o">=</span>2
uint8 <span class="nv">POWER_SUPPLY_TECHNOLOGY_LIPO</span><span class="o">=</span>3
uint8 <span class="nv">POWER_SUPPLY_TECHNOLOGY_LIFE</span><span class="o">=</span>4
uint8 <span class="nv">POWER_SUPPLY_TECHNOLOGY_NICD</span><span class="o">=</span>5
uint8 <span class="nv">POWER_SUPPLY_TECHNOLOGY_LIMN</span><span class="o">=</span>6
std_msgs/Header header
  uint32 seq
  <span class="nb">time </span>stamp
  string frame_id
float32 voltage
float32 current
float32 charge
float32 capacity
float32 design_capacity
float32 percentage
uint8 power_supply_status
uint8 power_supply_health
uint8 power_supply_technology
bool present
float32[] cell_voltage
string location
string serial_number
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>
<span class="n">Function</span><span class="p">:</span> <span class="n">get_battery_status</span><span class="p">()</span>

<span class="n">Response</span><span class="p">:</span> <span class="n">battery_status</span> <span class="k">as</span> <span class="n">described</span> <span class="n">below</span><span class="o">.</span>
    <span class="k">class</span> <span class="nc">battery_status</span><span class="p">:</span>
        <span class="s">'''
     Holds data for battery status
        '''</span>
        <span class="n">voltage</span> <span class="o">=</span> <span class="mf">0.0</span>
     <span class="n">current</span> <span class="o">=</span> <span class="mf">0.0</span>
      <span class="n">remaining</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">This</span> <span class="n">API</span> <span class="n">supports</span> <span class="n">single</span> <span class="n">poll</span> <span class="n">mode</span> <span class="n">only</span><span class="o">.</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">battery</span>
<span class="n">Response</span> <span class="n">Type</span><span class="o">:</span> <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">BatteryState</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_STATUS_UNKNOWN</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_STATUS_CHARGING</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_STATUS_DISCHARGING</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_STATUS_NOT_CHARGING</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_STATUS_FULL</span><span class="o">=</span><span class="mi">4</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_UNKNOWN</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_GOOD</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_OVERHEAT</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_DEAD</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_OVERVOLTAGE</span><span class="o">=</span><span class="mi">4</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_UNSPEC_FAILURE</span><span class="o">=</span><span class="mi">5</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_COLD</span><span class="o">=</span><span class="mi">6</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_WATCHDOG_TIMER_EXPIRE</span><span class="o">=</span><span class="mi">7</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_SAFETY_TIMER_EXPIRE</span><span class="o">=</span><span class="mi">8</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_UNKNOWN</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_NIMH</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_LION</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_LIPO</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_LIFE</span><span class="o">=</span><span class="mi">4</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_NICD</span><span class="o">=</span><span class="mi">5</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_LIMN</span><span class="o">=</span><span class="mi">6</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
        <span class="n">uint32</span> <span class="n">seq</span>
        <span class="n">time</span> <span class="n">stamp</span>
        <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">float32</span> <span class="n">voltage</span>
    <span class="n">float32</span> <span class="n">current</span>
    <span class="n">float32</span> <span class="n">charge</span>
    <span class="n">float32</span> <span class="n">capacity</span>
    <span class="n">float32</span> <span class="n">design_capacity</span>
    <span class="n">float32</span> <span class="n">percentage</span>
    <span class="n">uint8</span> <span class="n">power_supply_status</span>
    <span class="n">uint8</span> <span class="n">power_supply_health</span>
    <span class="n">uint8</span> <span class="n">power_supply_technology</span>
    <span class="kt">bool</span> <span class="n">present</span>
    <span class="n">float32</span><span class="p">[]</span> <span class="n">cell_voltage</span>
    <span class="n">string</span> <span class="n">location</span>
    <span class="n">string</span> <span class="n">serial_number</span>

</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">battery</span>
<span class="n">Response</span> <span class="n">Type</span><span class="p">:</span> <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">BatteryState</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_STATUS_UNKNOWN</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_STATUS_CHARGING</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_STATUS_DISCHARGING</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_STATUS_NOT_CHARGING</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_STATUS_FULL</span><span class="o">=</span><span class="mi">4</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_UNKNOWN</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_GOOD</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_OVERHEAT</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_DEAD</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_OVERVOLTAGE</span><span class="o">=</span><span class="mi">4</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_UNSPEC_FAILURE</span><span class="o">=</span><span class="mi">5</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_COLD</span><span class="o">=</span><span class="mi">6</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_WATCHDOG_TIMER_EXPIRE</span><span class="o">=</span><span class="mi">7</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_HEALTH_SAFETY_TIMER_EXPIRE</span><span class="o">=</span><span class="mi">8</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_UNKNOWN</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_NIMH</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_LION</span><span class="o">=</span><span class="mi">2</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_LIPO</span><span class="o">=</span><span class="mi">3</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_LIFE</span><span class="o">=</span><span class="mi">4</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_NICD</span><span class="o">=</span><span class="mi">5</span>
    <span class="n">uint8</span> <span class="n">POWER_SUPPLY_TECHNOLOGY_LIMN</span><span class="o">=</span><span class="mi">6</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
        <span class="n">uint32</span> <span class="n">seq</span>
        <span class="n">time</span> <span class="n">stamp</span>
        <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">float32</span> <span class="n">voltage</span>
    <span class="n">float32</span> <span class="n">current</span>
    <span class="n">float32</span> <span class="n">charge</span>
    <span class="n">float32</span> <span class="n">capacity</span>
    <span class="n">float32</span> <span class="n">design_capacity</span>
    <span class="n">float32</span> <span class="n">percentage</span>
    <span class="n">uint8</span> <span class="n">power_supply_status</span>
    <span class="n">uint8</span> <span class="n">power_supply_health</span>
    <span class="n">uint8</span> <span class="n">power_supply_technology</span>
    <span class="nb">bool</span> <span class="n">present</span>
    <span class="n">float32</span><span class="p">[]</span> <span class="n">cell_voltage</span>
    <span class="n">string</span> <span class="n">location</span>
    <span class="n">string</span> <span class="n">serial_number</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/battery'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">voltage</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">current</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">remaining</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/battery'</span><span class="p">,</span>
<span class="nx">messageType</span><span class="p">:</span> <span class="s1">'sensor_msgs/BatteryState'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">voltage</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">current</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">remaining</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rostopic <span class="nb">echo</span> /flytos/mavros/battery
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># Poll data</span>
<span class="n">bat</span> <span class="o">=</span> <span class="n">drone</span><span class="o">.</span><span class="n">get_battery_status</span><span class="p">()</span>
<span class="c"># Print the data</span>
<span class="k">print</span> <span class="n">bat</span><span class="o">.</span><span class="n">remaining</span><span class="p">,</span> <span class="n">bat</span><span class="o">.</span><span class="n">current</span><span class="p">,</span> <span class="n">bat</span><span class="o">.</span><span class="n">voltage</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample subscriber nodes. http://wiki.ros.org/ROS/Tutorials/WritingPublisherSubscriber%28c%2B%2B%29
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">sensor_msgs.msg</span> <span class="kn">import</span> <span class="n">BatteryState</span>

<span class="c"># setup a subscriber and associate a callback function which will be called every time topic is updated.</span>
<span class="n">topic_sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/battery"</span><span class="p">),</span> <span class="n">BatteryState</span><span class="p">,</span> <span class="n">topic_callback</span><span class="p">)</span>

<span class="c"># define the callback function which will print the values every time topic is updated</span>
<span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">voltage</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">voltage</span>
    <span class="k">print</span> <span class="n">voltage</span>

<span class="c"># unsubscribe from a topic</span>
<span class="n">topic_sub</span><span class="o">.</span><span class="n">unregister</span><span class="p">()</span>  <span class="c"># unregister topic subscription</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/battery"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>


</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">batteryData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Topic</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/battery'</span><span class="p">,</span>
    <span class="na">messageType</span> <span class="p">:</span> <span class="s1">'sensor_msgs/BatteryState'</span>
<span class="p">});</span>


<span class="nx">batteryData</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>header: 
  seq: 415
  stamp: 
    secs: 1489486630
    nsecs: 434288692
  frame_id: <span class="s1">''</span>
voltage: 65.5350036621
current: 0.00999999977648
charge: nan
capacity: nan
design_capacity: nan
percentage: -0.00999999977648
power_supply_status: 2
power_supply_health: 0
power_supply_technology: 3
present: True
cell_voltage: <span class="o">[]</span>
location: id0
serial_number: <span class="s1">''</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">instance</span> <span class="n">of</span> <span class="k">class</span> <span class="nc">battery_status</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">sensor_msgs</span><span class="o">.</span><span class="n">msg</span><span class="o">.</span><span class="n">BatteryState</span> <span class="k">class</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">voltage</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">current</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">remaining</span><span class="p">:</span> <span class="nx">Float</span><span class="p">}</span>


</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">voltage</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">current</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">remaining</span><span class="p">:</span> <span class="nx">Float</span><span class="p">}</span>



</code></pre>
<h3 id="description">Description:</h3>

<p>This API subscribes/polls battery status.  Please check API usage section below before using API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Response:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>voltage</td>
<td>float</td>
<td>total voltage, Volts</td>
</tr>
<tr>
<td>current</td>
<td>float</td>
<td>instantaneous current consumption, Amperes</td>
</tr>
<tr>
<td>charge</td>
<td>float</td>
<td>Charge</td>
</tr>
<tr>
<td>capacity</td>
<td>float</td>
<td>capacity</td>
</tr>
<tr>
<td>percentage</td>
<td>float</td>
<td>percentage left</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>This API provides voltage, current, remaining battery information.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>All the autopilot state / payload data in FlytOS is shared by ROS topics. Onboard topic subscribers in rospy / roscpp can subscribe to these topics. Take a look at roscpp and rospy API definition for response message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Topic</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/mavros/battery</code></li>
<li>Response Type: <code class="prettyprint">sensor_msgs/BatteryState</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice. All RESTful APIs can poll the data. For telemetry mode (continuous data stream) use websocket APIs.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/battery</code></li>
<li>JSON Response:
<code class="prettyprint">{
voltage: Float,
current: Float,
remaining: Float
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/mavros/battery</code></li>
<li>messageType: <code class="prettyprint">sensor_msgs/BatteryState</code></li>
</ul>

          <h2 id="get-vfr-hud">Get VFR HUD</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Topic Name: /&lt;namespace&gt;/mavros/vfr_hud
ROS-Topic Type: mavros_msgs/VFR_HUD

Response structure:
    std_msgs/Header header
      uint32 seq
      <span class="nb">time </span>stamp
      string frame_id
    float32 airspeed
    float32 groundspeed
    int16 heading
    float32 throttle
    float32 altitude
    float32 climb

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>
<span class="n">Function</span><span class="p">:</span> <span class="n">get_vfr_hud</span><span class="p">()</span>

<span class="n">Response</span><span class="p">:</span> <span class="n">vfr_hud</span> <span class="k">as</span> <span class="n">described</span> <span class="n">below</span><span class="o">.</span>
    <span class="k">class</span> <span class="nc">vfr_hud</span><span class="p">:</span>
        <span class="s">'''
     Holds data for VFR HUD
     '''</span>
        <span class="n">airspeed</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">groundspeed</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">heading</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">throttle</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">altitude</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">climb</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">This</span> <span class="n">API</span> <span class="n">supports</span> <span class="n">single</span> <span class="n">poll</span> <span class="n">mode</span> <span class="n">only</span><span class="o">.</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">mavros_msgs</span><span class="o">/</span><span class="n">vfr_hud</span>

<span class="n">Response</span> <span class="n">structure</span><span class="o">:</span> <span class="n">mavros_msgs</span><span class="o">/</span><span class="n">VFR_HUD</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
        <span class="n">uint32</span> <span class="n">seq</span>
        <span class="n">time</span> <span class="n">stamp</span>
        <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">float32</span> <span class="n">airspeed</span>
    <span class="n">float32</span> <span class="n">groundspeed</span>
    <span class="n">int16</span> <span class="n">heading</span>
    <span class="n">float32</span> <span class="n">throttle</span>
    <span class="n">float32</span> <span class="n">altitude</span>
    <span class="n">float32</span> <span class="n">climb</span>



</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Topic</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">mavros_msgs</span><span class="o">/</span><span class="n">vfr_hud</span>

<span class="n">Response</span> <span class="n">structure</span><span class="p">:</span> <span class="n">mavros_msgs</span><span class="o">/</span><span class="n">VFR_HUD</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
        <span class="n">uint32</span> <span class="n">seq</span>
        <span class="n">time</span> <span class="n">stamp</span>
        <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">float32</span> <span class="n">airspeed</span>
    <span class="n">float32</span> <span class="n">groundspeed</span>
    <span class="n">int16</span> <span class="n">heading</span>
    <span class="n">float32</span> <span class="n">throttle</span>
    <span class="n">float32</span> <span class="n">altitude</span>
    <span class="n">float32</span> <span class="n">climb</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/vfr_hud'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">airspeed</span><span class="p">:</span><span class="nx">Float</span><span class="p">,</span>
    <span class="nx">groundspeed</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">heading</span><span class="p">:</span> <span class="nx">Integer</span><span class="p">,</span>
    <span class="nx">throttle</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">altitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">climb</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/vfr_hud'</span><span class="p">,</span>
<span class="nx">messageType</span><span class="p">:</span> <span class="s1">'mavros_msgs/VFR_HUD'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">airspeed</span><span class="p">:</span><span class="nx">Float</span><span class="p">,</span>
    <span class="nx">groundspeed</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">heading</span><span class="p">:</span> <span class="nx">Integer</span><span class="p">,</span>
    <span class="nx">throttle</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">altitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">climb</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rostopic <span class="nb">echo</span> /flytos/mavros/mavros_msgs/vfr_hud
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># Poll data</span>
<span class="n">vfr</span> <span class="o">=</span> <span class="n">drone</span><span class="o">.</span><span class="n">get_vfr_hud</span><span class="p">()</span>
<span class="c"># Print the data</span>
<span class="k">print</span> <span class="n">vfr</span><span class="o">.</span><span class="n">throttle</span><span class="p">,</span> <span class="n">vfr</span><span class="o">.</span><span class="n">groundspeed</span><span class="p">,</span> <span class="n">vfr</span><span class="o">.</span><span class="n">airspeed</span><span class="p">,</span> <span class="n">vfr</span><span class="o">.</span><span class="n">altitude</span><span class="p">,</span> <span class="n">vfr</span><span class="o">.</span><span class="n">climb</span><span class="p">,</span> <span class="n">vfr</span><span class="o">.</span><span class="n">heading</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample subscriber nodes. http://wiki.ros.org/ROS/Tutorials/WritingPublisherSubscriber%28c%2B%2B%29
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">mavros_msgs.msgs</span> <span class="kn">import</span> <span class="n">VFR_HUD</span>

<span class="c"># setup a subscriber and associate a callback function which will be called every time topic is updated.</span>
<span class="n">topic_sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/vfr_hud"</span><span class="p">),</span> <span class="n">VFR_HUD</span><span class="p">,</span> <span class="n">topic_callback</span><span class="p">)</span>

<span class="c"># define the callback function which will print the values every time topic is updated</span>
<span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">airspeed</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">airspeed</span>
    <span class="k">print</span> <span class="n">airspeed</span>

<span class="c"># unsubscribe from a topic</span>
<span class="n">topic_sub</span><span class="o">.</span><span class="n">unregister</span><span class="p">()</span>  <span class="c"># unregister topic subscription</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/vfr_hud"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>


</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">vfrHUDData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Topic</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/vfr_hud'</span><span class="p">,</span>
    <span class="na">messageType</span> <span class="p">:</span> <span class="s1">'mavros_msgs/VFR_HUD'</span>
<span class="p">});</span>

<span class="nx">vfrHUDData</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>header: 
  seq: 3664
  stamp: 
    secs: 1489486597
    nsecs: 915001340
  frame_id: <span class="s1">''</span>
airspeed: 0.0
groundspeed: 0.0
heading: 289
throttle: 0.0
altitude: 601.289001465
climb: -0.0
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">instance</span> <span class="n">of</span> <span class="k">class</span> <span class="nc">vfr_hud</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">mavros_msgs</span><span class="o">.</span><span class="n">msgs</span><span class="o">.</span><span class="n">VFR_HUD</span> <span class="k">class</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">airspeed</span><span class="p">:</span><span class="nx">Float</span><span class="p">,</span>
    <span class="nx">groundspeed</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">heading</span><span class="p">:</span> <span class="nx">Integer</span><span class="p">,</span>
    <span class="nx">throttle</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">altitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">climb</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">airspeed</span><span class="p">:</span><span class="nx">Float</span><span class="p">,</span>
    <span class="nx">groundspeed</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">heading</span><span class="p">:</span> <span class="nx">Integer</span><span class="p">,</span>
    <span class="nx">throttle</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">altitude</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">climb</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>


</code></pre>
<h3 id="description">Description:</h3>

<p>This API subscribes/polls VFR HUD data. Please check API usage section below before using API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Response:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>airspeed</td>
<td>float</td>
<td>airspeed in m/s</td>
</tr>
<tr>
<td>groundspeed</td>
<td>float</td>
<td>groundspeed in m/s</td>
</tr>
<tr>
<td>heading</td>
<td>int16</td>
<td>yaw angle in degrees (NED frame)</td>
</tr>
<tr>
<td>throttle</td>
<td>float</td>
<td>throttle</td>
</tr>
<tr>
<td>altitude</td>
<td>float</td>
<td>altitude</td>
</tr>
<tr>
<td>climb</td>
<td>float</td>
<td>climb</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>airspeed data is the data from airspeed sensor.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>All the autopilot state/payload data in FlytOS is shared by ROS topics. Onboard topic subscribers in rospy/roscpp can subscribe to these topics. Take a look at roscpp and rospy API definition for response message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Topic</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/mavros/vfr_hud</code></li>
<li>Response Type: <code class="prettyprint">mavros_msgs/VFR_HUD</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice. All RESTful APIs can poll the data. For telemetry mode (continuous data stream) use websocket APIs.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/vfr_hud</code></li>
<li>JSON Response:
<code class="prettyprint">{
airspeed:Float,
groundspeed: Float,
heading: Integer,
throttle: Float,
altitude: Float,
climb: Float
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/mavros/vfr_hud</code></li>
<li>messageType: <code class="prettyprint">mavros_msgs/VFR_HUD</code></li>
</ul>

          <h2 id="get-rc-data">Get RC Data</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Topic Name: /&lt;namespace&gt;/mavros/rc/in
ROS-Topic Type: mavros_msgs/RCIn

Response structure:
    std_msgs/Header header
      uint32 seq
      <span class="nb">time </span>stamp
      string frame_id
    uint8 rssi
    uint16[] channels
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// CPP API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from cpp.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">rc_channels</span><span class="p">,</span><span class="n">rcChannelCb</span><span class="p">);</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">rc_channels</span><span class="o">:</span> <span class="n">This</span> <span class="n">argument</span> <span class="n">selects</span> <span class="n">RC</span> <span class="n">channels</span> <span class="n">topic</span> <span class="n">to</span> <span class="n">be</span> <span class="n">subscribed</span>
    <span class="n">rcChannelCb</span><span class="o">:</span> <span class="n">Callback</span> <span class="n">function</span> <span class="k">for</span> <span class="n">the</span> <span class="n">subscribed</span> <span class="n">RC</span> <span class="n">channel</span> <span class="n">messages</span>

<span class="n">Returns</span><span class="o">:</span> <span class="n">RC</span> <span class="n">channel</span> <span class="n">info</span> <span class="n">in</span> <span class="n">ros</span> <span class="n">mavros_msgs</span><span class="o">::</span><span class="n">RCInConstPtr</span> <span class="n">structure</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">uint8</span> <span class="n">rssi</span>
    <span class="n">uint16</span><span class="p">[]</span> <span class="n">channels</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>
<span class="n">Function</span><span class="p">:</span> <span class="n">get_rc_data</span><span class="p">()</span>

<span class="n">Response</span><span class="p">:</span> <span class="n">rc_data</span> <span class="k">as</span> <span class="n">described</span> <span class="n">below</span><span class="o">.</span>
   <span class="k">class</span> <span class="nc">rc_data</span><span class="p">:</span>
    <span class="s">"""
    Holds the input rc channel data
    """</span>
    <span class="n">rssi</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">channels</span> <span class="o">=</span> <span class="p">[]</span>


<span class="n">This</span> <span class="n">API</span> <span class="n">supports</span> <span class="n">single</span> <span class="n">poll</span> <span class="n">mode</span> <span class="n">only</span><span class="o">.</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">rc</span><span class="o">/</span><span class="n">in</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Type</span><span class="o">:</span> <span class="n">mavros_msgs</span><span class="o">/</span><span class="n">RCIn</span>

<span class="n">Response</span> <span class="n">structure</span><span class="o">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">uint8</span> <span class="n">rssi</span>
    <span class="n">uint16</span><span class="p">[]</span> <span class="n">channels</span>

</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">rc</span><span class="o">/</span><span class="ow">in</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Type</span><span class="p">:</span> <span class="n">mavros_msgs</span><span class="o">/</span><span class="n">RCIn</span>

<span class="n">Response</span> <span class="n">structure</span><span class="p">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">uint8</span> <span class="n">rssi</span>
    <span class="n">uint16</span><span class="p">[]</span> <span class="n">channels</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/rc/in'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">rssi</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">channels</span><span class="p">:</span> <span class="nx">Int</span><span class="p">[]</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/rc/in'</span><span class="p">,</span>
<span class="nx">messageType</span><span class="p">:</span> <span class="s1">'mavros_msgs/RCIn'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">rssi</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">channels</span><span class="p">:</span> <span class="nx">Int</span><span class="p">[]</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rostopic <span class="nb">echo</span> /flytos/mavros/rc/in 
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">mavros_msgs</span><span class="o">::</span><span class="n">RCIn</span> <span class="n">rc_channel</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">rcChannelCb</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">_rc_channel</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">rc_channel</span> <span class="o">=</span> <span class="o">*</span> <span class="p">(</span><span class="n">mavros_msgs</span><span class="o">::</span><span class="n">RCIn</span><span class="o">*</span><span class="p">)(</span><span class="n">_rc_channel</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">nav</span><span class="p">.</span><span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">rc_channels</span><span class="p">,</span><span class="n">rcChannelCb</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">rc_channel</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># Poll data</span>
<span class="n">rc</span> <span class="o">=</span> <span class="n">drone</span><span class="o">.</span><span class="n">get_rc_data</span><span class="p">()</span>

<span class="c"># Print the data</span>
<span class="k">print</span> <span class="n">rc</span><span class="o">.</span><span class="n">rssi</span><span class="p">,</span> <span class="n">rc</span><span class="o">.</span><span class="n">channels</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample subscriber nodes. http://wiki.ros.org/ROS/Tutorials/WritingPublisherSubscriber%28c%2B%2B%29
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">mavros_msgs.msgs</span> <span class="kn">import</span> <span class="n">RCIn</span>
<span class="c"># setup a subscriber and associate a callback function which will be called every time topic is updated.</span>
<span class="n">topic_sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/rc/in"</span><span class="p">),</span> <span class="n">State</span><span class="p">,</span> <span class="n">topic_callback</span><span class="p">)</span>

<span class="c"># define the callback function which will print the values every time topic is updated</span>
<span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c"># print data from first 6 channels</span>
    <span class="k">print</span> <span class="n">data</span><span class="o">.</span><span class="n">channels</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>


<span class="c"># unsubscribe from a topic</span>
<span class="n">topic_sub</span><span class="o">.</span><span class="n">unregister</span><span class="p">()</span>  <span class="c"># unregister topic subscription</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/rc/in"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>


</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">rcData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Topic</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/rc/in'</span><span class="p">,</span>
    <span class="na">messageType</span> <span class="p">:</span> <span class="s1">'mavros_msgs/RCIn'</span>
<span class="p">});</span>

<span class="nx">rcData</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>instance of mavros_msgs/RCIn
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">mavros_msgs</span><span class="o">::</span><span class="n">RCIn</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">instance</span> <span class="n">of</span> <span class="k">class</span> <span class="nc">rc_data</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="p">[</span><span class="mi">1001</span><span class="p">,</span><span class="mi">999</span><span class="p">,</span><span class="mi">1400</span><span class="p">,</span><span class="mi">1234</span><span class="p">,</span><span class="mi">1764</span><span class="p">,</span><span class="mi">1900</span><span class="p">]</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">rssi</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">channels</span><span class="p">:</span> <span class="nx">Int</span><span class="p">[]</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">rssi</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">channels</span><span class="p">:</span> <span class="nx">Int</span><span class="p">[]</span>
<span class="p">}</span>


</code></pre>
<h3 id="description">Description:</h3>

<p>This API subscribes/polls the input rc channel data. Please see usage information section below before using the API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Response:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>channels</td>
<td>Array of unit16</td>
<td>Array of PWM data values for channels.</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>Channel mapping of the data depends on RC calibration. </li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>All the autopilot state / payload data in FlytOS is shared by ROS topics. Onboard topic subscribers in rospy / roscpp can subscribe to these topics. Take a look at roscpp and rospy API definition for response message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Topic</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/mavros/rc/in</code></li>
<li>Response Type: <code class="prettyprint">mavros_msgs/RCIn</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice. All RESTful APIs can poll the data. For telemetry mode (continuous data stream) use websocket APIs.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/rc/in</code></li>
<li>JSON Response:
<code class="prettyprint">{
rssi: Int,
channels: Int[]
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/mavros/rc/in</code></li>
<li>messageType: <code class="prettyprint">mavros_msgs/RCIn</code></li>
</ul>

          <h2 id="get-distance-sensor">Get Distance Sensor</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Topic Name: /&lt;namespace&gt;/mavros/distance_sensor/lidarlite_pub
ROS-Topic Type: sensor_msgs/Range

Response structure:
    uint8 <span class="nv">ULTRASOUND</span><span class="o">=</span>0
    uint8 <span class="nv">INFRARED</span><span class="o">=</span>1
    std_msgs/Header header
      uint32 seq
      <span class="nb">time </span>stamp
      string frame_id
    uint8 radiation_type
    float32 field_of_view
    float32 min_range
    float32 max_range
    float32 range


</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>
<span class="n">Function</span><span class="p">:</span> <span class="n">get_distance_sensor</span><span class="p">()</span>
<span class="n">Response</span><span class="p">:</span> <span class="n">dist_sensor</span> <span class="k">as</span> <span class="n">described</span> <span class="n">below</span><span class="o">.</span>
 <span class="k">class</span> <span class="nc">dist_sensor</span><span class="p">:</span>
    <span class="s">"""
    Holds distance sensor data
    """</span>
    <span class="n">radiation_type</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">field_of_view</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">min_range</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">max_range</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="nb">range</span> <span class="o">=</span> <span class="mf">0.0</span>

<span class="n">This</span> <span class="n">API</span> <span class="n">supports</span> <span class="n">single</span> <span class="n">poll</span> <span class="n">mode</span> <span class="n">only</span><span class="o">.</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">distance_sensor</span><span class="o">/</span><span class="n">lidarlite_pub</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Type</span><span class="o">:</span> <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">Range</span>

<span class="n">Response</span> <span class="n">structure</span><span class="o">:</span>
    <span class="n">uint8</span> <span class="n">ULTRASOUND</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">uint8</span> <span class="n">INFRARED</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">uint8</span> <span class="n">radiation_type</span>
    <span class="n">float32</span> <span class="n">field_of_view</span>
    <span class="n">float32</span> <span class="n">min_range</span>
    <span class="n">float32</span> <span class="n">max_range</span>
    <span class="n">float32</span> <span class="n">range</span>



</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">distance_sensor</span><span class="o">/</span><span class="n">lidarlite_pub</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Type</span><span class="p">:</span> <span class="n">sensor_msgs</span><span class="o">/</span><span class="n">Range</span>

<span class="n">Response</span> <span class="n">structure</span><span class="p">:</span>
    <span class="n">uint8</span> <span class="n">ULTRASOUND</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">uint8</span> <span class="n">INFRARED</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">uint8</span> <span class="n">radiation_type</span>
    <span class="n">float32</span> <span class="n">field_of_view</span>
    <span class="n">float32</span> <span class="n">min_range</span>
    <span class="n">float32</span> <span class="n">max_range</span>
    <span class="n">float32</span> <span class="nb">range</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/distance_sensor/lidarlite_pub'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">radiation_type</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">field_of_view</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">min_range</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>  
    <span class="nx">max_range</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">range</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/distance_sensor/lidarlite_pub'</span><span class="p">,</span>
<span class="nx">messageType</span><span class="p">:</span> <span class="s1">'sensor_msgs/Range'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">radiation_type</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">field_of_view</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">min_range</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>  
    <span class="nx">max_range</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">range</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rostopic <span class="nb">echo</span> /flytos/mavros/distance_sensor/lidarlite_pub
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># Poll data</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">drone</span><span class="o">.</span><span class="n">get_distance_sensor</span><span class="p">()</span>

<span class="c"># Print the data</span>
<span class="k">print</span> <span class="n">dist</span><span class="o">.</span><span class="nb">range</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">max_range</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">min_range</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">field_of_view</span><span class="p">,</span> <span class="n">dist</span><span class="o">.</span><span class="n">radiation_type</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample subscriber nodes. http://wiki.ros.org/ROS/Tutorials/WritingPublisherSubscriber%28c%2B%2B%29
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">sensor_msgs.msgs</span> <span class="kn">import</span> <span class="n">Range</span>

<span class="c"># setup a subscriber and associate a callback function which will be called every time topic is updated.</span>
<span class="n">topic_sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/distance_sensor/lidarlite_pub"</span><span class="p">),</span> <span class="n">Range</span><span class="p">,</span> <span class="n">topic_callback</span><span class="p">)</span>

<span class="c"># define the callback function which will print the values every time topic is updated</span>
<span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="nb">range</span>
    <span class="k">print</span> <span class="n">dist</span>

<span class="c"># unsubscribe from a topic</span>
<span class="n">topic_sub</span><span class="o">.</span><span class="n">unregister</span><span class="p">()</span>  <span class="c"># unregister topic subscription</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/distance_sensor/lidarlite_pub"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>


</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">distanceData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Topic</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/distance_sensor/lidarlite_pub'</span><span class="p">,</span>
    <span class="na">messageType</span> <span class="p">:</span> <span class="s1">'sensor_msgs/Range'</span>
<span class="p">});</span>


<span class="nx">distanceData</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>instance of sensor_msgs/Range
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">instance</span> <span class="n">of</span> <span class="k">class</span> <span class="nc">dist_sensor</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">sensor_msgs</span><span class="o">.</span><span class="n">msgs</span><span class="o">.</span><span class="n">Range</span> <span class="nb">object</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">radiation_type</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">field_of_view</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">min_range</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>  
    <span class="nx">max_range</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">range</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">radiation_type</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">field_of_view</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">min_range</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>  
    <span class="nx">max_range</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">range</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>


</code></pre>
<h3 id="description">Description:</h3>

<p>This API subscribes/polls distance sensor data. Check API usage section below before using API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Response:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>range</td>
<td>float</td>
<td>distance to ground in meters</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>This topic provides data from Lidarlite rangefinder, ultrasonic SONAR sensor, etc.</li>
<li>This API will work on any px4 supported hardware.</li>
<li>If you are using FlytPOD then check hardware and wiring sections in docs for wiring info.</li>
<li>If you are using anything else than FlytPOD then refer to respective autopilot documentation for wiring info.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>All the autopilot state / payload data in FlytOS is shared by ROS topics. Onboard topic subscribers in rospy / roscpp can subscribe to these topics. Take a look at roscpp and rospy API definition for response message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Topic</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/mavros/distance_sensor/lidarlite_pub</code></li>
<li>Response Type: <code class="prettyprint">sensor_msgs/Range</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice. All RESTful APIs can poll the data. For telemetry mode (continuous data stream) use websocket APIs.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/distance_sensor/lidarlite_pub</code></li>
<li>JSON Response:
<code class="prettyprint">{
radiation_type: Int,
field_of_view: Float,
min_range: Float,  
max_range: Float,
range: Float
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/mavros/distance_sensor/lidarlite_pub</code></li>
<li>messageType: <code class="prettyprint">sensor_msgs/Range</code></li>
</ul>

          <h2 id="get-vehicle-state">Get Vehicle State</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Topic Name: /&lt;namespace&gt;/flyt/state
ROS-Topic Type: mavros_msgs/State

Response structure:
    std_msgs/Header header
      uint32 seq
      <span class="nb">time </span>stamp
      string frame_id
    bool connected
    bool armed
    bool guided
    string mode
    uint8 mav_type
    uint8 mav_autopilot
    uint8 mav_sys_status

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// CPP API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from cpp.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">vehicle_state</span><span class="p">,</span><span class="n">vehicleModeCb</span><span class="p">);</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">vehicle_state</span><span class="o">:</span> <span class="n">This</span> <span class="n">argument</span> <span class="n">selects</span> <span class="n">vehicle</span> <span class="n">state</span> <span class="n">topic</span> <span class="n">to</span> <span class="n">be</span> <span class="n">subscribed</span>
    <span class="n">vehicleModeCb</span><span class="o">:</span> <span class="n">Callback</span> <span class="n">function</span> <span class="k">for</span> <span class="n">the</span> <span class="n">subscribed</span> <span class="n">vehicle</span> <span class="n">state</span> <span class="n">messages</span>

<span class="n">Returns</span><span class="o">:</span> <span class="n">Vehicle</span> <span class="n">state</span> <span class="n">in</span> <span class="n">ros</span> <span class="n">mavros_msgs</span><span class="o">::</span><span class="n">State</span> <span class="n">message</span> <span class="n">structure</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="kt">bool</span> <span class="n">connected</span>
    <span class="kt">bool</span> <span class="n">armed</span>
    <span class="kt">bool</span> <span class="n">guided</span>
    <span class="n">string</span> <span class="n">mode</span>
    <span class="n">uint8</span> <span class="n">mav_type</span>
    <span class="n">uint8</span> <span class="n">mav_autopilot</span>
    <span class="n">uint8</span> <span class="n">mav_sys_status</span>

</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>

<span class="c"># Python API for vehicle state is split into three APIs</span>

<span class="c"># Get full vehicle state data</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>
<span class="n">Function</span><span class="p">:</span> <span class="n">get_vehicle_state</span><span class="p">()</span>
<span class="n">Response</span><span class="p">:</span> <span class="n">vehicle_state</span> <span class="k">as</span> <span class="n">described</span> <span class="n">below</span><span class="o">.</span>
<span class="k">class</span> <span class="nc">vehicle_state</span><span class="p">:</span>
    <span class="s">"""
    Holds vehicle state data
    """</span>
    <span class="n">connected</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">armed</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">guided</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="s">'String'</span>
    <span class="n">mav_type</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">mav_autopilot</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">mav_sys_status</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">This</span> <span class="n">API</span> <span class="n">supports</span> <span class="n">single</span> <span class="n">poll</span> <span class="n">mode</span> <span class="n">only</span><span class="o">.</span>

<span class="c"># Check arm status</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="p">:</span> <span class="n">is_armed</span><span class="p">()</span>
<span class="n">Arguments</span><span class="p">:</span> <span class="bp">None</span>
<span class="k">return</span><span class="p">:</span> <span class="n">Boolean</span>

<span class="c"># Check vehicle mode</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">navigation</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="p">:</span> <span class="n">get_vehicle_mode</span><span class="p">()</span>
<span class="n">Arguments</span><span class="p">:</span> <span class="bp">None</span>
<span class="k">return</span><span class="p">:</span> <span class="n">string</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">flyt</span><span class="o">/</span><span class="n">state</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Type</span><span class="o">:</span> <span class="n">mavros_msgs</span><span class="o">/</span><span class="n">State</span>

<span class="n">Response</span> <span class="n">structure</span><span class="o">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="kt">bool</span> <span class="n">connected</span>
    <span class="kt">bool</span> <span class="n">armed</span>
    <span class="kt">bool</span> <span class="n">guided</span>
    <span class="n">string</span> <span class="n">mode</span>
    <span class="n">uint8</span> <span class="n">mav_type</span>
    <span class="n">uint8</span> <span class="n">mav_autopilot</span>
    <span class="n">uint8</span> <span class="n">mav_sys_status</span>

</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">flyt</span><span class="o">/</span><span class="n">state</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Type</span><span class="p">:</span> <span class="n">mavros_msgs</span><span class="o">/</span><span class="n">State</span>

<span class="n">Response</span> <span class="n">structure</span><span class="p">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="nb">bool</span> <span class="n">connected</span>
    <span class="nb">bool</span> <span class="n">armed</span>
    <span class="nb">bool</span> <span class="n">guided</span>
    <span class="n">string</span> <span class="n">mode</span>
    <span class="n">uint8</span> <span class="n">mav_type</span>
    <span class="n">uint8</span> <span class="n">mav_autopilot</span>
    <span class="n">uint8</span> <span class="n">mav_sys_status</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/flyt/state'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">connected</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">armed</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">guided</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">mode</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">mav_type</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">mav_autopilot</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">mav_sys_status</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/flyt/state'</span><span class="p">,</span>
<span class="nx">messageType</span><span class="p">:</span> <span class="s1">'mavros_msgs/State'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">connected</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">armed</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">guided</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">mode</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">mav_type</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">mav_autopilot</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">mav_sys_status</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rostopic <span class="nb">echo</span> /flytos/flyt/state
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/navigation_bridge.h&gt;
</span>
<span class="n">Navigation</span> <span class="n">nav</span><span class="p">;</span>
<span class="n">mavros_msgs</span><span class="o">::</span><span class="n">State</span> <span class="n">vehicle_state</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">attitudeQuatCb</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">_vehicle_state</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">vehicle_state</span> <span class="o">=</span> <span class="o">*</span> <span class="p">(</span><span class="n">mavros_msgs</span><span class="o">::</span><span class="n">State</span><span class="o">*</span><span class="p">)(</span><span class="n">_vehicle_state</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">nav</span><span class="p">.</span><span class="n">sysSubscribe</span><span class="p">(</span><span class="n">Navigation</span><span class="o">::</span><span class="n">vehicle_state</span><span class="p">,</span><span class="n">vehicleModeCb</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">vehicle_state</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>

<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">api</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>
<span class="c"># Poll data</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">drone</span><span class="o">.</span><span class="n">get_vehicle_state</span><span class="p">()</span>

<span class="c"># Print the data</span>
<span class="k">print</span> <span class="n">st</span><span class="o">.</span><span class="n">connected</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">armed</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">guided</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">mav_type</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">mav_autopilot</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">mav_sys_status</span>

<span class="c"># get arm status</span>
<span class="k">print</span> <span class="n">drone</span><span class="o">.</span><span class="n">is_armed</span><span class="p">()</span>
<span class="k">print</span> <span class="n">drone</span><span class="o">.</span><span class="n">get_vehicle_mode</span><span class="p">()</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">mavros_msgs.msgs</span> <span class="kn">import</span> <span class="n">State</span>
<span class="c"># setup a subscriber and associate a callback function which will be called every time topic is updated.</span>
<span class="n">topic_sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/flyt/state"</span><span class="p">),</span> <span class="n">State</span><span class="p">,</span> <span class="n">topic_callback</span><span class="p">)</span>

<span class="c"># define the callback function which will print the values every time topic is updated</span>
<span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">mode</span><span class="p">,</span> <span class="n">is_armed</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">armed</span>
    <span class="k">print</span> <span class="n">mode</span><span class="p">,</span> <span class="n">is_armed</span>

<span class="c"># unsubscribe from a topic</span>
<span class="n">topic_sub</span><span class="o">.</span><span class="n">unregister</span><span class="p">()</span>  <span class="c"># unregister topic subscription</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/flyt/state"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>


</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">stateData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Topic</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/flyt/state'</span><span class="p">,</span>
    <span class="na">messageType</span> <span class="p">:</span> <span class="s1">'mavros_msgs/State'</span>
<span class="p">});</span>

<span class="nx">stateData</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>header: 
  seq: 1666
  stamp: 
    secs: 1489487905
    nsecs: 864919940
  frame_id: <span class="s1">''</span>
connected: True
armed: False
guided: False
mode: RC|MANUAL
mav_type: 2
mav_autopilot: 12
mav_sys_status: 0
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Instance</span> <span class="n">of</span> <span class="n">mavros_msgs</span><span class="o">::</span><span class="n">State</span> <span class="k">class</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">instance</span> <span class="n">of</span> <span class="k">class</span> <span class="nc">vehicle_state</span>
<span class="bp">True</span>
<span class="n">MANUAL</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code><span class="bp">True</span> <span class="n">MANUAL</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">connected</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">armed</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">guided</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">mode</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">mav_type</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">mav_autopilot</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">mav_sys_status</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">connected</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">armed</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">guided</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">mode</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">mav_type</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">mav_autopilot</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">mav_sys_status</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>


</code></pre>
<h3 id="description">Description:</h3>

<p>This API subscribes/polls the vehicle state data. Check usage information section below before using the API.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Response:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>mode</td>
<td>string</td>
<td>autopilot flight mode e.g. MANUAL, APICTL</td>
</tr>
<tr>
<td>armed</td>
<td>boolean</td>
<td>Vehicle arm status. Armed if True and disarmed if False.</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>This API provides mode and arm status.</li>
<li>All navigation API&rsquo;s work only in Offboard / APICTL mode. So checking the mode before firing mission critical commands is advised.</li>
<li>This API only allows to read the mode and arm status. </li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>All the autopilot state/payload data in FlytOS is shared by ROS topics. Onboard topic subscribers in rospy / roscpp can subscribe to these topics. Take a look at roscpp and rospy API definition for response message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Topic</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/flyt/state</code></li>
<li>Response Type: <code class="prettyprint">mavros_msgs/State</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice. All RESTful APIs can poll the data. For telemetry mode (continuous data stream) use websocket APIs.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/flyt/state</code></li>
<li>JSON Response:
<code class="prettyprint">{
connected: Boolean,
armed: Boolean,
guided: Boolean,
mode: String,
mav_type: Int,
mav_autopilot: Int,
mav_sys_status: Int
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/flyt/state</code></li>
<li>messageType: <code class="prettyprint">mavros_msgs/State</code></li>
</ul>

          <h1 id="payload-apis">Payload APIs</h1>

<h2 id="get-adc-data">Get ADC data</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Topic Name: /&lt;namespace&gt;/mavros/payload_adc
ROS-Topic Type: mavros_msgs/PayloadADC

Response structure:
    std_msgs/Header header
      uint32 seq
      <span class="nb">time </span>stamp
      string frame_id
    float32[2] adc_voltage
    uint8 adc_updated

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// CPP API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from cpp.
</span>
<span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>
<span class="n">Function</span><span class="p">:</span> <span class="n">get_adc_data</span><span class="p">()</span>
<span class="n">Response</span><span class="p">:</span> <span class="n">adc_data</span> <span class="k">as</span> <span class="n">described</span> <span class="n">below</span><span class="o">.</span>
<span class="k">class</span> <span class="nc">adc_data</span><span class="p">:</span>
    <span class="s">"""
    Holds ADC data
    """</span>
    <span class="n">adc_voltage</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">adc_updated</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">This</span> <span class="n">API</span> <span class="n">supports</span> <span class="n">single</span> <span class="n">poll</span> <span class="n">mode</span> <span class="n">only</span><span class="o">.</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">payload_adc</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Type</span><span class="o">:</span> <span class="n">mavros_msgs</span><span class="o">/</span><span class="n">PayloadADC</span>

<span class="n">Response</span> <span class="n">structure</span><span class="o">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">float32</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">adc_voltage</span>
    <span class="n">uint8</span> <span class="n">adc_updated</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">mavros</span><span class="o">/</span><span class="n">payload_adc</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Type</span><span class="p">:</span> <span class="n">mavros_msgs</span><span class="o">/</span><span class="n">PayloadADC</span>

<span class="n">Response</span> <span class="n">structure</span><span class="p">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">float32</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">adc_voltage</span>
    <span class="n">uint8</span> <span class="n">adc_updated</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/payload_adc'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">adc_voltage</span><span class="p">:</span> <span class="nx">Float</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="nx">adc_updated</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/payload_adc'</span><span class="p">,</span>
<span class="nx">messageType</span><span class="p">:</span> <span class="s1">'mavros_msgs/PayloadADC'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">adc_voltage</span><span class="p">:</span> <span class="nx">Float</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="nx">adc_updated</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rostopic <span class="nb">echo</span> /flytos/mavros/payload_adc

<span class="c">#sends (x,y,z)=(1.0,3.5,-5.0)(m), yaw=0.12rad, relative=false, async=false, yaw_valid=true, body_frame=false</span>
<span class="c">#default value of tolerance=1.0m if left at 0    </span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c"># Poll data</span>
<span class="n">adc</span> <span class="o">=</span> <span class="n">drone</span><span class="o">.</span><span class="n">get_adc_data</span><span class="p">()</span>

<span class="c"># Print the data </span>
<span class="k">print</span> <span class="n">adc</span><span class="o">.</span><span class="n">adc_voltage</span><span class="p">,</span> <span class="n">adc</span><span class="o">.</span><span class="n">adc_updated</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/PositionSet.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">PositionSet</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/navigation/position_set"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">PositionSet</span> <span class="n">srv</span><span class="p">;</span>

<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">angular</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="mf">0.12</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="mf">3.5</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">twist</span><span class="p">.</span><span class="n">linear</span><span class="p">.</span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">async</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">yaw_valid</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">relative</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">body_frame</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>

<span class="c1">//sends (x,y,z)=(1.0,3.5,-5.0)(m), yaw=0.12rad, tolerance=5.0m, relative=false, async=false, yaw_valid=true, body_frame=false
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">mavros_msgs.msgs</span> <span class="kn">import</span> <span class="n">PayloadADC</span>
<span class="c"># setup a subscriber and associate a callback function which will be called every time topic is updated.</span>
<span class="n">topic_sub</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/mavros/payload_adc"</span><span class="p">),</span> <span class="n">PayloadADC</span><span class="p">,</span> <span class="n">topic_callback</span><span class="p">)</span>

<span class="c"># define the callback function which will print the values every time topic is updated</span>
<span class="k">def</span> <span class="nf">topic_callback</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">adc1</span><span class="p">,</span><span class="n">adc2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">adc_voltage</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">data</span><span class="o">.</span><span class="n">adc_voltage</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">print</span> <span class="n">adc1</span><span class="p">,</span> <span class="n">adc2</span>

<span class="c"># unsubscribe from a topic</span>
<span class="n">topic_sub</span><span class="o">.</span><span class="n">unregister</span><span class="p">()</span>  <span class="c"># unregister topic subscription</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/payload_adc"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>


</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">adcData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/mavros/payload_adc'</span><span class="p">,</span>
    <span class="na">messageType</span> <span class="p">:</span> <span class="s1">'mavros_msgs/PayloadADC'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">adcData</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>    adc_voltage: Float[2],
    adc_updated: Int
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">instance</span> <span class="n">of</span> <span class="k">class</span> <span class="nc">adc_data</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">instance</span> <span class="n">of</span> <span class="n">mavros_msgs</span><span class="o">.</span><span class="n">msgs</span><span class="o">.</span><span class="n">PayloadADC</span> <span class="nb">object</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">adc_voltage</span><span class="p">:</span> <span class="nx">Float</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="nx">adc_updated</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">adc_voltage</span><span class="p">:</span> <span class="nx">Float</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
    <span class="nx">adc_updated</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API subscribes/polls the ADC payload data. This API is limited to FlytPOD only. Check usage information section below before using the API.</p>

<aside class="warning">
    This API will **ONLY** work with FlytPOD/PRO.
</aside>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard cpp and python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Response:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>adc_voltage</td>
<td>array (2*1) of floats</td>
<td>array of adc voltage readings in volts.</td>
</tr>
<tr>
<td>adc_updated</td>
<td>uint8</td>
<td>Bitmask indicating updated channel. possible values: [0,1,2,3]</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>This API works only on FlytPOD.<br></li>
<li>There are two ADC channels available on back IO panel of FlytPOD. Refer to hardware connections section in FlytPOD documentation for more info on wiring.</li>
<li>ADC channel operational input voltage range is 0 to 3.3 V.</li>
</ul>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>All the autopilot state/payload data in FlytOS is shared by ROS topics. Onboard topic subscribers in rospy/roscpp can subscribe to these topics. Take a look at roscpp and rospy API definition for response message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Topic</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/mavros/payload_adc</code></li>
<li>Response Type: <code class="prettyprint">mavros_msgs/PayloadADC</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice. All RESTful APIs can poll the data. For telemetry mode (continuous data stream) use websocket APIs.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/mavros/payload_adc</code></li>
<li>JSON Response:
<code class="prettyprint">{
adc_voltage: Float[2],
adc_updated: Int
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/mavros/payload_adc</code></li>
<li>messageType: <code class="prettyprint">mavros_msgs/PayloadADC</code></li>
</ul>

          <h2 id="gimbal-control">Gimbal Control</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device using desktop or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/payload/gimbal_set
ROS-Service Type: core_api/GimbalSet, below is its description

<span class="c">#Request : expects gimbal attitude setpoint in radians via roll, pitch, yaw in NED Frame</span>
<span class="c">#Response : return success=true if command is successfully sent</span>

float64 roll
float64 pitch
float64 yaw
---
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">gimbal_control</span><span class="p">(</span> <span class="n">roll</span><span class="p">,</span> <span class="n">pitch</span><span class="p">,</span> <span class="n">yaw</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">payload</span><span class="o">/</span><span class="n">gimbal_set</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="n">float64</span> <span class="n">roll</span>
    <span class="o">:</span><span class="n">float64</span> <span class="n">pitch</span>
    <span class="o">:</span><span class="n">float64</span> <span class="n">yaw</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">payload</span><span class="o">/</span><span class="n">gimbal_set</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="n">float64</span> <span class="n">roll</span>
    <span class="p">:</span><span class="n">float64</span> <span class="n">pitch</span>
    <span class="p">:</span><span class="n">float64</span> <span class="n">yaw</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/payload/gimbal_set'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">roll</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">pitch</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">yaw</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/payload/gimbal_set'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/GimbalSet'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">roll</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">pitch</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">yaw</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /&lt;namespace&gt;/payload/gimbal_set <span class="s2">"roll: 0.0
pitch:0.5
yaw:-0.2"</span>

<span class="c">#sends (roll,pitch,yaw)=(0,0.5,-0.2)(rad)</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#send gimbal attitude set</span>
<span class="n">drone</span><span class="o">.</span><span class="n">gimbal_control</span><span class="p">(</span><span class="mf">2.2</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="cp">#include &lt;core_api/GimbalSet.h&gt;
</span>
<span class="n">ros</span><span class="o">::</span><span class="n">NodeHandle</span> <span class="n">nh</span><span class="p">;</span>
<span class="n">ros</span><span class="o">::</span><span class="n">ServiceClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">nh</span><span class="p">.</span><span class="n">serviceClient</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">GimbalSet</span><span class="o">&gt;</span><span class="p">(</span><span class="s">"/&lt;namespace&gt;/payload/gimbal_set"</span><span class="p">);</span>
<span class="n">core_api</span><span class="o">::</span><span class="n">GimbalSet</span> <span class="n">srv</span><span class="p">;</span>

<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">roll</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span>
<span class="n">srv</span><span class="p">.</span><span class="n">request</span><span class="p">.</span><span class="n">yaw</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">;</span>
<span class="n">client</span><span class="p">.</span><span class="n">call</span><span class="p">(</span><span class="n">srv</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">success</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">success</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">message</span> <span class="o">=</span> <span class="n">srv</span><span class="p">.</span><span class="n">response</span><span class="p">.</span><span class="n">message</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="kn">import</span> <span class="nn">rospy</span>
<span class="kn">from</span> <span class="nn">core_api.srv</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">setpoint_gimbal</span><span class="p">(</span><span class="n">roll</span><span class="p">,</span> <span class="n">pitch</span><span class="p">,</span> <span class="n">yaw</span><span class="p">):</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">wait_for_service</span><span class="p">(</span><span class="s">'&lt;namespace&gt;/payload/gimbal_set'</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">handle</span> <span class="o">=</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceProxy</span><span class="p">(</span><span class="s">'&lt;namespace&gt;/payload/gimbal_set'</span><span class="p">,</span> <span class="n">GimbalSet</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">handle</span><span class="p">(</span><span class="n">roll</span><span class="p">,</span> <span class="n">pitch</span><span class="p">,</span> <span class="n">yaw</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resp</span>
    <span class="k">except</span> <span class="n">rospy</span><span class="o">.</span><span class="n">ServiceException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">rospy</span><span class="o">.</span><span class="n">logerr</span><span class="p">(</span><span class="s">"gimbal_set service call failed </span><span class="si">%</span><span class="s">s"</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span><span class="sb">``</span><span class="err">`</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"roll"</span><span class="p">]</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"pitch"</span><span class="p">]</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"yaw"</span><span class="p">]</span><span class="o">=-</span><span class="mf">0.2</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/payload/gimbal_set"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">gimbalSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/payload/gimbal_set'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/GimbalSet'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">roll</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="na">roll</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="na">roll</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.2</span>
<span class="p">});</span>

<span class="nx">gimbalSet</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">gimbalSet</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="p">{</span><span class="s">'message'</span><span class="p">:</span> <span class="s">'[INFO] Vehicle accepted gimbal set call'</span><span class="p">,</span> <span class="s">'success'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">message</span> <span class="p">(</span><span class="n">string</span><span class="p">):</span> <span class="n">Contains</span> <span class="n">error</span> <span class="n">message</span>
<span class="n">success</span> <span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="nl">success:</span> <span class="n">True</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Success</span><span class="p">:</span> <span class="bp">True</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API sends gimbal attitude setpoint command to the autopilot via MAVLink and outputs pwm signals on gimbal-dedicated port of FlytPOD/Pixhawk. </p>

<h3 id="pre-requisites">Pre-requisites:</h3>

<p>For this API to work, autopilot must fulfill some pre-requisites first:</p>

<p>For FlytPOD/PRO users:</p>

<ul>
<li>Autopilot <strong>MUST</strong> be in <strong>ready-to-arm</strong> state. Typically it would be reflected by RGB led patterns marked by either blue-breathing or green-breathing. For more information about autopilot RGBled patterns refer to <a href="http://docs.flytbase.com/docs/FlytPOD/Hardware_specifications.html#rgb-led">this link</a>.</li>
<li>Make sure the parameter: <strong>MNT_MODE_IN</strong> is set to 3.</li>
</ul>

<p>For PX4 users using Pixhawk:</p>

<ul>
<li>Autopilot <strong>MUST</strong> be in <strong>ready-to-arm</strong> state. Typically it would be reflected by RGBled patterns marked by either blue-breathing or green-breathing. For more information about autopilot RGBled patterns refer to <a href="https://pixhawk.org/users/status_leds">this link</a>.</li>
<li>Make sure the parameter: <strong>MNT_MODE_IN</strong> is set to 3.</li>
<li>For more information refer to <a href="https://dev.px4.io/advanced-gimbal-control.html">this guide by PX4</a>.</li>
</ul>

<p>For APM users using Pixhawk:
* Refer <a href="http://ardupilot.org/copter/docs/common-camera-gimbal.html">this guide by APM</a>.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard C++ and Python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>roll</td>
<td>float</td>
<td>roll command to gimbal in radians</td>
</tr>
<tr>
<td>pitch</td>
<td>float</td>
<td>pitch command to gimbal in radians</td>
</tr>
<tr>
<td>yaw</td>
<td>float</td>
<td>yaw command to gimbal in radians</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Payload APIs in FlytOS are derived from / wrapped around the core services available in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/payload/gimbal_set</code></li>
<li>Service Type: <code class="prettyprint">GimbalSet</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/payload/gimbal_set</code></li>
<li>JSON Request:
<code class="prettyprint">{
roll: Float,
pitch: Float,
yaw: Float
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean,
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library</a>.</p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava</a>.</p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/payload/gimbal_set</code></li>
<li>serviceType: <code class="prettyprint">core_api/GimbalSet</code></li>
</ul>

          <h2 id="obstacle-detection">Obstacle Detection</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device using desktop or use ssh for remote login.</span>

ROS-Topic Name: /&lt;namespace&gt;/dji_msdk/obstacle_distance
ROS-Topic Type: core_api/ObstacleData, below is its description

Response structure:
    std_msgs/Header header
      uint32 seq
      <span class="nb">time </span>stamp
      string frame_id
    float32[] front
    float32[] back
    bool on_hold
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="c1">// Not Implemented
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="c"># Not Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">dji_msdk</span><span class="o">/</span><span class="n">obstacle_distance</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Type</span><span class="o">:</span> <span class="n">core_api</span><span class="o">/</span><span class="n">ObstacleData</span><span class="p">,</span> <span class="n">below</span> <span class="n">is</span> <span class="n">its</span> <span class="n">description</span>

<span class="n">Response</span> <span class="n">structure</span><span class="o">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">float32</span><span class="p">[]</span> <span class="n">front</span>
    <span class="n">float32</span><span class="p">[]</span> <span class="n">back</span>
    <span class="kt">bool</span> <span class="n">on_hold</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">dji_msdk</span><span class="o">/</span><span class="n">obstacle_distance</span>
<span class="n">ROS</span><span class="o">-</span><span class="n">Topic</span> <span class="n">Type</span><span class="p">:</span> <span class="n">core_api</span><span class="o">/</span><span class="n">ObstacleData</span><span class="p">,</span> <span class="n">below</span> <span class="ow">is</span> <span class="n">its</span> <span class="n">description</span>

<span class="n">Response</span> <span class="n">structure</span><span class="p">:</span>
    <span class="n">std_msgs</span><span class="o">/</span><span class="n">Header</span> <span class="n">header</span>
      <span class="n">uint32</span> <span class="n">seq</span>
      <span class="n">time</span> <span class="n">stamp</span>
      <span class="n">string</span> <span class="n">frame_id</span>
    <span class="n">float32</span><span class="p">[]</span> <span class="n">front</span>
    <span class="n">float32</span><span class="p">[]</span> <span class="n">back</span>
    <span class="nb">bool</span> <span class="n">on_hold</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/dji_msdk/obstacle_distance'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">front</span><span class="p">:</span> <span class="nx">FloatArray</span><span class="p">,</span>
    <span class="nx">back</span><span class="p">:</span> <span class="nx">FloatArray</span><span class="p">,</span>
    <span class="nx">on_hold</span><span class="p">:</span> <span class="nx">Bool</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/dji_msdk/obstacle_distance'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ObstacleData'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">front</span><span class="p">:</span> <span class="nx">FloatArray</span><span class="p">,</span>
    <span class="nx">back</span><span class="p">:</span> <span class="nx">FloatArray</span><span class="p">,</span>
    <span class="nx">on_hold</span><span class="p">:</span> <span class="nx">Bool</span>
<span class="p">}</span>
</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>Not Implemented
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/dji_msdk/obstacle_distance"</span><span class="p">,</span>
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">obsData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Topic</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/dji_msdk/obstacle_distance'</span><span class="p">,</span>
    <span class="na">messageType</span> <span class="p">:</span> <span class="s1">'core_api/ObstacleData'</span><span class="p">,</span>
    <span class="na">throttle_rate</span><span class="p">:</span> <span class="mi">200</span>
<span class="p">});</span>

<span class="nx">obsData</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">message</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>Not Implemented
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">Not</span> <span class="nx">Implemented</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">front</span><span class="p">:</span> <span class="p">[</span><span class="mf">16.43000030517578</span><span class="p">,</span> <span class="mf">14.010000228881836</span><span class="p">,</span> <span class="mf">0.8700000047683716</span><span class="p">,</span> <span class="mf">0.8700000047683716</span><span class="p">]</span>
<span class="nl">back</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.8700000047683716</span><span class="p">,</span> <span class="mf">0.8700000047683716</span><span class="p">,</span> <span class="mf">0.8700000047683716</span><span class="p">,</span> <span class="mf">15.569999694824219</span><span class="p">]</span>
<span class="nl">on_hold</span><span class="p">:</span> <span class="nx">False</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API publishes detected obstacle data of a supported DJI drone.</p>

<h3 id="pre-requisites">Pre-requisites:</h3>

<p>For this API to work, autopilot must fulfill some pre-requisites first:</p>

<aside class="warning">
    This API will **ONLY** work with FlytOS mobile app.
</aside>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard C++ and Python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>front</td>
<td>floatArray</td>
<td>array of detected obstacle distance (in m) for every quadrant of front sensor from left to right</td>
</tr>
<tr>
<td>front</td>
<td>floatArray</td>
<td>array of detected obstacle distance (in m) for every quadrant of back sensor from left to right</td>
</tr>
<tr>
<td>on_hole</td>
<td>bool</td>
<td>stores state if autopilot has engaged obstacle avoidance</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>Payload APIs in FlytOS are derived from / wrapped around the core services available in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/dji_msdk/obstacle_distance</code></li>
<li>Service Type: <code class="prettyprint">core_api/ObstacleData</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library</a>.</p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava</a>.</p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/dji_msdk/obstacle_distance</code></li>
<li>serviceType: <code class="prettyprint">core_api/ObstacleData</code></li>
</ul>

          <h1 id="vehicle-setup-apis">Vehicle Setup APIs</h1>

<h2 id="actuator-testing">Actuator Testing</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/setup/actuator_testing
ROS-Service Type: core_api/ActuatorTesting, below is its description

<span class="c">#request</span>
uint8 actuator_id
float32 time_s
<span class="c">#response</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">//Not Implemented
</span></code></pre><pre class="highlight python tab-python"><code><span class="c">#Not Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">//Not Recommended
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="c">#Not Recommended</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/setup/actuator_testing'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">actuator_id</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">time_s</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/setup/actuator_testing'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ActuatorTesting'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">actuator_id</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">time_s</span><span class="p">:</span> <span class="nx">Float</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># Refer to rosservice command line API documentation for sample service calls. http://wiki.ros.org/rosservice</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">//Not Implemented
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># Not Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">//Not Recommended
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># Not Recommended</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"actuator_id"</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"time_s"</span><span class="p">]</span><span class="o">=</span><span class="mf">4.00</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/setup/actuator_testing"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">actuatorTesting</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/setup/actuator_testing'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ActuatorTesting'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">actuator_id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="na">time_s</span><span class="p">:</span> <span class="mf">4.00</span>
<span class="p">});</span>

<span class="nx">actuatorTesting</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">actuatorTesting</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">//Not Implemented
</span></code></pre><pre class="highlight python tab-python"><code><span class="c"># Not Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">//Not Recommended
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># Not Recommended</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API allows for testing an actuator by providing actuator ID and time to rotate as parameters. If the corresponding actuator rotates on execution of the API correctly for the defined time then the motors are correctly connected.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>actuator_id</td>
<td>int</td>
<td>Decide which actuator to trigger.</td>
</tr>
<tr>
<td>time_s</td>
<td>float</td>
<td>Time in seconds to rotate the actuator</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<ul>
<li>Note: Make sure to check the direction of rotation while you trigger this API for correct response from the particular actuator.</li>
</ul>

<aside class="warning">
    This API will **ONLY** work with FlytPOD/PRO and Pixhawk running APM.
</aside>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>APIs in FlytOS are derived from / wrapped around the core services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/setup/actuator_testing</code></li>
<li>Service Type: <code class="prettyprint">ActuatorTesting</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port 80. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/setup/actuator_testing</code></li>
<li>JSON Request:
<code class="prettyprint">{
actuator_id: Int,
time_s: Float
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library</a>.</p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava</a>.</p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/setup/actuator_testing</code></li>
<li>serviceType: <code class="prettyprint">core_api/ActuatorTesting</code></li>
</ul>

          <h2 id="esc-calibration">ESC Calibration</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/setup/esc_calibration
ROS-Service Type: core_api/EscCalibration, below is its description

<span class="c">#request</span>
int8 CALIBRATION_STATE_SET_PWM_MAX <span class="o">=</span> 1
int8 CALIBRATION_STATE_SET_PWM_MIN <span class="o">=</span> 2
int8 CALIBRATION_STATE_CANCEL <span class="o">=</span> 3
float32 pwm_min
float32 pwm_max
int8 num_of_actuators
int8 calibration_state

<span class="c">#response</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">//Not Implemented
</span></code></pre><pre class="highlight python tab-python"><code><span class="c">#Not Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">//Not Recommended
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="c">#Not Recommended</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/setup/esc_calibration'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">pwm_min</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">pwm_max</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">num_of_actuators</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">calibration_state</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/setup/esc_calibration'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/EscCalibration'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">pwm_min</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">pwm_max</span><span class="p">:</span> <span class="nx">Float</span><span class="p">,</span>
    <span class="nx">num_of_actuators</span><span class="p">:</span> <span class="nx">Int</span><span class="p">,</span>
    <span class="nx">calibration_state</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>
<span class="c"># Refer to rosservice command line API documentation for sample service calls. http://wiki.ros.org/rosservice</span>

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">//Not Implemented
</span></code></pre><pre class="highlight python tab-python"><code><span class="c">#Not Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">//Not Recommended
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="c">#Not Recommended</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"pwm_min"</span><span class="p">]</span><span class="o">=</span><span class="mf">1000.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"pwm_max"</span><span class="p">]</span><span class="o">=</span><span class="mf">2000.00</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"num_of_actuators"</span><span class="p">]</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"calibration_state"</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/setup/esc_calibration"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">escCalibration</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/setup/esc_calibration'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/EscCalibration'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">pwm_min</span><span class="p">:</span> <span class="mf">1000.00</span><span class="p">,</span>
    <span class="na">pwm_max</span><span class="p">:</span> <span class="mf">2000.00</span><span class="p">,</span>
    <span class="na">num_of_actuators</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="na">calibration_state</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">});</span>

<span class="nx">escCalibration</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">escCalibration</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">//Not Implemented
</span></code></pre><pre class="highlight python tab-python"><code><span class="c">#Not Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">//Not Recommended
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="c">#Not Recommended</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API helps calibrate ESCs.</p>

<aside class="warning">
    This API will **ONLY** work with FlytPOD/PRO.
</aside>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>pwm_min</td>
<td>float</td>
<td>Min PWM value to be expected</td>
</tr>
<tr>
<td>pwm_max</td>
<td>float</td>
<td>Max PWM value to be expected</td>
</tr>
<tr>
<td>num_of_actuators</td>
<td>Int</td>
<td>Number of actuator in the frame.</td>
</tr>
<tr>
<td>calibration_state</td>
<td>Int</td>
<td>1/2/3.</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>APIs in FlytOS are derived from / wrapped around the core services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/setup/esc_calibration</code></li>
<li>Service Type: <code class="prettyprint">EscCalibration</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/\&lt;namespace\&gt;/setup/esc_calibration</code></li>
<li>JSON Request:
<code class="prettyprint">{
pwm_min: Float,
pwm_max: Float,
num_of_actuators: Int,
calibration_state: Int
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/setup/esc_calibration</code></li>
<li>serviceType: &lsquo;core_api/EscCalibration&rsquo;</li>
</ul>

          <h2 id="module-calibration">Module Calibration</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

Type: Ros Service
Name: /&lt;namespace&gt;/setup/module_calibration
MsgType: core_api/ModuleCalibration

<span class="c">#request</span>
uint8 STOP <span class="o">=</span> 0
uint8 ACCELEROMETER <span class="o">=</span> 1
uint8 GYROSCOPE <span class="o">=</span> 2
uint8 MAGNETOMETER <span class="o">=</span> 3
uint8 RC <span class="o">=</span> 4
uint8 RC_TRIM <span class="o">=</span> 5
uint8 RC_STOP <span class="o">=</span> 6
uint8 LEVEL <span class="o">=</span> 7
uint8 AIRSPEED <span class="o">=</span> 8

int8 module_calibrate

<span class="c">#response</span>
bool success
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">//Not Implemented
</span></code></pre><pre class="highlight python tab-python"><code><span class="c">#Not Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">//Not Recommended
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="c">#Not Recommended</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/setup/module_calibration'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">module_calibrate</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/setup/module_calibration'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ModuleCalibration'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">module_calibrate</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>
<span class="c"># Refer to rosservice command line API documentation for sample service calls. http://wiki.ros.org/rosservice</span>

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">//Not Implemented
</span></code></pre><pre class="highlight python tab-python"><code><span class="c">#Not Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">//Not Recommended
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="c">#Not Recommended</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"module_calibrate"</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/setup/module_calibration"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">moduleCalibration</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/setup/module_calibration'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ModuleCalibration'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">module_calibrate</span><span class="p">:</span> <span class="nx">Int</span>
<span class="p">});</span>

<span class="nx">moduleCalibration</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">moduleCalibration</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: True
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">//Not Implemented
</span></code></pre><pre class="highlight python tab-python"><code><span class="c">#Not Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">//Not Recommended
</span></code></pre><pre class="highlight python tab-python--ros"><code><span class="c">#Not Recommended</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API helps calibrate <em>accelerometer, magnetometer, gyroscope, level and RC</em>.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>module_calibrate</td>
<td>int</td>
<td>module to calibrate.<br>1: accel<br>2: gyro<br>3: mag<br>4: radio<br>7: level</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<aside class="notice">
    Please take care that accel and mag calibration needs you to rotate the autopilot board in specific direction for the calibration to complete. Refer the calibration widget for the complete procedure.
</aside>

<aside class="warning">
    This API will **ONLY** work with FlytPOD/PRO and Pixhawk running PX4.
</aside>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>APIs in FlytOS are derived from / wrapped around the core services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/setup/module_calibration</code></li>
<li>Service Type: <code class="prettyprint">ModuleCalibration</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/setup/module_calibration</code></li>
<li>JSON Request:
<code class="prettyprint">{
module_calibrate: Int
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/setup/module_calibration</code></li>
<li>serviceType: <code class="prettyprint">core_api/ModuleCalibration</code></li>
</ul>

          <h1 id="parameter-apis">Parameter APIs</h1>

<h2 id="parameter-set">Parameter Set</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/param/param_set
ROS-Service Type: core_api/ParamSet, below is its description

<span class="c">#Request : Info of parameter to be set</span>
core_api/ParamInfo param_info

<span class="c">#Response : success=true if command is successful.  </span>
bool success
<span class="c">#Response : error message, if any</span>
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">bool</span> <span class="n">Param</span><span class="o">::</span><span class="n">param_set</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_id</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_value</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">param_id</span><span class="o">:</span> <span class="n">ID</span> <span class="n">of</span> <span class="n">param</span> <span class="n">to</span> <span class="n">be</span> <span class="n">set</span>
    <span class="n">param_value</span><span class="o">:</span> <span class="n">Value</span> <span class="n">of</span> <span class="n">param</span> <span class="n">to</span> <span class="n">be</span> <span class="n">set</span>
<span class="n">Returns</span><span class="o">:</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successful</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">param_set</span><span class="p">(</span><span class="n">param_id</span><span class="p">,</span> <span class="n">param_value</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_set</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="n">core_api</span><span class="o">/</span><span class="n">ParamInfo</span> <span class="n">param_info</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_set</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="n">core_api</span><span class="o">/</span><span class="n">ParamInfo</span> <span class="n">param_info</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_set'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">param_info</span><span class="p">:{</span>
        <span class="nl">param_id</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="nx">param_value</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_set'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ParamSet'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">param_info</span><span class="p">:{</span>
        <span class="nl">param_id</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="nx">param_value</span><span class="p">:</span> <span class="nb">String</span> <span class="p">}}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/param/param_set <span class="s2">"param_info:
  param_id: ''
  param_value: ''"</span> 

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/param_bridge.h&gt;
</span>
<span class="n">Param</span> <span class="n">param</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_id</span> <span class="o">=</span> <span class="s">"RTL_ALT"</span><span class="p">;</span> 

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_value</span> <span class="o">=</span> <span class="s">"5"</span><span class="p">;</span>
<span class="n">param</span><span class="p">.</span><span class="n">param_set</span><span class="p">(</span><span class="n">param_id</span><span class="p">,</span> <span class="n">param_value</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#Set parameter</span>
<span class="n">drone</span><span class="o">.</span><span class="n">param_set</span><span class="p">(</span><span class="s">'walk'</span><span class="p">,</span> <span class="s">'on'</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span><span class="nx">msgdata</span><span class="p">[</span><span class="s2">"param_info"</span><span class="p">]</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">.</span><span class="nx">param_info</span><span class="p">[</span><span class="s2">"param_id"</span><span class="p">]</span><span class="o">=</span><span class="s2">"RTL_ALT"</span><span class="p">;</span>
<span class="nx">msgdata</span><span class="p">.</span><span class="nx">param_info</span><span class="p">[</span><span class="s2">"param_value"</span><span class="p">]</span><span class="o">=</span><span class="s2">"5.0"</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_set"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">paramSet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_set'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ParamSet'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">param_info</span><span class="p">:{</span>
        <span class="na">param_id</span><span class="p">:</span> <span class="err">“</span><span class="nx">RTL_ALT</span><span class="err">”</span><span class="p">,</span>
        <span class="na">param_value</span><span class="p">:</span> <span class="err">“</span><span class="mf">5.0</span><span class="err">”</span>
<span class="p">});</span>

<span class="nx">paramSet</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">paramSet</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="nb">bool</span> <span class="p">:</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API sets the value of a desired parameter</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>param_id</td>
<td>string</td>
<td>Name of the parameter to be updated</td>
</tr>
<tr>
<td>param_value</td>
<td>string</td>
<td>Value of the parameter to be set.</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<aside class="notice">
    Make sure the parameter which you are trying to update, exists.
</aside>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>APIs in FlytOS are derived from / wrapped around the core services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/param/param_set</code></li>
<li>Service Type: <code class="prettyprint">ParamSet</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_set</code></li>
<li>JSON Request:
<code class="prettyprint">{
param_info:{
    param_id: [String],
    param_value: [String]
}
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/param/param_set</code></li>
<li>serviceType: <code class="prettyprint">core_api/ParamSet</code></li>
</ul>

          <h2 id="parameter-get-all">Parameter Get All</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/param/param_get_all
ROS-Service Type: core_api/ParamGetAll, below is its description

<span class="c">#Request : fresh pull true or false</span>
bool fresh_pull

<span class="c">#Response: ParamInfo list of all parameters</span>
core_api/ParamInfo[] param_list
<span class="c">#Response : success=true if command is successful.  </span>
bool success
<span class="c">#Response : error message, if any</span>
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">bool</span> <span class="n">Param</span><span class="o">::</span><span class="n">param_get_all</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">core_api</span><span class="o">::</span><span class="n">ParamInfo</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">param_list</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">fresh_pull</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">fresh_pull</span><span class="o">:</span> <span class="n">Whether</span> <span class="n">to</span> <span class="n">fresh</span> <span class="n">pull</span> <span class="n">from</span> <span class="n">autopilot</span> <span class="n">or</span> <span class="n">not</span>
    <span class="n">param_list</span><span class="o">:</span> <span class="n">Variable</span> <span class="n">to</span> <span class="n">store</span> <span class="n">parameter</span> <span class="n">list</span>
<span class="n">Returns</span><span class="o">:</span>
    <span class="n">returns</span> <span class="n">parameter</span> <span class="n">info</span> <span class="n">list</span> <span class="n">in</span> <span class="n">param_list</span> 
    <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successful</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">param_get_all</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_get_all</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="kt">bool</span> <span class="n">fresh_pull</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="n">core_api</span><span class="o">/</span><span class="n">ParamInfo</span><span class="p">[]</span> <span class="n">param_list</span>
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_get_all</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">fresh_pull</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="n">core_api</span><span class="o">/</span><span class="n">ParamInfo</span><span class="p">[]</span> <span class="n">param_list</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_get_all'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">param_list</span><span class="p">:</span> <span class="p">[{</span> <span class="na">param_id</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">],</span>
        <span class="na">param_value</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">]},{},{},...]</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_get_all'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ParamGetAll'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">param_list</span><span class="p">:</span> <span class="p">[{</span> <span class="na">param_id</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">],</span>
        <span class="na">param_value</span><span class="p">:</span> <span class="p">[</span><span class="nb">String</span><span class="p">]},{},{},...]</span> <span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/param/param_get_all <span class="s2">"fresh_pull: false"</span> 
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/param_bridge.h&gt;
</span>
<span class="n">Param</span> <span class="n">param</span><span class="p">;</span>
<span class="kt">bool</span> <span class="n">fresh_pull</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
<span class="n">core_api</span><span class="o">/</span><span class="n">ParamInfo</span><span class="p">[]</span> <span class="n">param_list</span><span class="p">;</span>

<span class="n">param</span><span class="p">.</span><span class="n">param_get_all</span><span class="p">(</span><span class="n">param_list</span><span class="p">,</span> <span class="n">fresh_pull</span><span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Parameter list: "</span> <span class="o">&lt;&lt;</span> <span class="n">param_list</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#Get all parameter</span>
<span class="n">drone</span><span class="o">.</span><span class="n">param_get_all</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_get_all"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">param_list</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">paramGetAll</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_get_all'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ParamGetAll'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">paramGetAll</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">ParamGetAll</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">param_list</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>    success:True,
    param_list:[<span class="o">{}</span>,<span class="o">{}</span>,<span class="o">{}</span>,....]
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Function</span> <span class="n">returns</span> <span class="mi">0</span>
<span class="n">param_list</span> <span class="n">is</span> <span class="n">populated</span> <span class="n">with</span> <span class="n">all</span> <span class="n">the</span> <span class="n">received</span> <span class="n">parameters</span>
</code></pre><pre class="highlight python tab-python"><code><span class="p">{</span><span class="s">'param_list'</span><span class="p">:</span> <span class="p">[{</span><span class="s">'param_value'</span><span class="p">:</span> <span class="s">'0.200000'</span><span class="p">,</span> <span class="s">'param_id'</span><span class="p">:</span> <span class="s">'ATT_VIBE_THRESH'</span><span class="p">},</span> <span class="p">{</span><span class="s">'param_value'</span><span class="p">:</span> <span class="s">'15.391030'</span><span class="p">,</span> <span class="s">'param_id'</span><span class="p">:</span> <span class="s">'BAT_A_PER_V'</span><span class="p">}],</span> <span class="s">'message'</span><span class="p">:</span> <span class="s">'Received 2 parameters'</span><span class="p">,</span> <span class="s">'success'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>

<span class="n">param_list</span> <span class="p">(</span><span class="nb">list</span><span class="p">):</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">dictionary</span><span class="p">,</span> <span class="n">each</span> <span class="n">dictionary</span> <span class="n">consists</span> <span class="n">of</span> <span class="n">param_value</span> <span class="ow">and</span> <span class="n">param_id</span>
<span class="n">message</span> <span class="p">(</span><span class="n">String</span><span class="p">):</span> <span class="n">Contains</span> <span class="n">error</span><span class="o">/</span><span class="n">success</span> <span class="n">message</span>
<span class="n">success</span> <span class="p">(</span><span class="nb">bool</span><span class="p">):</span> <span class="n">true</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span><span class="p">,</span>
    <span class="nx">param_list</span><span class="p">:[{},{},{},....]</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span><span class="p">,</span>
    <span class="nx">param_list</span><span class="p">:[{},{},{},....]</span>    
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API gets all the parameters available in FlytOS with their values.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
<tr>
<td>param_id</td>
<td>string</td>
<td>Name of the parameter</td>
</tr>
<tr>
<td>param_value</td>
<td>string</td>
<td>value of the parameter</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>APIs in FlytOS are derived from/wrapped around the core services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/param/param_get_all</code></li>
<li>Service Type: <code class="prettyprint">ParamGetAll</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_get_all</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean,
message: String,
param_list:[{
    param_id: String,
    param_value: String
},{},{},....]
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/param/param_get_all</code></li>
<li>serviceType: <code class="prettyprint">core_api/ParamGetAll</code></li>
</ul>

          <h2 id="parameter-get">Parameter Get</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/param/param_get
ROS-Service Type: core_api/ParamGet, below is its description

<span class="c">#Request : Param id to get</span>
string param_id

<span class="c">#Response: Param info of requested param</span>
core_api/ParamInfo param_info
<span class="c">#Response : success=true if command is successful.  </span>
bool success
<span class="c">#Response : error message, if any</span>
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">bool</span> <span class="n">Param</span><span class="o">::</span><span class="n">param_get</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_id</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">&amp;</span><span class="n">param_value</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">param_id</span><span class="o">:</span> <span class="n">ID</span> <span class="n">of</span> <span class="n">param</span> <span class="n">to</span> <span class="n">be</span> <span class="n">created</span>
    <span class="n">param_value</span><span class="o">:</span> <span class="n">Variable</span> <span class="n">to</span> <span class="n">store</span> <span class="n">parameter</span> <span class="n">value</span>
<span class="n">Returns</span><span class="o">:</span>
    <span class="n">returns</span> <span class="n">parameter</span> <span class="n">value</span> <span class="n">in</span> <span class="n">param_value</span> 
    <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successful</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">param_get</span><span class="p">(</span><span class="n">param_id</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_get</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">param_id</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="n">core_api</span><span class="o">/</span><span class="n">ParamInfo</span> <span class="n">param_info</span>
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_get</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">param_id</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="n">core_api</span><span class="o">/</span><span class="n">ParamInfo</span> <span class="n">param_info</span>
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_get'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">param_id</span><span class="p">:</span> <span class="nb">String</span> <span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">param_info</span><span class="p">:{</span> <span class="nl">param_value</span><span class="p">:</span> <span class="nb">String</span> <span class="p">}</span> <span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_get'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ParamGet'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">param_id</span><span class="p">:</span> <span class="nb">String</span> <span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">param_info</span><span class="p">:{</span> <span class="nl">param_value</span><span class="p">:</span> <span class="nb">String</span> <span class="p">}</span> <span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/param/param_get <span class="s2">"param_id: ''"</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/param_bridge.h&gt;
</span>
<span class="n">Param</span> <span class="n">param</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_id</span> <span class="o">=</span> <span class="s">"RTL_ALT"</span><span class="p">;</span> 
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_value</span><span class="p">;</span>

<span class="n">param</span><span class="p">.</span><span class="n">param_get</span><span class="p">(</span><span class="n">param_id</span><span class="p">,</span> <span class="n">param_value</span><span class="p">);</span>
<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Parameter value: "</span> <span class="o">&lt;&lt;</span> <span class="n">param_value</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#Get value of a specific parameter</span>
<span class="n">drone</span><span class="o">.</span><span class="n">param_get</span><span class="p">(</span><span class="s">'walk'</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"param_id"</span><span class="p">]</span><span class="o">=</span><span class="s2">"RTL_ALT"</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_get"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">param_info</span><span class="p">.</span><span class="nx">param_value</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">paramGet</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_get'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ParamGet'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">param_id</span><span class="p">:</span> <span class="s1">'RTL_ALT'</span>
<span class="p">});</span>

<span class="nx">paramGet</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">paramGet</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">param_info</span><span class="p">.</span><span class="nx">param_value</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>    success:True,
    param_info:<span class="o">{</span> param_value: <span class="s1">'6.00'</span><span class="o">}</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">param_value</span> <span class="o">=</span> <span class="mi">6</span>
<span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">String</span> <span class="o">-</span> <span class="n">the</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">param</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span><span class="p">,</span>
    <span class="nx">param_info</span><span class="p">:{</span> <span class="nl">param_value</span><span class="p">:</span> <span class="s1">'6.00'</span><span class="p">}</span>
<span class="p">}</span>
</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span><span class="p">,</span>
    <span class="nx">param_info</span><span class="p">:{</span> <span class="nl">param_value</span><span class="p">:</span> <span class="s1">'6.00'</span><span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API gets the value of a particular parameter specified.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>param_id</td>
<td>string</td>
<td>Name of the parameter</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
<tr>
<td>param_value</td>
<td>string</td>
<td>value of the parameter</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>APIs in FlytOS are derived from/wrapped around the core  services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/param/param_get</code></li>
<li>Service Type: <code class="prettyprint">ParamGet</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port **80*8. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_get</code></li>
<li>JSON Request:
<code class="prettyprint">{
param_id: String
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
param_info:{param_value: String}
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library</a>.</p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava</a>.</p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/param/param_get</code></li>
<li>serviceType: <code class="prettyprint">core_api/paramGet</code></li>
</ul>

          <h2 id="parameter-save">Parameter Save</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/param/param_save
ROS-Service Type: core_api/ParamSave, below is its description

<span class="c">#Request : Null</span>

<span class="c">#Response : success=true if command is successful.  </span>
bool success
<span class="c">#Response : error message, if any</span>
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">bool</span> <span class="n">Param</span><span class="o">::</span><span class="n">param_save</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span> <span class="n">Null</span>
<span class="n">Returns</span><span class="o">:</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successful</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">param_save</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_save</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="n">Null</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_save</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">Null</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_save'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_save'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ParamSave'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/param/param_save <span class="s2">"{}"</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/param_bridge.h&gt;
</span>
<span class="n">Param</span> <span class="n">param</span><span class="p">;</span>

<span class="n">param</span><span class="p">.</span><span class="n">param_save</span><span class="p">()</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#Get value of a specific parameter</span>
<span class="n">drone</span><span class="o">.</span><span class="n">param_save</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_save"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">paramSave</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_save'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ParamSave'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">paramSave</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">paramSave</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">Bool</span> <span class="o">-</span> <span class="bp">True</span><span class="p">,</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API saves the parameters to a file which allows data retention on reboot of FlytOS running systems.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>APIs in FlytOS are derived from / wrapped around the core services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/param/param_save</code></li>
<li>Service Type: <code class="prettyprint">ParamSave</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_save</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace</code>&gt;/param/param_save`</li>
<li>serviceType: <code class="prettyprint">core_api/ParamSave</code></li>
</ul>

          <h2 id="parameter-load">Parameter Load</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/param/param_load
ROS-Service Type: core_api/ParamLoad, below is its description

<span class="c">#Request : Null</span>

<span class="c">#Response : success=true if command is successful.  </span>
bool success
<span class="c">#Response : error message, if any</span>
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">bool</span> <span class="n">Param</span><span class="o">::</span><span class="n">param_load</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span> <span class="n">Null</span>
<span class="n">Returns</span><span class="o">:</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successful</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">param_load</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_load</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="n">Null</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_load</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">Null</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_load'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_load'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ParamLoad'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/param/param_load <span class="s2">"{}"</span> 
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/param_bridge.h&gt;
</span>
<span class="n">Param</span> <span class="n">param</span><span class="p">;</span>

<span class="n">param</span><span class="p">.</span><span class="n">param_load</span><span class="p">()</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#Get value of a specific parameter</span>
<span class="n">drone</span><span class="o">.</span><span class="n">param_load</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code>
<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_load"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">paramLoad</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_load'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ParamLoad'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">paramLoad</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">paramLoad</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">Bool</span> <span class="o">-</span> <span class="bp">True</span><span class="p">,</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API loads parameters from a file where parameters were saved before or a newly uploaded param file.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>APIs in FlytOS are derived from/wrapped around the core  services in ROS. Onboard service clients in rospy/roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: `Ros Service</li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/param/param_load</code></li>
<li>Service Type: <code class="prettyprint">ParamLoad</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_load</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean,
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/param/param_load</code></li>
<li>serviceType: <code class="prettyprint">core_api/ParamLoad</code></li>
</ul>

          <h2 id="parameter-create">Parameter Create</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/param/param_create
ROS-Service Type: core_api/ParamCreate, below is its description

<span class="c">#Request : Info of parameter to be created</span>
core_api/ParamInfo param_info

<span class="c">#Response : success=true if command is successful.  </span>
bool success
<span class="c">#Response : error message, if any</span>
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">bool</span> <span class="n">Param</span><span class="o">::</span><span class="n">param_create</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_id</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_value</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">param_id</span><span class="o">:</span> <span class="n">ID</span> <span class="n">of</span> <span class="n">param</span> <span class="n">to</span> <span class="n">be</span> <span class="n">created</span>
    <span class="n">param_value</span><span class="o">:</span> <span class="n">Value</span> <span class="n">of</span> <span class="n">param</span> <span class="n">to</span> <span class="n">be</span> <span class="n">created</span>
<span class="n">Returns</span><span class="o">:</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successful</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">param_create</span><span class="p">(</span><span class="n">param_id</span><span class="p">,</span> <span class="n">param_value</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_create</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="n">core_api</span><span class="o">/</span><span class="n">ParamInfo</span> <span class="n">param_info</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_create</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="n">core_api</span><span class="o">/</span><span class="n">ParamInfo</span> <span class="n">param_info</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_create'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">param_info</span><span class="p">:{</span>
        <span class="nl">param_id</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="nx">param_value</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span> <span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_create'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ParamCreate'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">param_info</span><span class="p">:{</span>
        <span class="nl">param_id</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="nx">param_value</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span> <span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>

</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/param/param_create <span class="s2">"param_info:
  param_id: ''
  param_value: ''"</span> 

</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/param_bridge.h&gt;
</span>
<span class="n">Param</span> <span class="n">param</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_id</span> <span class="o">=</span> <span class="s">"RTL_ALT"</span><span class="p">;</span> 

<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_value</span> <span class="o">=</span> <span class="s">"5"</span><span class="p">;</span>
<span class="n">param</span><span class="p">.</span><span class="n">param_create</span><span class="p">(</span><span class="n">param_id</span><span class="p">,</span> <span class="n">param_value</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#Get value of a specific parameter</span>
<span class="n">drone</span><span class="o">.</span><span class="n">param_create</span><span class="p">(</span><span class="s">'walk'</span><span class="p">,</span> <span class="s">'off'</span><span class="p">)</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"param_info"</span><span class="p">]</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">.</span><span class="nx">param_info</span><span class="p">[</span><span class="s2">"param_id"</span><span class="p">]</span><span class="o">=</span><span class="s2">"RTL_ALT"</span><span class="p">;</span>
<span class="nx">masdata</span><span class="p">.</span><span class="nx">param_info</span><span class="p">[</span><span class="s2">"param_value"</span><span class="p">]</span><span class="o">=</span><span class="err">'</span><span class="mf">5.0</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_create"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">paramCreate</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_create'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ParamCreate'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">param_info</span><span class="p">:{</span>
        <span class="na">param_id</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
        <span class="na">param_value</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">}</span>
<span class="p">});</span>

<span class="nx">paramCreate</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">paramCreate</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">Bool</span> <span class="o">-</span> <span class="bp">True</span><span class="p">,</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API creates a new parameter.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>param_id</td>
<td>string</td>
<td>Name of the parameter</td>
</tr>
<tr>
<td>param_value</td>
<td>string</td>
<td>Value for the parameter</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>APIs in FlytOS are derived from/wrapped around the core services in ROS. Onboard service clients in rospy/roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/param/param_create</code></li>
<li>Service Type: <code class="prettyprint">ParamCreate</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_create</code></li>
<li>JSON Request:
<code class="prettyprint">{
param_info:{
    param_id: String,
    param_value: String
}
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean,
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/param/param_create</code></li>
<li>serviceType: <code class="prettyprint">core_api/ParamCreate</code></li>
</ul>

          <h2 id="parameter-delete">Parameter Delete</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/param/param_delete
ROS-Service Type: core_api/ParamDelete, below is its description

<span class="c">#Request : Info of parameter to be deleted</span>
string param_id

<span class="c">#Response : success=true if command is successful.  </span>
bool success
<span class="c">#Response : error message, if any</span>
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">bool</span> <span class="n">Param</span><span class="o">::</span><span class="n">param_delete</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_id</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span>
    <span class="n">param_id</span><span class="o">:</span> <span class="n">ID</span> <span class="n">of</span> <span class="n">param</span> <span class="n">to</span> <span class="n">be</span> <span class="n">deleted</span>
<span class="n">Returns</span><span class="o">:</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successful</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">param_delete</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_delete</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">param_id</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_delete</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">param_id</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_delete'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">param_id</span><span class="p">:</span> <span class="nb">String</span> <span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_delete'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ParamDelete'</span>

<span class="nl">Request</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">param_id</span><span class="p">:</span> <span class="nb">String</span> <span class="p">}</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/param/param_delete <span class="s2">"param_id: ''"</span> 
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/param_bridge.h&gt;
</span>
<span class="n">Param</span> <span class="n">param</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">param_id</span> <span class="o">=</span> <span class="s">"RTL_ALT"</span><span class="p">;</span> 
<span class="n">param</span><span class="p">.</span><span class="n">param_delete</span><span class="p">(</span><span class="n">param_id</span><span class="p">);</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#Get value of a specific parameter</span>
<span class="n">drone</span><span class="o">.</span><span class="n">param_delete</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span>  <span class="nx">msgdata</span><span class="o">=</span><span class="p">{};</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s2">"param_id"</span><span class="p">]</span><span class="o">=</span><span class="err">'</span><span class="nx">RTL_ALT</span><span class="p">;</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">data</span><span class="p">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">msgdata</span><span class="p">),</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_delete"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">paramDelete</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_delete'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ParamDelete'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({</span>
    <span class="na">param_id</span><span class="p">:</span> <span class="nb">String</span>
<span class="p">});</span>

<span class="nx">paramDelete</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">paramDelete</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">Bool</span> <span class="o">-</span> <span class="bp">True</span><span class="p">,</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API deletes a parameter from FlytOS.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>param_id</td>
<td>string</td>
<td>Name of the paramter to be deleted</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>APIs in FlytOS are derived from / wrapped around the core  services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure. </p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/param/param_delete</code></li>
<li>Service Type: <code class="prettyprint">ParamDelete</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_delete</code></li>
<li>JSON Request:
<code class="prettyprint">{
param_id: String
}</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean,
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/param/param_delete</code></li>
<li>serviceType: <code class="prettyprint">core_api/ParamDelete</code></li>
</ul>

          <h2 id="parameter-reset">Parameter Reset</h2>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code><span class="c"># API call described below requires shell access, either login to the device by connecting a monitor or use ssh for remote login.</span>

ROS-Service Name: /&lt;namespace&gt;/param/param_reset
ROS-Service Type: core_api/ParamReset, below is its description

<span class="c">#Request : Null</span>

<span class="c">#Response : success=true if command is successful.  </span>
bool success
<span class="c">#Response : error message, if any</span>
string message
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="c1">// C++ API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from C++.
</span>
<span class="n">Function</span> <span class="n">Definition</span><span class="o">:</span> <span class="kt">bool</span> <span class="n">Param</span><span class="o">::</span><span class="n">param_reset</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="n">Arguments</span><span class="o">:</span> <span class="n">Null</span>
<span class="n">Returns</span><span class="o">:</span> <span class="n">returns</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">the</span> <span class="n">command</span> <span class="n">is</span> <span class="n">successful</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Class</span><span class="p">:</span> <span class="n">flyt_python</span><span class="o">.</span><span class="n">API</span><span class="o">.</span><span class="n">navigation</span>

<span class="n">Function</span><span class="p">:</span> <span class="n">param_reset</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// ROS services and topics are accessible from onboard scripts only.
</span>
<span class="n">Type</span><span class="o">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="o">:</span> <span class="o">/&lt;</span><span class="k">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_reset</span>
<span class="n">call</span> <span class="n">srv</span><span class="o">:</span> <span class="n">Null</span>
<span class="n">response</span> <span class="n">srv</span><span class="o">:</span> 
    <span class="o">:</span><span class="kt">bool</span> <span class="n">success</span>
    <span class="o">:</span><span class="n">string</span> <span class="n">message</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="c"># ROS services and topics are accessible from onboard scripts only.</span>

<span class="n">Type</span><span class="p">:</span> <span class="n">Ros</span> <span class="n">Service</span>
<span class="n">Name</span><span class="p">:</span> <span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;/</span><span class="n">param</span><span class="o">/</span><span class="n">param_reset</span>
<span class="n">call</span> <span class="n">srv</span><span class="p">:</span> <span class="n">Null</span>
<span class="n">response</span> <span class="n">srv</span><span class="p">:</span> 
    <span class="p">:</span><span class="nb">bool</span> <span class="n">success</span>
    <span class="p">:</span><span class="n">string</span> <span class="n">message</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_reset'</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">Websocket</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">you</span> 
<span class="nx">initialise</span> <span class="nx">the</span> <span class="nx">websocket</span> <span class="nx">using</span> <span class="nx">websocket</span> <span class="nx">initialising</span> 
<span class="nx">API</span> <span class="nx">and</span> <span class="nx">replace</span> <span class="nx">namespace</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">namespace</span> <span class="nx">of</span> 
<span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span> <span class="nx">before</span> <span class="nx">calling</span> <span class="nx">the</span> <span class="nx">API</span> 
<span class="kd">with</span> <span class="nx">websocket</span><span class="p">.</span>

<span class="nl">name</span><span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_reset'</span><span class="p">,</span>
<span class="nx">serviceType</span><span class="p">:</span> <span class="s1">'core_api/ParamReset'</span>

<span class="nl">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">success</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>
    <span class="nx">message</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="p">}</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>rosservice call /flytos/param/param_reset <span class="s2">"{}"</span>    
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="cp">#include &lt;cpp_api/param_bridge.h&gt;
</span>
<span class="n">Param</span> <span class="n">param</span><span class="p">;</span>

<span class="n">param</span><span class="p">.</span><span class="n">param_reset</span><span class="p">()</span>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># create flyt_python navigation class instance</span>
<span class="kn">from</span> <span class="nn">flyt_python</span> <span class="kn">import</span> <span class="n">API</span>
<span class="n">drone</span> <span class="o">=</span> <span class="n">API</span><span class="o">.</span><span class="n">navigation</span><span class="p">()</span>
<span class="c"># wait for interface to initialize</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span>

<span class="c">#Get value of a specific parameter</span>
<span class="n">drone</span><span class="o">.</span><span class="n">param_reset</span><span class="p">()</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="c1">// Please refer to Roscpp documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(c%2B%2B)
</span></code></pre><pre class="highlight python tab-python--ros"><code>
<span class="c"># Please refer to Rospy documentation for sample service clients. http://wiki.ros.org/ROS/Tutorials/WritingServiceClient(python)</span>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_reset"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">success</span><span class="p">);</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="kd">var</span> <span class="nx">paramReset</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">Service</span><span class="p">({</span>
    <span class="na">ros</span> <span class="p">:</span> <span class="nx">ros</span><span class="p">,</span>
    <span class="na">name</span> <span class="p">:</span> <span class="s1">'/&lt;namespace&gt;/param/param_reset'</span><span class="p">,</span>
    <span class="na">serviceType</span> <span class="p">:</span> <span class="s1">'core_api/ParamReset'</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ROSLIB</span><span class="p">.</span><span class="nx">ServiceRequest</span><span class="p">({});</span>

<span class="nx">paramReset</span><span class="p">.</span><span class="nx">callService</span><span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Result for service call on '</span>
      <span class="o">+</span> <span class="nx">paramReset</span><span class="p">.</span><span class="nx">name</span>
      <span class="o">+</span> <span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">success</span>
      <span class="o">+</span><span class="s1">': '</span>
      <span class="o">+</span> <span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
<span class="p">});</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>success: <span class="nb">true</span>
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="mi">0</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">Bool</span> <span class="o">-</span> <span class="bp">True</span><span class="p">,</span> <span class="k">if</span> <span class="n">action</span> <span class="n">successful</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code></code></pre><pre class="highlight python tab-python--ros"><code></code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="p">{</span>
    <span class="nl">success</span><span class="p">:</span><span class="nx">True</span>
<span class="p">}</span>

</code></pre>
<h3 id="description">Description:</h3>

<p>This API resets all the parameter value to the last save parameter state.</p>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable for onboard C++ and Python scripts. Scroll down for their counterparts in RESTful, Websocket, ROS. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>x, y, z</td>
<td>float</td>
<td>Position Setpoint in NED-Frame (in body-frame if body_frame=true)</td>
</tr>
<tr>
<td>yaw</td>
<td>float</td>
<td>Yaw Setpoint in radians</td>
</tr>
<tr>
<td>yaw_valid</td>
<td>bool</td>
<td>Must be set to true, if yaw</td>
</tr>
<tr>
<td>tolerance</td>
<td>float</td>
<td>Acceptance radius in meters, default value=1.0m</td>
</tr>
<tr>
<td>relative</td>
<td>bool</td>
<td>If true, position setpoints relative to current position is sent</td>
</tr>
<tr>
<td>async</td>
<td>bool</td>
<td>If true, asynchronous mode is set</td>
</tr>
<tr>
<td>body_frame</td>
<td>bool</td>
<td>If true, position setpoints are relative with respect to body frame</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>success</td>
<td>bool</td>
<td>true if action successful</td>
</tr>
<tr>
<td>message</td>
<td>string</td>
<td>debug message</td>
</tr>
</tbody></table>

<h3 id="api-usage-information">API usage information:</h3>

<aside class="notice">
    Make sure you have saved parameters before(using save parameter API), for the parameters to reset to a previous state.
</aside>

<h3 id="ros-endpoint">ROS endpoint:</h3>

<p>APIs in FlytOS are derived from / wrapped around the core services in ROS. Onboard service clients in rospy / roscpp can call these APIs. Take a look at roscpp and rospy API definition for message structure.</p>

<ul>
<li>Type: <code class="prettyprint">Ros Service</code></li>
<li>Name: <code class="prettyprint">/&lt;namespace&gt;/param/param_reset</code></li>
<li>Service Type: <code class="prettyprint">ParamReset</code></li>
</ul>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">GET http://&lt;ip&gt;/ros/&lt;namespace&gt;/param/param_reset</code></li>
<li>JSON Response:
<code class="prettyprint">{
success: Boolean,
message: String
}</code></li>
</ul>

<h3 id="websocket-endpoint">Websocket endpoint:</h3>

<p>Websocket APIs can be called from javascript using  <a href="https://github.com/RobotWebTools/roslibjs">roslibjs library.</a> </p>

<p>Java websocket clients are supported using <a href="http://wiki.ros.org/rosjava">rosjava.</a></p>

<ul>
<li>name: <code class="prettyprint">/&lt;namespace&gt;/param/param_reset</code></li>
<li>serviceType: <code class="prettyprint">core_api/ParamReset</code></li>
</ul>

          <h1 id="video-streaming-api">Video Streaming API</h1>

<blockquote>
<p>Definition</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>
</code></pre><pre class="highlight cpp tab-cpp"><code>
</code></pre><pre class="highlight python tab-python"><code><span class="c"># Python API described below can be used in onboard scripts only. For remote scripts you can use http client libraries to call FlytOS REST endpoints from Python.</span>

<span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code>
</code></pre><pre class="highlight python tab-python--ros"><code>

</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="nx">This</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">REST</span> <span class="nx">call</span> <span class="k">for</span> <span class="nx">the</span> <span class="nx">API</span><span class="p">.</span> <span class="nx">Make</span> <span class="nx">sure</span> <span class="nx">to</span> <span class="nx">replace</span> 
    <span class="nx">ip</span><span class="p">:</span> <span class="nx">ip</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">running</span> <span class="nx">device</span>
    <span class="nl">namespace</span><span class="p">:</span> <span class="nx">namespace</span> <span class="nx">used</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">FlytOS</span> <span class="nx">device</span><span class="p">.</span>

<span class="nl">URL</span><span class="p">:</span> <span class="s1">'http://&lt;ip&gt;/list_streams'</span>

<span class="nx">JSON</span> <span class="nx">Request</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">namespace</span><span class="p">:</span> <span class="nb">String</span><span class="p">}</span>

<span class="nx">JSON</span> <span class="nx">Response</span><span class="p">:</span>
<span class="p">{</span>   <span class="nl">stream1</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>
    <span class="nx">stream2</span><span class="p">:</span> <span class="nb">String</span><span class="p">,....</span> <span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">NA</span>


</code></pre>
<blockquote>
<p>Example</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>Not Implemented
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">Not</span> <span class="n">Implemented</span>

</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="kd">var</span> <span class="nx">msgdata</span><span class="o">=</span><span class="p">[];</span>
<span class="nx">msgdata</span><span class="p">[</span><span class="s1">'namespace'</span><span class="p">]</span><span class="o">=</span><span class="s1">'flytpod'</span><span class="p">;</span>
<span class="c1">// Use getnamespace API to know the namespace</span>

<span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
    <span class="na">type</span><span class="p">:</span> <span class="s2">"POST"</span><span class="p">,</span>
    <span class="na">dataType</span><span class="p">:</span> <span class="s2">"json"</span><span class="p">,</span>
    <span class="na">url</span><span class="p">:</span> <span class="s2">"http://&lt;ip&gt;/list_streams"</span><span class="p">,</span>  
    <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
           <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="s1">'stream1'</span><span class="p">]</span><span class="o">+</span><span class="s2">" "</span><span class="o">+</span><span class="nx">data</span><span class="p">[</span><span class="s1">'stream2'</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">});</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">NA</span>
</code></pre>
<blockquote>
<p>Example response</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>Not Implemented
</code></pre><pre class="highlight cpp tab-cpp"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight cpp tab-cpp--ros"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight python tab-python--ros"><code><span class="n">Not</span> <span class="n">Implemented</span>
</code></pre><pre class="highlight javascript tab-javascript--REST"><code><span class="p">{</span>
    <span class="nl">stream1</span><span class="p">:</span> <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">to</span> <span class="nx">stream1</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="nx">stream2</span><span class="p">:</span> <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">to</span> <span class="nx">stream2</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="nx">stream3</span><span class="p">:</span> <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">to</span> <span class="nx">stream3</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="nx">stream4</span><span class="p">:</span> <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">to</span> <span class="nx">stream4</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="nx">stream5</span><span class="p">:</span> <span class="o">&lt;</span><span class="nx">link</span> <span class="nx">to</span> <span class="nx">stream5</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="p">.</span>
    <span class="p">.</span>
    <span class="p">.</span>    
<span class="p">}</span>

</code></pre><pre class="highlight javascript tab-javascript--Websocket"><code><span class="nx">NA</span>
</code></pre>
<h3 id="description">Description:</h3>

<p>This API allows to get the list of video streams avalibale and view the live stream.</p>

<h3 id="api-usage-information">API usage information:</h3>

<aside class="notice">
    Keep an eye out, for this API needs a port at the end of the IP set to <strong>8080</strong>.
</aside>

<ul>
<li><p>To view the video of a particular stream from the list of streams you need to create an <strong>img</strong> tag add the link to its source.</p>

<p><code class="prettyprint">&lt;img src=&#39;http://&lt;ip&gt;/stream?topic=&lt;link to stream1&gt;&#39;&gt;</code></p></li>
<li><p>Tip: You can add the following parameters as query string to the link for lighter or better resolution video quality.
width, height, quality, rate:1/2/3</p>

<p>1. <strong>1</strong> will send out every frame,</p>

<p>2. <strong>2</strong> will send out every second frame,</p>

<p>3. <strong>3</strong> every third and so on&hellip;</p></li>
<li><p>Tip: To stop the video stream you need to delete the <strong>img</strong> tag completely.</p></li>
<li><p>Tip: To take a snapshot of the stream replace the word stream with snapshot in the link.</p>

<p><code class="prettyprint">&lt;img src=&#39;http://&lt;ip&gt;/snapshot?topic=&lt;link to stream1&gt;&#39;&gt;</code></p></li>
</ul>

<h3 id="parameters">Parameters:</h3>

<p>Following parameters are applicable in RESTful, Websocket. However the description of these parameters applies to all platforms. </p>

<p>Arguments:</p>

<table><thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>namespace</td>
<td>string</td>
<td>namespace used in FlytOS</td>
</tr>
</tbody></table>

<p>Output:</p>

<table><thead>
<tr>
<th>Parameter</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>stream1</td>
<td>string</td>
<td>link of the video stream1</td>
</tr>
<tr>
<td>stream2</td>
<td>string</td>
<td>link of the video stream2</td>
</tr>
<tr>
<td>stream3</td>
<td>string</td>
<td>link of the video stream3</td>
</tr>
</tbody></table>

<p>.
    .
    .</p>

<h3 id="restful-endpoint">RESTful endpoint:</h3>

<p>FlytOS hosts a RESTful server which listens on port <strong>80</strong>. RESTful APIs can be called from remote platform of your choice.</p>

<ul>
<li>URL: <code class="prettyprint">POST http://&lt;ip&gt;/list_streams</code></li>
<li><p>JSON Request:
<code class="prettyprint">{
namespace: &lt;namespace of FlytOS&gt;
}</code></p></li>
<li><p>JSON Response:
<code class="prettyprint">{
stream1: &lt;link to stream1&gt;,
stream2: &lt;link to stream2&gt;,
stream3: &lt;link to stream3&gt;,
stream4: &lt;link to stream4&gt;,
stream5: &lt;link to stream5&gt;,
.
.
.    
}</code></p></li>
</ul>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="cpp">C++</a>
                <a href="#" data-language-name="python">Python</a>
                <a href="#" data-language-name="javascript--REST">JS REST</a>
                <a href="#" data-language-name="javascript--Websocket">JS Websocket</a>
                <a href="#" data-language-name="shell">ros-cli</a>
                <a href="#" data-language-name="cpp--ros">roscpp</a>
                <a href="#" data-language-name="python--ros">rospy</a>
          </div>
      </div>
    </div>
  </body>
</html>
